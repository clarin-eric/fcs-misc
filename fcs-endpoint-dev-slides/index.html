<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui"><title>FCS Endpoint Development Tutorial</title><meta name="author" content="Erik Körner &lt;koerner@saw-leipzig.de&gt;"><link rel="stylesheet" href="reveal.js/dist/reset.css"><link rel="stylesheet" href="reveal.js/dist/reveal.css"><link rel="stylesheet" href="reveal.js/dist/theme/white.css" id="theme"><!--This CSS is generated by the Asciidoctor reveal.js converter to further integrate AsciiDoc's existing semantic with reveal.js--><style type="text/css">.reveal div.right {
  float: right
}

/* source blocks */
.reveal .listingblock.stretch > .content {
  height: 100%
}

.reveal .listingblock.stretch > .content > pre {
  height: 100%
}

.reveal .listingblock.stretch > .content > pre > code {
  height: 100%;
  max-height: 100%
}

/* auto-animate feature */
/* hide the scrollbar when auto-animating source blocks */
.reveal pre[data-auto-animate-target] {
  overflow: hidden;
}

.reveal pre[data-auto-animate-target] code {
  overflow: hidden;
}

/* add a min width to avoid horizontal shift on line numbers */
code.hljs .hljs-ln-line.hljs-ln-n {
  min-width: 1.25em;
}

/* tables */
table {
  border-collapse: collapse;
  border-spacing: 0
}

table {
  margin-bottom: 1.25em;
  border: solid 1px #dedede
}

table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td {
  padding: .5em .625em .625em;
  font-size: inherit;
  text-align: left
}

table tr th, table tr td {
  padding: .5625em .625em;
  font-size: inherit
}

table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td {
  display: table-cell;
  line-height: 1.6
}

td.tableblock > .content {
  margin-bottom: 1.25em
}

td.tableblock > .content > :last-child {
  margin-bottom: -1.25em
}

table.tableblock, th.tableblock, td.tableblock {
  border: 0 solid #dedede
}

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock {
  border-width: 0 1px 1px 0
}

table.grid-all > tfoot > tr > .tableblock {
  border-width: 1px 1px 0 0
}

table.grid-cols > * > tr > .tableblock {
  border-width: 0 1px 0 0
}

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock {
  border-width: 0 0 1px
}

table.grid-rows > tfoot > tr > .tableblock {
  border-width: 1px 0 0
}

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child {
  border-right-width: 0
}

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock {
  border-bottom-width: 0
}

table.frame-all {
  border-width: 1px
}

table.frame-sides {
  border-width: 0 1px
}

table.frame-topbot, table.frame-ends {
  border-width: 1px 0
}

.reveal table th.halign-left, .reveal table td.halign-left {
  text-align: left
}

.reveal table th.halign-right, .reveal table td.halign-right {
  text-align: right
}

.reveal table th.halign-center, .reveal table td.halign-center {
  text-align: center
}

.reveal table th.valign-top, .reveal table td.valign-top {
  vertical-align: top
}

.reveal table th.valign-bottom, .reveal table td.valign-bottom {
  vertical-align: bottom
}

.reveal table th.valign-middle, .reveal table td.valign-middle {
  vertical-align: middle
}

table thead th, table tfoot th {
  font-weight: bold
}

tbody tr th {
  display: table-cell;
  line-height: 1.6
}

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p {
  font-weight: bold
}

thead {
  display: table-header-group
}

.reveal table.grid-none th, .reveal table.grid-none td {
  border-bottom: 0 !important
}

/* kbd macro */
kbd {
  font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
  display: inline-block;
  color: rgba(0, 0, 0, .8);
  font-size: .65em;
  line-height: 1.45;
  background: #f7f7f7;
  border: 1px solid #ccc;
  -webkit-border-radius: 3px;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em white inset;
  box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em #fff inset;
  margin: 0 .15em;
  padding: .2em .5em;
  vertical-align: middle;
  position: relative;
  top: -.1em;
  white-space: nowrap
}

.keyseq kbd:first-child {
  margin-left: 0
}

.keyseq kbd:last-child {
  margin-right: 0
}

/* callouts */
.conum[data-value] {
  display: inline-block;
  color: #fff !important;
  background: rgba(0, 0, 0, .8);
  -webkit-border-radius: 50%;
  border-radius: 50%;
  text-align: center;
  font-size: .75em;
  width: 1.67em;
  height: 1.67em;
  line-height: 1.67em;
  font-family: "Open Sans", "DejaVu Sans", sans-serif;
  font-style: normal;
  font-weight: bold
}

.conum[data-value] * {
  color: #fff !important
}

.conum[data-value] + b {
  display: none
}

.conum[data-value]:after {
  content: attr(data-value)
}

pre .conum[data-value] {
  position: relative;
  top: -.125em
}

b.conum * {
  color: inherit !important
}

.conum:not([data-value]):empty {
  display: none
}

/* Callout list */
.hdlist > table, .colist > table {
  border: 0;
  background: none
}

.hdlist > table > tbody > tr, .colist > table > tbody > tr {
  background: none
}

td.hdlist1, td.hdlist2 {
  vertical-align: top;
  padding: 0 .625em
}

td.hdlist1 {
  font-weight: bold;
  padding-bottom: 1.25em
}

/* Disabled from Asciidoctor CSS because it caused callout list to go under the
 * source listing when .stretch is applied (see #335)
 * .literalblock+.colist,.listingblock+.colist{margin-top:-.5em} */
.colist td:not([class]):first-child {
  padding: .4em .75em 0;
  line-height: 1;
  vertical-align: top
}

.colist td:not([class]):first-child img {
  max-width: none
}

.colist td:not([class]):last-child {
  padding: .25em 0
}

/* Override Asciidoctor CSS that causes issues with reveal.js features */
.reveal .hljs table {
  border: 0
}

/* Callout list rows would have a bottom border with some reveal.js themes (see #335) */
.reveal .colist > table th, .reveal .colist > table td {
  border-bottom: 0
}

/* Fixes line height with Highlight.js source listing when linenums enabled (see #331) */
.reveal .hljs table thead tr th, .reveal .hljs table tfoot tr th, .reveal .hljs table tbody tr td, .reveal .hljs table tr td, .reveal .hljs table tfoot tr td {
  line-height: inherit
}

/* Columns layout */
.columns .slide-content {
  display: flex;
}

.columns.wrap .slide-content {
  flex-wrap: wrap;
}

.columns.is-vcentered .slide-content {
  align-items: center;
}

.columns .slide-content > .column {
  display: block;
  flex-basis: 0;
  flex-grow: 1;
  flex-shrink: 1;
}

.columns .slide-content > .column > * {
  padding: .75rem;
}

/* See #353 */
.columns.wrap .slide-content > .column {
  flex-basis: auto;
}

.columns .slide-content > .column.is-full {
  flex: none;
  width: 100%;
}

.columns .slide-content > .column.is-four-fifths {
  flex: none;
  width: 80%;
}

.columns .slide-content > .column.is-three-quarters {
  flex: none;
  width: 75%;
}

.columns .slide-content > .column.is-two-thirds {
  flex: none;
  width: 66.6666%;
}

.columns .slide-content > .column.is-three-fifths {
  flex: none;
  width: 60%;
}

.columns .slide-content > .column.is-half {
  flex: none;
  width: 50%;
}

.columns .slide-content > .column.is-two-fifths {
  flex: none;
  width: 40%;
}

.columns .slide-content > .column.is-one-third {
  flex: none;
  width: 33.3333%;
}

.columns .slide-content > .column.is-one-quarter {
  flex: none;
  width: 25%;
}

.columns .slide-content > .column.is-one-fifth {
  flex: none;
  width: 20%;
}

.columns .slide-content > .column.has-text-left {
  text-align: left;
}

.columns .slide-content > .column.has-text-justified {
  text-align: justify;
}

.columns .slide-content > .column.has-text-right {
  text-align: right;
}

.columns .slide-content > .column.has-text-left {
  text-align: left;
}

.columns .slide-content > .column.has-text-justified {
  text-align: justify;
}

.columns .slide-content > .column.has-text-right {
  text-align: right;
}

.text-left {
  text-align: left !important
}

.text-right {
  text-align: right !important
}

.text-center {
  text-align: center !important
}

.text-justify {
  text-align: justify !important
}

.footnotes {
  border-top: 1px solid rgba(0, 0, 0, 0.2);
  padding: 0.5em 0 0 0;
  font-size: 0.65em;
  margin-top: 4em;
}

.byline {
  font-size:.8em
}
ul.byline {
  list-style-type: none;
}
ul.byline li + li {
  margin-top: 0.25em;
}
</style><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/v4-shims.min.css"><link rel="stylesheet" href="css/presentation.css"></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title" data-background-image="images/fcs-render-uk.png" data-background-opacity="0.5"><h1>FCS Endpoint Development Tutorial</h1><p class="byline">
  <span class="author">Erik Körner &lt;koerner@saw-leipzig.de&gt;</span>
  </p></section><section id="_table_of_contents"><div class="slide-content"><div id="toc" class="toc"><div id="toctitle">Table of Contents</div><ol class="sectlevel1"><li><a href="#_table_of_contents">Table of Contents</a></li><li><a href="#_introducing_the_federated_content_search_fcs">Introducing the Federated Content Search (FCS)</a></li><li><a href="#_guide_to_endpoint_development">Guide to Endpoint Development</a></li><li><a href="#_fundamentals">Fundamentals</a></li><li><a href="#_reference_implementations">Reference Implementations</a></li><li><a href="#_resources_and_data_views">Resources and Data Views</a></li><li><a href="#_query_translation">Query Translation</a></li><li><a href="#_fcs_endpoint_development">FCS Endpoint Development</a></li><li><a href="#_deployment">Deployment</a></li><li><a href="#_resources">Resources</a></li></ol></div>
<div style="page-break-after: always;"></div></div></section>
<section><section id="_introducing_the_federated_content_search_fcs" data-background-image="images/fcs-render-uk.png" data-background-opacity="0.5"><h2>Introducing the Federated Content Search (FCS)</h2><div class="slide-content"><aside class="notes"><div class="ulist"><ul><li><p>Description, History &amp; Glossary</p></li></ul></div></aside></div></section><section id="_what_is_the_fcs"><h2>What is the FCS?</h2><div class="slide-content"><div class="ulist"><ul><li><p>“Federated Content Search” at <a href="https://www.clarin.eu/content/content-search">CLARIN</a></p><div class="paragraph"><p>In short: Content Search over <em>Distributed Resources</em></p></div>
<div class="paragraph"><p>Also: Federated “Corpus Query Platform”</p></div></li><li><p><em>Search for patterns in distributed text collections</em></p></li><li><p>No central index!</p></li><li><p>Text resources include annotated corpora, full-texts etc.</p></li><li><p>FCS = interface specification, search infrastructure and software ecosystem</p></li><li><p>Usage of <em>established standards</em> and <em>extensibility</em>!</p></li></ul></div></div></section><section id="_what_is_included_in_the_fcs" class="text-left"><h2>What is included in the FCS?</h2><div class="slide-content"><div class="paragraph"><p><strong>Interface Specification</strong></p></div>
<div class="ulist"><ul><li><p>Description of search protocol (query languages, formats and communication channels)<br>
“for homogeneous access to heterogeneous search engines”</p></li><li><p>RESTful protocol</p></li></ul></div>
<div class="openblock fragment"><div class="content"><div class="paragraph"><p><strong>Search Infrastruktur in CLARIN and Text+</strong></p></div>
<div class="ulist"><ul><li><p>Central client (search result “Aggregator” and web portal)</p></li><li><p>Decentralized endpoints at the data centers (local search eninges on resources)</p></li></ul></div></div></div></div></section><section id="_what_is_included_in_the_fcs_2" class="text-left"><h2>What is included in the FCS? (2)</h2><div class="slide-content"><div class="paragraph"><p><strong>Software Ecosystem primarily in Java</strong></p></div>
<div class="ulist"><ul><li><p>Libraries (Java, Python, …)</p></li><li><p>Tools (Validator, Aggregator, Registry)</p></li></ul></div></div></section><section id="_requirements_for_participation_in_the_fcs"><h2>Requirements for participation in the FCS</h2><div class="slide-content"><div class="ulist"><ul><li><p>(Own) text resources</p></li><li><p>“Search engine” on those text resources</p><div class="ulist"><ul><li><p>Minimum: full-text search</p></li></ul></div></li><li><p>Deployment of publicly accessible FCS endpoint(s)</p></li></ul></div></div></section><section id="_pros_and_cons_for_the_fcs_as_infrastructure" class="columns"><h2>Pros and Cons for the FCS (as Infrastructure)</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="paragraph"><p><strong>Pros</strong></p></div>
<div class="ulist"><ul><li><p>Integration of many resources, linking and comparison of results</p></li><li><p>Integration with other tools (Weblicht, Registry/VLO, Switchboard, …)</p></li><li><p>Same queries, formats, result presentation</p></li><li><p>No duplicate data storage, inconsistency</p></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="paragraph"><p><strong>Cons</strong></p></div>
<div class="ulist"><ul><li><p>No control over resources</p></li><li><p>No deterministic results (e.g. links for publications)</p></li><li><p>No global ranking of results possible</p></li></ul></div></div></div></div></section><section id="_pros_and_cons_for_fcs_endpoints_operators" class="columns"><h2>Pros and Cons for FCS Endpoints (Operators)</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="paragraph"><p><strong>Pros</strong></p></div>
<div class="ulist"><ul><li><p>Control over resources and search (ranking, fuzzy, …)</p></li><li><p>No duplication of data due to central index</p></li><li><p>Increased visibility in a larger resource catalog</p></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="paragraph"><p><strong>Cons</strong></p></div>
<div class="ulist"><ul><li><p>Deployment of (additional) endpoint necessary</p></li></ul></div></div></div></div></section><section id="_comparison_of_fcs_with_central_index"><h2>Comparison of FCS with Central Index</h2><div class="slide-content"><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:14.2857%"><col style="width:42.8571%"><col style="width:42.8572%"></colgroup><tbody><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">Data</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">➕ At the endpoints</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">➖ Duplicate data storage, possible inconsistency (age, updates); legally no transfer may be possible</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">Updates to Data</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">➕ Endpoints can react quickly</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">➖ Difficult, e.g. removal of resources in the event of legal problems; updates entail longer delays, if at all possible</p></td></tr></table></div></section><section id="_comparison_of_fcs_with_central_index_2"><h2>Comparison of FCS with Central Index (2)</h2><div class="slide-content"><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:14.2857%"><col style="width:42.8571%"><col style="width:42.8572%"></colgroup><tbody><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">Global Ranking</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">➖ Very difficult/impossible</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">➕ Quite possible (?), probably implicit assumption and normalization of data for indexing</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">Faceted Search</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">➖ Difficult (e.g. via external metadata; not explicitly intended)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">➕ Indexing allows clustering/classification according to topics and categories</p></td></tr></table></div></section><section id="_history"><h2>History</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>~ 2011</strong> Started as Working Group in CLARIN</p></li><li><p><strong>Mai 2011</strong> <a href="https://trac.clarin.eu/wiki/Clarin%20Federated%20Search%20Demonstrator">EDC/FCS Workshop</a></p></li><li><p><strong>~ 2011–2013</strong> Initial version, now named <strong>FCS “Legacy”</strong></p><div class="ulist"><ul><li><p>SRU Scan for resources, BASIC Search (CQL/full-text), KWIC</p></li></ul></div></li><li><p><strong>April 2013</strong> <a href="https://www.clarin.eu/event/2013/federated-content-search-workshop">FCS Workshop</a></p></li><li><p><strong>~ 2013/2014</strong> Code and Spec for <strong>FCS Core 1.0</strong></p><div class="ulist"><ul><li><p><code>fcs-simple-endpoint:1.0.0</code>, <code>sru-server:1.5.0</code></p></li><li><p>BASIC Hits Data View, SRU Scan operation not used anymore</p></li></ul></div></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>much has disappeared into the <em>annals of history</em> …</p></li><li><p><a href="https://github.com/clarin-eric/fcs-misc/tree/main/historical/documents" class="bare">https://github.com/clarin-eric/fcs-misc/tree/main/historical/documents</a></p></li><li><p><a href="https://trac.clarin.eu/wiki/FederatedSearch?version=1" class="bare">https://trac.clarin.eu/wiki/FederatedSearch?version=1</a></p></li><li><p><a href="https://trac.clarin.eu/browser/FCSSimpleEndpoint/tags" class="bare">https://trac.clarin.eu/browser/FCSSimpleEndpoint/tags</a></p></li><li><p><a href="https://trac.clarin.eu/wiki/FCS/Specification?action=history" class="bare">https://trac.clarin.eu/wiki/FCS/Specification?action=history</a></p></li><li><p><a href="https://trac.clarin.eu/wiki/Taskforces/FCS/FCS-Specification-Draft?action=history" class="bare">https://trac.clarin.eu/wiki/Taskforces/FCS/FCS-Specification-Draft?action=history</a></p></li><li><p><a href="https://www.clarin.eu/event/2013/federated-content-search-workshop" class="bare">https://www.clarin.eu/event/2013/federated-content-search-workshop</a></p></li><li><p>EDC: European Demonstrator Case</p></li></ul></div></aside></div></section><section id="_history_2"><div class="slide-content"><div class="ulist"><ul><li><p><strong>~ 2015/2016</strong> Starting work on and Code for <strong>FCS Core 2.0</strong></p><div class="ulist"><ul><li><p><code>fcs-simple-endpoint:1.3.0</code>, <code>sru-server:1.8.0</code></p></li><li><p>Advanced Data Views (FCS-QL), …</p></li></ul></div></li><li><p><strong>June 2017</strong> Official release of <strong>FCS Core 2.0</strong> Spec</p></li><li><p><strong>2022</strong> FCS is focus in Text+ (<em>Findability</em>)</p></li><li><p><strong>2023</strong> New FCS maintainer in CLARIN</p><div class="ulist"><ul><li><p>Migration of Source Code to <a href="https://github.com/clarin-eric/?q=fcs">GitHub.com</a>, updated documentation</p></li><li><p>Python FCS endpoint libraries</p></li><li><p>Updated libraries &amp; tools</p></li><li><p>Prototypes for LexFCS extension</p></li></ul></div></li><li><p><strong>2024</strong></p><div class="ulist"><ul><li><p>Experiments with Entity Search (extension)</p></li><li><p>Rewrite of FCS Endpoint Validator</p></li></ul></div></li></ul></div></div></section><section id="_fcs_architecture" data-background-image="images/LexFCS_Diagram_v3.png" data-background-size="contain"></section><section id="_communication_protocol"><h2>Communication Protocol</h2><div class="slide-content"><div class="paragraph"><p><strong>SRU (Search/Retrieval via URL) / OASIS searchRetrieve</strong></p></div>
<div class="ulist"><ul><li><p>Standardized by <em>Library of Congress (LoC)</em> / <em>OASIS</em></p><div class="ulist"><ul><li><p>RESTful</p></li><li><p><strong>Explain</strong>: Listing of resources</p><div class="ulist"><ul><li><p>Languages, annotations, supported data views and formats etc.</p></li></ul></div></li><li><p><strong>SearchRetrieve</strong>: Search request</p></li></ul></div></li><li><p>Data as XML</p></li><li><p>Extensions to the protocol explicitely allowed</p></li></ul></div></div></section><section id="_basic_assumption_on_the_data_structure"><h2>Basic Assumption on the Data Structure</h2><div class="slide-content"><div class="ulist"><ul><li><p>different (optional) annotation layers</p></li></ul></div>
<div class="openblock x-small"><div class="content"><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:20%"><col style="width:20%"><col style="width:20%"><col style="width:20%"><col style="width:20%"></colgroup><tbody><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">Full-text</p></th><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>The</strong></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cyclists</strong></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>are</strong></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fast</strong></p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">Part of Speech</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">DET</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">NOUN</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">VERB</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">ADJ</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">Lemmatisation</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">The</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">cyclist</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">is</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">fast</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">Phonetic Transcription</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">Orthographic Transcription</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">[&#8230;&#8203;]</p></th><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr></table></div></div></div></section><section id="_explain_resource_discovery"><h2>Explain: Resource Discovery</h2><div class="slide-content"><div class="imageblock"><img src="images/epdesc-components.png" alt="Endpoint Description"></div></div></section><section id="_explain_resource_discovery_2"><h2>Explain: Resource Discovery (2)</h2><div class="slide-content"><div class="imageblock"><img src="images/epdesc-components-extensible.png" alt="Endpoint Description" width="extensible"></div></div></section><section id="_explain_resource_structure"><h2>Explain: Resource Structure</h2><div class="slide-content"><div class="imageblock"><img src="images/epdesc-sub-resources-sprakbanken.png" alt="Endpoint Description" width="Resource structure"></div>
<aside class="notes"><div class="ulist"><ul><li><p>Source: <a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?operation=explain&amp;version=1.2&amp;x-fcs-endpoint-description=true" class="bare">https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?operation=explain&amp;version=1.2&amp;x-fcs-endpoint-description=true</a></p></li></ul></div></aside></div></section><section id="_query_language_fcs_ql"><h2>Query Language FCS-QL</h2><div class="slide-content"><div class="ulist"><ul><li><p>Based on CQP</p></li><li><p>Supports various annotation layers</p></li></ul></div>
<div class="imageblock"><img src="images/fcsql-query-builder.png" alt="Visual Query Builder for FCS-QL"></div></div></section><section id="_visualization_of_results"><h2>Visualization of Results</h2><div class="slide-content"><div class="imageblock"><img src="images/fcs-results-hits.png" alt="HITS Results"></div></div></section><section id="_visualization_of_results_2"><h2>Visualization of Results (2)</h2><div class="slide-content"><div class="imageblock"><img src="images/fcs-results-kwic.png" alt="KWIC Results"></div></div></section><section id="_visualization_of_results_3"><h2>Visualization of Results (3)</h2><div class="slide-content"><div class="imageblock"><img src="images/fcs-results-adv.png" alt="ADV Results"></div></div></section><section id="_current_state_of_the_fcs"><h2>Current state of the FCS</h2><div class="slide-content"><div class="ulist"><ul><li><p>Current version of the specification: <strong>FCS Core 2.0</strong></p></li><li><p>Poster at <a href="https://www.clarin.eu/sites/default/files/CLARIN2023_Bazaar_29.pdf">Bazaar @ CLARIN2023</a> on the current status</p></li><li><p>😎 “Awesome FCS” List: <a href="https://github.com/clarin-eric/awesome-fcs">github.com/clarin-eric/awesome-fcs</a>
with relevant links to specs, tools, libraries, implementations and much more</p><div class="ulist"><ul><li><p>Additions by Text+ (z.B. on LexFCS/LexCQL/Forks/Software): <a href="https://gitlab.gwdg.de/textplus/ag-fcs-documents/-/blob/main/awesome-fcs.md">gitlab.gwdg.de/textplus/ag-fcs-documents/-/blob/main/awesome-fcs.md</a></p></li></ul></div></li></ul></div></div></section><section id="_current_state_of_the_fcs_2"><div class="slide-content"><div class="ulist"><ul><li><p>CLARIN specifications: <a href="https://github.com/clarin-eric/fcs-misc">github.com/clarin-eric/fcs-misc</a></p></li><li><p>Small ecosystem (Code on <a href="https://github.com/clarin-eric?q=fcs">Github</a>/Gitlab)</p><div class="ulist"><ul><li><p>Software libraries (SRU/FCS, endpoint + client, Java/Python)</p></li><li><p>Aggregator (Code: <a href="https://github.com/clarin-eric/fcs-sru-aggregator">Github</a>, <a href="https://gitlab.gwdg.de/textplus/ag-fcs-lex-fcs-aggregator">Text+ Fork</a>)</p></li><li><p>Online Validator for Endpunkte (<a href="https://www.clarin.eu/fcsvalidator">fcsvalidator</a>, Code: <a href="https://github.com/clarin-eric/fcs-endpoint-tester">Github (old)</a>, <a href="https://github.com/saw-leipzig/fcs-endpoint-validator">Github (new)</a>)</p></li></ul></div></li><li><p>Endpunkte Registry: <a href="https://centres.clarin.eu/fcs">centres.clarin.eu/fcs</a></p></li></ul></div></div></section><section id="_current_work"><h2>Current Work</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>Lexical Resources</strong> extension</p><div class="ulist"><ul><li><p>First specification and implementation in Text+</p></li><li><p>Official extension of CLARIN → ~2024 Working Plan</p></li></ul></div></li></ul></div>
<div class="ulist mt-3"><ul><li><p><strong>AAI</strong> integration</p><div class="ulist"><ul><li><p>Specification and implementation</p></li><li><p>Goal: Support <em>access-restricted resources</em></p></li><li><p>Securing the aggregator via Shibboleth → Passing on AAI attributes to endpoints</p></li><li><p>Preliminary work from CLARIAH-DE, part of the Text+ work plan (IDS Mannheim, Uni/SAW Leipzig, preliminary work BBAW)</p></li></ul></div></li></ul></div></div></section><section id="_current_work_2"><h2>Current Work (2)</h2><div class="slide-content"><div class="ulist mt-3"><ul><li><p><strong>Syntactic Search</strong></p></li><li><p><strong>Entity Search</strong></p></li><li><p>Optional metadata for each result</p></li></ul></div></div></section><section id="_current_status_regarding_lexical_resources"><h2>Current status regarding <strong>Lexical Resources</strong></h2><div class="slide-content"><div class="ulist"><ul><li><p>CLARIN-EU Taskforce</p></li><li><p>CLARIN ERIC working plan: „extending the protocol to cover additional data types (e.g. lexica) will be explored“</p><div class="ulist"><ul><li><p>on the CLARIN 2024 Working Plan</p></li></ul></div></li><li><p>Interest expressed from various countries</p></li><li><p>Preliminary work: „RABA“ (Estland): e.g. „Eesti Wordnet“</p></li></ul></div></div></section><section id="_current_status_regarding_lexical_resources_2"><h2>Current status regarding <strong>Lexical Resources</strong> (2)</h2><div class="slide-content"><div class="ulist"><ul><li><p>First specification and implementation in Text+</p><div class="ulist"><ul><li><p>Specification on Zenodo: <a href="https://zenodo.org/records/7849754">zenodo.org/records/7849754</a></p></li><li><p>Presentation at eLex 2023: <a href="https://elex.link/elex2023/wp-content/uploads/69.pdf">“A Federated Search and Retrieval Platform for Lexical Resources in Text+ and CLARIN”</a></p></li><li><p>Aggregator: <a href="https://fcs.text-plus.org/?&amp;queryType=lex">fcs.text-plus.org/?queryType=lex</a></p></li></ul></div></li></ul></div></div></section><section id="_current_status_of_participants" class="text-left"><h2>Current status of participants</h2><div class="slide-content"><div class="paragraph"><p><strong>CLARIN</strong> (<a href="https://contentsearch.clarin.eu/">contentsearch.clarin.eu</a>, <a href="https://centres.clarin.eu/fcs">Registry</a>)</p></div>
<div class="ulist"><ul><li><p>209 Resources (94 in Advanced)</p><div class="paragraph"><p>in 61 Languages</p></div>
<div class="paragraph"><p>from 20 Institutions in 12 Countries</p></div></li></ul></div>
<div class="paragraph"><p><strong>Text+</strong> (<a href="https://fcs.text-plus.org/">fcs.text-plus.org</a>)</p></div>
<div class="ulist"><ul><li><p>53 Resources (17 in Advanced, 30 in Lexical)</p><div class="paragraph"><p>in 6 Languages</p></div>
<div class="paragraph"><p>from 9 Institutions in Germany</p></div></li></ul></div></div></section><section id="_integration_in_fcs_infrastructure" class="text-left"><h2>Integration in FCS Infrastructure</h2><div class="slide-content"><div class="paragraph"><p><strong>CLARIN</strong></p></div>
<div class="ulist"><ul><li><p>Alpha/Beta using Side-Loading in Aggregator</p></li><li><p>Stable/Long-Term: Entry in Centre Registry</p><div class="ulist"><ul><li><p>CLARIN Account + <a href="https://www.clarin.eu/webform/registration-form-centre-registry">Formular</a> as a Centre</p></li><li><p>Including monitoring etc.</p></li></ul></div></li></ul></div>
<div class="paragraph"><p><strong>Text+</strong></p></div>
<div class="ulist"><ul><li><p>Side-Loading in Aggregator</p></li><li><p><em>WIP</em>: Registry (index of endpoints)</p></li></ul></div></div></section><section id="_alternative_ways_of_using_fcs"><h2>Alternative Ways of using FCS</h2><div class="slide-content"><div class="ulist"><ul><li><p>Development of an alternative aggregator frontend as <em>Web Component</em></p><div class="ulist"><ul><li><p>Code: <a href="https://git.saw-leipzig.de/text-plus/FCS/textplus-fcs-store">Vue.js Store</a> + <a href="https://git.saw-leipzig.de/text-plus/FCS/textplus-fcs-vuetify">Vuetify Component (Dialog)</a>; <a href="https://tppssi-demo.saw-leipzig.de/">Demo</a></p></li><li><p>Use of the <a href="https://infra.clarin.eu/apis/">Aggregator API</a></p></li><li><p>Restriction to subset of resources, e.g. for integration on own website</p></li><li><p>Faceting, alternative visualization</p></li></ul></div></li></ul></div></div></section><section id="_bootstrapping_endpoint_development"><h2>Bootstrapping Endpoint Development</h2><div class="slide-content"><div class="ulist"><ul><li><p>Java: Maven Archetype <a href="https://github.com/clarin-eric/fcs-endpoint-archetype">github.com/clarin-eric/fcs-endpoint-archetype</a></p></li><li><p>Java &amp; Python (reference implementation Korp):</p><div class="ulist"><ul><li><p><a href="https://github.com/clarin-eric/fcs-korp-endpoint">github.com/clarin-eric/fcs-korp-endpoint</a></p></li><li><p><a href="https://github.com/Querela/fcs-korp-endpoint-python">github.com/Querela/fcs-korp-endpoint-python</a></p></li></ul></div></li><li><p>😎 “Awesome FCS” List: <a href="https://github.com/clarin-eric/awesome-fcs">github.com/clarin-eric/awesome-fcs</a></p><div class="ulist"><ul><li><p>List of reference implementations, endpoints, query parsers</p></li><li><p>Code for FCS SRU Aggregator and SRU/FCS Validator</p></li></ul></div></li></ul></div>
<div style="page-break-after: always;"></div></div></section></section>
<section><section id="_guide_to_endpoint_development" data-background-image="images/fcs-render-uk.png" data-background-opacity="0.5"><h2>Guide to Endpoint Development</h2><div class="slide-content"><aside class="notes"><div class="ulist"><ul><li><p>Important preliminary questions</p></li><li><p>Existing implementations, resources for new development</p></li><li><p>Prerequisites</p></li></ul></div></aside></div></section><section id="_development_decisions" class="text-left"><h2>Development Decisions</h2><div class="slide-content"><div class="paragraph"><p>❓ Can I host the endpoint myself?</p></div>
<div class="paragraph ms-5 mb-5"><p>❗ No → HelpDesk: CLARIN, Text+</p></div>
<div class="paragraph"><p>❓ What type of data do I have?</p></div>
<div class="paragraph mds-5 mb-5"><p>❗ Raw text, Vertical/CONLL, TEI, …</p></div>
<div class="paragraph"><p>❓ Which search engine do I use / can I use?</p></div>
<div class="paragraph ms-5 mb-5"><p>❗ KorAP, Korp/CWB, Lucene/Solr/ElasticSearch, BlackLab, (No)SketchEngine, …</p></div></div></section><section id="_development_decisions_2" class="text-left"><h2>Development Decisions (2)</h2><div class="slide-content"><div class="paragraph"><p>❓ Customization or new development?</p></div>
<div class="paragraph ms-5 mb-5"><p>❗ List of existing endpoint implementations  (<a href="https://github.com/clarin-eric/awesome-fcs#endpoint-implementations">Awesome List</a>)</p></div>
<div class="paragraph"><p>❓ Programming language?</p></div>
<div class="paragraph ms-5 mb-5"><p>❗ Java, Python, (PHP, XQuery)</p></div>
<div class="paragraph"><p>❓ In-house development: Use of the reference libraries (Java, Python)</p></div>
<div class="paragraph ms-5"><p>❗ Maven Archetype, Korp</p></div>
<div class="paragraph ms-5"><p>❗ SRU + FCS specifications …</p></div></div></section><section id="_endpoint_implementations"><h2>Endpoint Implementations</h2><div class="slide-content"><div class="ulist"><ul><li><p><a href="https://github.com/clarin-eric/fcs-korp-endpoint">Korp FCS 2.0</a> - reference implementation, <a href="https://www.kielipankki.fi/support/korp-advanced/">Korp corpus search</a></p></li><li><p><a href="https://github.com/clarin-eric/fcs-sru-cqi-bridge">CQP/SRU bridge</a> - Corpus Workbench (CWB)</p></li><li><p><a href="https://github.com/czcorpus/kontext">KonText</a>, <a href="https://github.com/Leipzig-Corpora-Collection/fcs-noske-endpoint">fcs-noske-endpoint</a> - (No)SketchEngine (CONLL/Vertical)</p></li><li><p><a href="https://github.com/OCLC-Research/oclcsrw">oclcsrw</a> - SRW/SRU server for DSpace, Lucene and/or Pears/Newton</p></li><li><p><a href="https://github.com/vronk/corpus_shell">corpus_shell</a>, <a href="https://github.com/vronk/SADE/tree/cr-xq">SADE</a> - MySQL PHP/DDC Perl, eXist/XQuery</p></li><li><p><a href="https://github.com/acdh-oeaw/arche-fcs/">arche-fcs</a> - ARCHE Suite, php</p></li><li><p><a href="https://github.com/INL/clariah-fcs-endpoints">Blacklab / MTAS</a> - corpus search engines using Lucene/Solr</p></li><li><p><a href="https://github.com/KorAP/KorapSRU">KorapSRU</a> - KorAP (IDS)</p></li></ul></div>
<div class="openblock refs"><div class="content"><div class="paragraph"><p>Sources: <a href="https://www.clarin.eu/content/federated-content-search-clarin-fcs-technical-details">clarin</a>, <a href="https://github.com/clarin-eric/awesome-fcs">awesome-fcs</a></p></div></div></div></div></section><section id="_new_endpoint_development"><h2>New Endpoint Development</h2><div class="slide-content"><div class="ulist"><ul><li><p>Customization of reference implementation (Korp)</p><div class="ulist"><ul><li><p>Java: <a href="https://github.com/clarin-eric/fcs-korp-endpoint">github.com/clarin-eric/fcs-korp-endpoint</a></p></li><li><p>Python: <a href="https://github.com/Querela/fcs-korp-endpoint-python/">github.com/Querela/fcs-korp-endpoint-python</a></p></li></ul></div></li><li><p>Development using CLARIN SRU/FCS libraries</p><div class="ulist"><ul><li><p>Java: <a href="https://github.com/clarin-eric/fcs-endpoint-archetype">github.com/clarin-eric/fcs-endpoint-archetype</a></p></li><li><p>Docs:</p><div class="ulist"><ul><li><p>Java SRU: <a href="https://clarin-eric.github.io/fcs-sru-server/apidocs/index.html">clarin-eric.github.io/fcs-sru-server/apidocs/index.html</a></p></li><li><p>Java FCS: <a href="https://clarin-eric.github.io/fcs-simple-endpoint/apidocs/index.html">clarin-eric.github.io/fcs-simple-endpoint/apidocs/index.html</a></p></li><li><p>Python SRU: <a href="https://fcs-sru-server-python.readthedocs.io/en/latest/">fcs-sru-server-python.readthedocs.io</a></p></li><li><p>Python FCS: <a href="https://fcs-simple-endpoint-python.readthedocs.io/en/latest/">fcs-simple-endpoint-python.readthedocs.io</a></p></li></ul></div></li></ul></div></li></ul></div></div></section><section id="_new_endpoint_development_2"><h2>New Endpoint Development (2)</h2><div class="slide-content"><div class="ulist"><ul><li><p>“New” development specifications (for other languages)</p><div class="ulist"><ul><li><p>SRU: <a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part0-overview/searchRetrieve-v1.0-os-part0-overview.html">OASIS SRU Overview</a>,  <a href="https://www.loc.gov/standards/sru/">Library of Congress SRU</a></p></li><li><p>FCS: <a href="https://github.com/clarin-eric/fcs-misc">github.com/clarin-eric/fcs-misc</a> → “FCS Core 2.0”</p></li></ul></div></li><li><p>Awesome List: <a href="https://github.com/clarin-eric/awesome-fcs">github.com/clarin-eric/awesome-fcs</a></p></li></ul></div></div></section><section id="_prerequisite_for_local_search_engine" class="text-left"><h2>Prerequisite for local search engine</h2><div class="slide-content"><div class="paragraph"><p>❗ Full-text search</p></div>
<div class="paragraph ms-5"><p>❓ With Hit markers</p></div>
<div class="paragraph mb-5"><p>❓ Corpus search (segmented text with annotations)</p></div>
<div class="paragraph mb-5"><p>❕ Pagination (total number of hits)</p></div>
<div class="paragraph"><p>❗ Resource PID</p></div>
<div class="paragraph"><p>❓ Linking to result pages</p></div>
<div style="page-break-after: always;"></div></div></section></section>
<section><section id="_fundamentals" data-background-image="images/fcs-render-uk.png" data-background-opacity="0.5"><h2>Fundamentals</h2><div class="slide-content"><aside class="notes"><div class="ulist"><ul><li><p>SRU (Overview, APD/Models, Request Parameter, Diagnostics, …)</p></li><li><p>FCS (Discovery, Endpoint Description, Search, SRU Parameter, Diagnostics)</p></li><li><p>FCS Notes (Versions, Compatibility, Aggregator)</p></li></ul></div></aside></div></section><section id="_disclaimer" class="text-left"><h2>Disclaimer</h2><div class="slide-content"><div class="paragraph"><p>Main focus on:</p></div>
<div class="ulist ms-5"><ul><li><p>Version: <strong>FCS Core 2.0</strong>; maximum compatibility with FCS Core 1.0</p></li><li><p><strong>SRU Server</strong>, <strong>FCS Endpunkt</strong>; not FCS client application development</p></li><li><p>Using the reference libraries</p><div class="paragraph"><p>→ <strong>Java</strong> and <strong>Python</strong></p></div></li><li><p>Possible (re-)use of existing endpoints</p></li></ul></div>
<div class="paragraph"><p>No:</p></div>
<div class="ulist ms-5"><ul><li><p>Working through the specification; only the essential information</p></li><li><p>New or redevelopment of SRU/FCS protocols, libraries etc.</p><div class="paragraph"><p>(e.g. in other languages)</p></div></li></ul></div></div></section><section id="_sru_history" class="text-left"><h2>SRU – History</h2><div class="slide-content"><div class="paragraph"><p>SRU: <strong>Search/Retrieve via URL</strong> → <a href="https://www.loc.gov/standards/sru/">LOC</a></p></div>
<div class="ulist"><ul><li><p>Originally developed by the <em>Library of Congress (LOC)</em></p><div class="paragraph"><p>2004: <strong>SRU 1.1</strong> - <a href="https://www.loc.gov/standards/sru/sru-1-1.html">LOC</a></p></div>
<div class="paragraph"><p>2007: <strong>SRU 1.2</strong> - <a href="https://www.loc.gov/standards/sru/sru-1-2.html">LOC</a></p></div></li><li><p>As of SRU 2.0 standardized by <em>OASIS</em> <sup class="footnote">[<span class="footnote" title="View footnote.">1</span>]</sup> as <em>“searchRetrieve Version 1.0 OASIS Standard”</em></p><div class="paragraph"><p>2013: SRU 2.0 - <a href="https://www.loc.gov/standards/sru/sru-2-0.html">LOC</a>, <a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part0-overview/searchRetrieve-v1.0-os-part0-overview.html">OASIS</a> (<a href="https://www.oasis-open.org/news/announcements/searchretrieve-version-1-0-oasis-standard-published/">OASIS Announcement</a>)</p></div>
<div class="paragraph"><p>Extension of SRU 1.2 → Differences to SRU 1.2 (<a href="https://www.loc.gov/standards/sru/differences.html">LOC</a>)</p></div></li></ul></div></div><div class="footnotes"><div class="footnote">1. OASIS: Organization for the Advancement of Structured Information Standards</div></div></section><section id="_searchretrieve_version_1_0_oasis_standard"><h2>searchRetrieve Version 1.0 – OASIS Standard</h2><div class="slide-content"><div class="ulist"><ul><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part0-overview/searchRetrieve-v1.0-os-part0-overview.html">Part 0</a>. Overview Version 1.0</p></li><li><p></p><div class="openblock darkgrey"><div class="content"><div class="paragraph"><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part1-apd/searchRetrieve-v1.0-os-part1-apd.html">Part 1</a>. <strong>Abstract Protocol Definition</strong> Version 1.0</p></div></div></div></li><li><p></p><div class="openblock darkgrey"><div class="content"><div class="paragraph"><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part2-sru1.2/searchRetrieve-v1.0-os-part2-sru1.2.html">Part 2</a>. SRU <strong>searchRetrieve Operation</strong>: APD Binding for <strong>SRU 1.2</strong> Version 1.0</p></div></div></div></li><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html">Part 3</a>. SRU <strong>searchRetrieve Operation</strong>: APD Binding for <strong>SRU 2.0</strong> Version 1.0</p></li><li><p></p><div class="openblock darkgrey"><div class="content"><div class="paragraph"><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part4-opensearch/searchRetrieve-v1.0-os-part4-opensearch.html">Part 4</a>. <s>APD Binding for <strong>OpenSearch</strong> 1.0  version 1.0</s></p></div></div></div></li><li><p></p><div class="openblock darkgrey"><div class="content"><div class="paragraph"><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part5-cql/searchRetrieve-v1.0-os-part5-cql.html">Part 5</a>.  <strong>CQL</strong>: The Contextual Query Language  version 1.0</p></div></div></div></li><li><p></p><div class="openblock darkgrey"><div class="content"><div class="paragraph"><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part6-scan/searchRetrieve-v1.0-os-part6-scan.html">Part 6</a>.  SRU <strong>Scan Operation</strong> version 1.0</p></div></div></div></li><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part7-explain/searchRetrieve-v1.0-os-part7-explain.html">Part 7</a>. SRU <strong>Explain Operation</strong> version 1.0</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>grayed out: not relevant for us</p></li><li><p>crossed out: plays no role at all for the FCS</p></li></ul></div></aside></div></section><section id="_searchretrieve_part_0_overview_version_1_0" class="x-small"><h2>searchRetrieve: Part 0. – Overview Version 1.0</h2><div class="slide-content"><div class="paragraph"><p><strong>SRU</strong> (<em>SRU: Search/Retrieve via URL</em>) is a <span class="blue">web service protocol</span> supported over both SOAP and <span class="blue">REST for client-server based search</span>. <strong>SRU1.x</strong> was developed as a web service replacement for the NISO Z39.50 protocol. <span class="blue"><strong>SRU2.0</strong> is a revision to <strong>SRU</strong></span> which as well as including many enhancements to SRU1.2 was developed alongside the <strong>APD</strong>.</p></div>
<div class="paragraph"><p>For the SRU protocol model, three operations are defined as part of its <strong>Processing Model</strong>:</p></div>
<div class="ulist"><ul><li><p><strong>SearchRetrieve Operation</strong>. The actual SearchRetrieve operation defined by the SRU protocol; A SearchRetrieve operation consists of a <span class="blue">SearchRetrieve request from client to server followed by a SearchRetrieve response from server to client</span>.</p></li><li><p><strong>Scan Operation</strong>. Similar to SRU, the Scan protocol defines a request message and a response message for <span class="blue">iterating through available search terms</span>. a Scan operation consists of a Scan request followed by a Scan response.</p></li><li><p><strong>Explain Operation</strong>. Every SRU or scan server provides an associated <span class="blue">Explain document</span> as part of its <strong>Description and Discovery Model</strong>, providing <span class="blue">information about the server’s capabilities</span>. A client may retrieve this document and use the information to <span class="blue">self-configure and provide an appropriate interface to the user</span>. When a client retrieves an Explain document, this constitutes an Explain operation.</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part1-apd/searchRetrieve-v1.0-os-part1-apd.html" class="bare">http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part1-apd/searchRetrieve-v1.0-os-part1-apd.html</a></p></li><li><p>SRW = search/retrieve for the web</p></li></ul></div></aside></div></section><section id="_searchretrieve_apd_and_bindings"><h2>searchRetrieve – APD and Bindings</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>Abstract Protocol Definition (APD)</strong> für <em>“searchRetrieve operation”</em></p><div class="ulist"><ul><li><p>Model for <em>SearchRetrieve Operation</em></p></li><li><p>Describes <em>Capabilities</em> and  <em>General Characteristics</em> of a Server or Search Engine, as well as how access should take place</p></li><li><p>Defines abstract Request parameters and Response elements</p></li></ul></div></li><li><p><strong>Binding</strong></p><div class="ulist"><ul><li><p>Describes corresponding names of the parameters and elements</p></li><li><p><em>static</em> (for human), <em>dynamic</em> (for machine), …</p></li><li><p>Bindings: SRU 1.2, <strong>SRU 2.0</strong>, (OpenSearch)</p></li><li><p>Examples: “startPosition” (APD) → “startRecord” (SRU 2.0)</p><div class="paragraph"><p>“recordPacking” (SRU 1.2) → “recordXMLEscaping” (SRU 2.0)</p></div></li></ul></div></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#recordPacking" class="bare">http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#recordPacking</a></p></li></ul></div></aside></div></section><section id="_searchretrieve_apd_abstract_models" class="text-left"><h2>searchRetrieve – APD Abstract Models</h2><div class="slide-content"><div class="paragraph"><p><strong>Data Model</strong><br>
Description of the data on which the search is to be executed</p></div>
<div class="paragraph"><p><strong>Query Model</strong><br>
Description of the construction of search queries</p></div>
<div class="paragraph"><p><strong>Processing Model</strong><br>
Description of how query is sent from client to server</p></div>
<div class="paragraph"><p><strong>Result Set Model</strong><br>
Structure of the results of a search</p></div>
<div class="paragraph"><p><strong>Diagnostics Model</strong><br>
Description of how errors are communicated from the server to the client</p></div>
<div class="paragraph"><p><strong>Description and Discovery Model</strong><br>
Description, for the discovery of the “Search Service”, self-description of the functionality of the service</p></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part0-overview/searchRetrieve-v1.0-os-part0-overview.html#_Toc312151029" class="bare">http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part0-overview/searchRetrieve-v1.0-os-part0-overview.html#_Toc312151029</a></p></li></ul></div></aside></div></section><section id="_sru_2_0" class="hidden"><h2>SRU 2.0</h2><div class="slide-content"><div class="ulist"><ul><li><p>Request / response flow  (Client ↔ Server)</p><div class="ulist"><ul><li><p>HTTP GET/POST with set of parameters (extensible)</p></li></ul></div></li><li><p>Request processing on the server</p></li><li><p>Operations: searchRetrieve, scan, explain</p></li><li><p>Data model with result sets, records and associated schemas</p></li><li><p>Diagnostics: (non-)fatal for warnings and errors</p></li><li><p>No fixed serialization, <strong>XML for FCS</strong></p></li></ul></div></div></section><section id="_sru_2_0_operation_model"><h2>SRU 2.0 – Operation Model</h2><div class="slide-content"><div class="ulist"><ul><li><p>SRU Request (Client → Server) with Response (Server → Client)</p></li><li><p>Operations</p><div class="ulist"><ul><li><p>SearchRetrieve</p></li><li><p>Scan</p></li><li><p>Explain</p></li></ul></div></li></ul></div></div></section><section id="_sru_2_0_data_model"><h2>SRU 2.0 – Data Model</h2><div class="slide-content"><div class="ulist"><ul><li><p>Server = Database for Client for search/retrieval</p></li><li><p>Database = Collection of Units of Data → Abstract Record</p></li><li><p><strong>Abstract Records</strong> (or <strong>Response Records</strong>) in one/multiple formats by server</p></li><li><p>Format (or Item Type) = <strong>Record Schema</strong></p></li></ul></div></div></section><section id="_sru_2_0_protocol_model" class="columns"><h2>SRU 2.0 – Protocol Model</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>HTTP GET</strong></p><div class="ulist"><ul><li><p>Parameters encoded as “<code>key=value</code>”</p></li><li><p>UTF-8</p></li><li><p><code>%</code>-Escaping</p></li><li><p>Separation at “<code>?</code>”, “<code>&amp;</code>”, “<code>=</code>”</p></li></ul></div></li><li><p><strong>HTTP POST</strong></p><div class="ulist"><ul><li><p><code>application/x-www-form-urlencoded</code></p></li><li><p>No character encoding necessary</p></li><li><p>No length restriction</p></li></ul></div></li><li><p><span class="darkgrey">HTTP SOAP (?)</span></p></li></ul></div>
<div class="imageblock" style="float: right"><img src="images/sru-protocol-model.gif" alt="SRU Protocol"></div></div></section><section id="_sru_2_0_processing_model"><h2>SRU 2.0 – Processing Model</h2><div class="slide-content"><div class="ulist"><ul><li><p>“Request processing on the server”</p></li><li><p>Request</p><div class="ulist"><ul><li><p>Number of records</p></li><li><p>Identifier for Record Schema (→ Records in Response)</p></li><li><p>Identifier for Response Schema (→ whole Response)</p></li></ul></div></li><li><p>Response</p><div class="ulist"><ul><li><p>Records in Result Set</p></li><li><p>Diagnostic Information</p></li><li><p>Result Set Identifier for requests for further results</p></li></ul></div></li></ul></div></div></section><section id="_sru_2_0_query_model"><h2>SRU 2.0 – Query Model</h2><div class="slide-content"><div class="ulist"><ul><li><p>Any “appropriate query language” can be used</p></li><li><p>Mandatory support of</p><div class="paragraph"><p>“Contextual Query Language” (CQL)</p></div></li></ul></div></div></section><section id="_sru_2_0_parameter_model"><h2>SRU 2.0 – Parameter Model</h2><div class="slide-content"><div class="ulist"><ul><li><p>Use of Parameters, some predefined by SRU 2.0</p></li><li><p>Parameters not defined in the protocol are also permitted</p></li><li><p>Parameter “<code>query</code>”</p><div class="ulist"><ul><li><p>included in every query in some manner (“<code>query</code>” or by parameters not defined in the protocol)</p></li><li><p>Query with “<code>queryType</code>” (default “<code>cql</code>”)</p></li></ul></div></li></ul></div></div></section><section id="_sru_2_0_result_set_model"><h2>SRU 2.0 – Result Set Model</h2><div class="slide-content"><div class="ulist"><ul><li><p>Logical model → “Result Sets” are not mandatory</p></li><li><p>Query → Selection of suitable Records</p><div class="ulist"><ul><li><p>Ordered list, <em>non-modifiable set</em> after creation</p></li><li><p>Sorting/order determined by server</p></li></ul></div></li><li><p>for Client:</p><div class="ulist"><ul><li><p>Set of abstract Records, counting starts with <code>1</code></p></li><li><p>Each record <em>can</em> be requested in its own format</p></li><li><p>Individual records can <em>“disappear”</em>, no reordering in the Result Set by the Server, but Diagnostic to inform</p></li></ul></div></li></ul></div></div></section><section id="_sru_2_0_diagnostic_model" class="small"><h2>SRU 2.0 – Diagnostic Model</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>fatal</strong></p><div class="ulist"><ul><li><p>Execution of the query cannot be completed</p></li><li><p>e.g. invalid query</p></li></ul></div></li><li><p><strong>non-fatal</strong></p><div class="ulist"><ul><li><p>Processing impaired, but request can be completed</p></li><li><p>e.g. individual records are not available in the requested schema, server only sends the available ones and informs about the rest</p></li><li><p></p><div class="openblock mt-5"><div class="content"><div class="paragraph"><p><strong>surrogate</strong></p></div></div></div>
<div class="ulist"><ul><li><p>For single Records</p></li></ul></div></li><li><p><strong>non-surrogate</strong></p><div class="ulist"><ul><li><p>All records are available, but something went wrong, e.g. sorting</p></li><li><p>Or simply a warning</p></li></ul></div></li></ul></div></li></ul></div></div></section><section id="_sru_2_0_explain_model"><h2>SRU 2.0 – Explain Model</h2><div class="slide-content"><div class="ulist"><ul><li><p>Must be available for HTTP GET via the <strong>base URL</strong> of the SRU server</p></li><li><p>→ Server Capabilities</p></li><li><p>In the client for self-configuration and to provide the corresponding user interface</p></li><li><p>Details on supported Query Types, CQL Context Sets, Diagnostic Sets, Records Schemas, Sorting options, defaults, …</p></li></ul></div></div></section><section id="_sru_2_0_serialization_model"><h2>SRU 2.0 – Serialization Model</h2><div class="slide-content"><div class="ulist"><ul><li><p>No restriction on the serialization of responses</p><div class="paragraph"><p>(for the entire message or single records)</p></div></li><li><p>Non-XML serialization is allowed</p></li></ul></div></div></section><section id="_searchretrieve_2_0_request_parameter"><h2>searchRetrieve 2.0 – Request Parameter</h2><div class="slide-content"><div class="ulist"><ul><li><p>All parameters are optional, non-repeatable</p></li><li><p><span class="blue"><strong>query</strong>, <strong>startRecord</strong>, <strong>maximumRecords</strong>, recordXMLEscaping, recordSchema, resultSetTTL, stylesheet; Extension parameters</span></p></li><li><p>New in 2.0: <span class="blue"><strong>queryType</strong>, sortKeys, renderedBy, httpAccept, responseType, recordPacking; Facet  Parameters</span></p></li></ul></div>
<div class="ulist mt-5"><ul><li><p>Spec: “<a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#_Toc324162435">Actual Request Parameters for this Binding</a>”</p></li></ul></div></div></section><section id="_searchretrieve_2_0_response_elements"><h2>searchRetrieve 2.0 – Response Elements</h2><div class="slide-content"><div class="ulist"><ul><li><p>All elements are optional, non-repeatable by default</p></li><li><p><span class="blue"><strong>numberOfRecords</strong>, resultSetId, <strong>records</strong>, <strong>nextRecordPosition</strong>, echoedSearchRetrieveRequest, <strong>diagnostics</strong>, extraResponseDataⓇ</span></p></li><li><p>New in 2.0: <span class="blue">resultSetTTL, resultCountPrecisionⓇ, facetedResultsⓇ, searchResultAnalysisⓇ</span></p><div class="paragraph"><p>(Ⓡ = repeatable)</p></div></li></ul></div>
<div class="ulist mt-5"><ul><li><p>Spec: “<a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#_Toc324162438">Actual Response Elements for this Binding</a>”</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#_Toc324162438" class="bare">http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#_Toc324162438</a></p></li></ul></div></aside></div></section><section id="_searchretrieve_2_0_query"><h2>searchRetrieve 2.0 – Query</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong><code>query</code></strong> (Parameter)</p><div class="ulist"><ul><li><p>Query</p></li><li><p>Mandatory if no specification of <em><code>queryType</code></em></p></li></ul></div></li><li><p><strong><code>queryType</code></strong> (Parameter, SRU 2.0)</p><div class="ulist"><ul><li><p>Optional, by default “<code>cql</code>”</p></li><li><p>Query Types must be listed in the Explain, with URL for definition and usage abbreviation</p></li><li><p>Reserved</p><div class="ulist"><ul><li><p><code>cql</code></p></li><li><p><code>searchTerms</code> (processing is left to the server, &lt; SRU 2.0)</p></li></ul></div></li></ul></div></li></ul></div></div></section><section id="_searchretrieve_2_0_query_examples"><h2>searchRetrieve 2.0 – Query (Examples)</h2><div class="slide-content"><div class="ulist"><ul><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?query=cat">spraakbanken.gu.se/…/sru?<strong>query=cat</strong></a></p><div class="paragraph"><p>(default, FCS 2.0, SRU 2.0)</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?operation=searchRetrieve&amp;version=1.2&amp;query=cat">spraakbanken.gu.se/…/sru?<strong>operation=searchRetrieve</strong>&<strong>version=1.2</strong>&query=cat</a></p><div class="paragraph"><p>(FCS 1.0, SRU 1.2)</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?operation=searchRetrieve&amp;queryType=cql&amp;query=%22anv%C3%A4ndning%22">spraakbanken.gu.se/…/sru?operation=searchRetrieve&queryType=cql&<strong>query=%22anv%C3%A4ndning%22</strong></a></p><div class="paragraph"><p>(FCS 2.0, SRU 2.0)</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?operation=searchRetrieve&amp;queryType=fcs&amp;query=%5bword%3d%22anv%C3%A4ndning%22%5d&amp;x-cmd-resource-info=true">spraakbanken.gu.se/…/sru?operation=searchRetrieve&<strong>queryType=fcs</strong>&query=%5bword%3d%22anv%C3%A4ndning%22%5d&x-cmd-resource-info=true</a></p><div class="paragraph"><p>(FCS 2.0 mit FCS-QL Query)</p></div></li></ul></div></div></section><section id="_searchretrieve_2_0_pagination"><h2>searchRetrieve 2.0 – Pagination</h2><div class="slide-content"><div class="ulist"><ul><li><p>Query for result range of <em><code>startRecord</code></em> with maximum <em><code>maximumRecords</code></em></p></li><li><p><strong><code>startRecord</code></strong> (Parameter)</p><div class="ulist"><ul><li><p>Optional, positive integer, starting with <code>1</code></p></li></ul></div></li><li><p><strong><code>maximumRecords</code></strong> (Parameter)</p><div class="ulist"><ul><li><p>Optional, non-negative integer</p></li><li><p>Server selects default if not specified</p></li><li><p>Server can respond with fewer records, never more</p></li></ul></div></li></ul></div></div></section><section id="_searchretrieve_2_0_pagination_2"><h2>searchRetrieve 2.0 – Pagination (2)</h2><div class="slide-content"><div class="ulist"><ul><li><p>Response with total number (<em><code>numberOfRecords</code></em>) of records in the Result Set, with offset (<em><code>nextRecordPosition</code></em>) to next results</p></li><li><p><strong><code>numberOfRecords</code></strong> (Element)</p><div class="ulist"><ul><li><p>Number of results in the Result Set</p></li><li><p>If query fails, it must be “<code>0</code>”</p></li></ul></div></li><li><p><strong><code>nextRecordPosition</code></strong> (Element)</p><div class="ulist"><ul><li><p>Counter for next result set, if last record in the response is not last in the result set</p></li><li><p>If no further records, then this element must not appear</p></li></ul></div></li></ul></div></div></section><section id="_searchretrieve_2_0_result_set"><h2>searchRetrieve 2.0 – Result Set</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong><code>resultSetId</code></strong> (Element)</p><div class="ulist"><ul><li><p>Optional, identifier for the Result Set, for referencing in the subsequent requests</p></li></ul></div></li><li><p><strong><code>resultSetTTL</code></strong> (Parameter / Element, Element in SRU 2.0 only)</p><div class="ulist"><ul><li><p>Optional, in seconds</p></li><li><p>In request from Client when Result Set is no longer used</p></li><li><p>In response from Server, how long Result Set is available (“good-faith estimate”, → can be longer or shorter)</p></li></ul></div></li><li><p><strong><code>resultCountPrecision</code></strong> (Element, SRU 2.0)</p><div class="ulist"><ul><li><p>URI: “<code>info:srw/vocabulary/resultCountPrecision/1/…</code>”</p></li><li><p><code>exact</code> / <code>unknown</code> / <code>estimate</code> / <code>maximum</code> / <code>minimum</code> / <code>current</code></p></li></ul></div></li></ul></div></div></section><section id="_searchretrieve_2_0_pagination_cont"><h2>searchRetrieve 2.0 – Pagination (Cont.)</h2><div class="slide-content"><div class="imageblock position-absolute right--30 width-75 opacity-50"><img src="images/fcs-sru-results-xml.png" alt="Response XML for CQL search for &quot;cat&quot;"></div>
<div class="ulist"><ul><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?query=cat">spraakbanken.gu.se/…/sru?<strong>query=cat</strong></a></p><div class="paragraph"><p>→ 9220 results, next results starting from 251</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?query=cat&amp;startRecord=300&amp;maximumRecords=10">spraakbanken.gu.se/…/sru?query=cat&<strong>startRecord=300</strong>&<strong>maximumRecords=10</strong></a></p><div class="paragraph"><p>→ More from 310</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?query=cat&amp;startRecord=10000&amp;maximumRecords=10">spraakbanken.gu.se/…/sru?query=cat&<strong>startRecord=10000</strong>&maximumRecords=10</a></p><div class="paragraph"><p>→ Error, because “out of range”</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?query=catsss">spraakbanken.gu.se/…/sru?<strong>query=catsss</strong></a></p><div class="paragraph"><p>→ No results</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?query=cat&amp;maximumRecords=100000">spraakbanken.gu.se/…/sru?query=cat&<strong>maximumRecords=100000</strong></a></p><div class="paragraph"><p>→ Restricted to 1000 Records</p></div></li></ul></div></div></section><section id="_searchretrieve_2_0_serialization"><h2>searchRetrieve 2.0 – Serialization</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong><code>recordXMLEscaping</code></strong> (Parameter, SRU 2.0)</p><div class="ulist"><ul><li><p>If records are serialized as XML, “<code>string</code>” of the Records can be escaped (“<code>&lt;</code>”, “<code>&gt;</code>”, “<code>&amp;</code>”); default is “<code>xml</code>” as direct embedding of the Records in the Response, e.g. for Stylesheets</p></li></ul></div></li><li><p><strong><code>recordPacking</code></strong> (Parameter, SRU 2.0)</p><div class="ulist"><ul><li><p>In SRU 1.2 used to have the semantic of <code>recordXMLEscaping</code></p></li><li><p>“<code>packed</code>” (default), Server should deliver Records with requested schema; “<code>unpacked</code>”, Server can determine the location of the application data in the Records itself (?)</p></li></ul></div></li></ul></div></div></section><section id="_searchretrieve_2_0_serialization_2"><h2>searchRetrieve 2.0 – Serialization (2)</h2><div class="slide-content"><div class="ulist"><ul><li><p></p><div class="openblock darkgrey"><div class="content"><div class="paragraph"><p><strong><code>httpAccept</code></strong> (Parameter, SRU 2.0)</p></div></div></div>
<div class="ulist"><ul><li><p></p><div class="openblock darkgrey"><div class="content"><div class="paragraph"><p>Schema for Response, default is “<code>application/sru+xml</code>”</p></div></div></div></li></ul></div></li><li><p></p><div class="openblock darkgrey"><div class="content"><div class="paragraph"><p><strong><code>responseType</code></strong> (Parameter)</p></div></div></div>
<div class="ulist"><ul><li><p></p><div class="openblock darkgrey"><div class="content"><div class="paragraph"><p>Schema for Response (in combination with <code>httpAccept</code> parameter)</p></div></div></div></li></ul></div></li><li><p><strong><code>recordSchema</code></strong> (Parameter)</p><div class="ulist"><ul><li><p>Schema of the Records in Response, e.g. “<code><a href="http://clarin.eu/fcs/resource" class="bare">http://clarin.eu/fcs/resource</a></code>”</p></li><li><p>Identifier for schema from Explain Response</p></li></ul></div></li><li><p><strong><code>records</code></strong> (Element)</p><div class="ulist"><ul><li><p>Contains Records / Surrogate Diagnostics</p></li><li><p>According to <a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#sruplusxml">default Schema</a> a list of “<code>&lt;record&gt;</code>” elements</p></li></ul></div></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><strong><code>recordSchema</code></strong> with <code><a href="http://clarin.eu/fcs/resource" class="bare">http://clarin.eu/fcs/resource</a></code> can be used for multiplexing if several SRU functionalities are offered via one endpoint, e.g. also DFG Viewer or similar.</p></li></ul></div></aside></div></section><section id="_searchretrieve_2_0_serialization_3"><h2>searchRetrieve 2.0 – Serialization (3)</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong><code>stylesheet</code></strong> (Parameter)</p><div class="ulist"><ul><li><p>URL to stylesheet, for display to the user</p></li><li><p><strong><code>renderedBy</code></strong> (Parameter, SRU 2.0)</p></li><li><p>Where is stylesheet for Response rendered</p></li><li><p>“<code>client</code>” (default), URL of <em><code>stylesheet</code></em> parameter is simply echoed → “thin client” (in Web Browser)</p></li><li><p></p><div class="openblock darkgrey"><div class="content"><div class="paragraph"><p>“<code>server</code>”, should transform default SRU response with stylesheet (e.g. for <em><code>httpAccept</code></em> with HTML format)</p></div></div></div></li></ul></div></li></ul></div></div></section><section id="_searchretrieve_2_0_serialization_4"><h2>searchRetrieve 2.0 – Serialization (4)</h2><div class="slide-content"><div class="ulist"><ul><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?query=cat&amp;recordXMLEscaping=string">spraakbanken.gu.se/…/sru?query=cat&<strong>recordXMLEscaping=string</strong></a></p><div class="paragraph"><p>→ Possible serialization error in Java library</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?operation=searchRetrieve&amp;version=1.2&amp;query=cat&amp;version=1.2&amp;recordPacking=string">spraakbanken.gu.se/…/sru?<strong>operation=searchRetrieve</strong>&version=1.2&query=cat&<strong>version=1.2</strong>&<strong>recordPacking=string</strong></a></p><div class="paragraph"><p>(FCS 1.0, SRU 1.2, like <em><code>recordXMLEscaping</code></em>)</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?query=cat&amp;recordPacking=unpacked">spraakbanken.gu.se/…/sru?query=cat&<strong>recordPacking=unpacked</strong></a></p><div class="paragraph"><p>→ No noticeable change here</p></div></li><li><p>…</p></li></ul></div></div></section><section id="_searchretrieve_2_0_unsupported_parameters"><h2>searchRetrieve 2.0 – Unsupported Parameters</h2><div class="slide-content"><div class="ulist"><ul><li><p>Sorting (<em><code>sortKeys</code></em>) and Faceting not supported</p></li></ul></div></div></section><section id="_sru_2_0_extensions"><h2>SRU 2.0 – Extensions</h2><div class="slide-content"><div class="ulist"><ul><li><p>Extensions possible in</p><div class="ulist"><ul><li><p>Request via <strong>Extension Parameter</strong></p></li><li><p>(prefixed with “<code>x-</code>” and namespace identifier, e.g. “<code>x-fcs-</code>”)</p></li></ul></div></li><li><p>Response in the <strong>“<code>&lt;extraResponseData&gt;</code>” Element</strong></p></li><li><p>Response with <code>extraResponseData</code>, <em>only</em> if requested in Request with corresponding parameter, never voluntary</p><div class="ulist"><ul><li><p>Server can ignore the request, no obligation</p></li></ul></div></li><li><p>Unknown extension parameters are to be ignored</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#Extensions" class="bare">http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#Extensions</a></p></li></ul></div></aside></div></section><section id="_sru_2_0_backwards_compatibility"><h2>SRU 2.0 – Backwards Compatibility</h2><div class="slide-content"><div class="ulist"><ul><li><p>Parameters “<code>operation</code>” and “<code>version</code>” only in SRU 1.1/SRU 1.2, removed in SRU 2.0 → Assumption of a separate endpoint for each SRU version</p></li><li><p>Heuristic for detecting the SRU version</p><div class="ulist"><ul><li><p><code>searchRetrieve</code> = <code>query</code> or <code>queryType</code> parameter</p></li><li><p><code>scan</code> = <code>scanClause</code> parameter</p></li><li><p><code>explain</code></p></li></ul></div></li><li><p>Interoperability with older versions:</p><div class="ulist"><ul><li><p>Use of <code>operation</code>/<code>version</code> parameters → SRU &lt; 2.0</p></li><li><p>Caution with parameters with changed semantics</p><div class="paragraph"><p>especially <code>recordPacking</code></p></div></li></ul></div></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#interop" class="bare">http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#interop</a></p></li></ul></div></aside></div></section><section id="_sru_2_0_diagnostics"><h2>SRU 2.0 – Diagnostics</h2><div class="slide-content"><div class="ulist"><ul><li><p>“Error handling”</p></li><li><p>Difference between (non-)fatal, (non-)surrogate → <a href="#_sru_2_0_diagnostic_model">SRU 2.0 – Diagnostic Model</a></p></li><li><p>Schema: <code>info:srw/schema/1/diagnostics-v1.1</code></p><div class="paragraph"><p>Prefix: <code>info:srw/diagnostic/1/</code></p></div>
<div class="ulist"><ul><li><p><code>uri</code> (ID), <code>details</code> (additional information, depending on Diagnostic), message</p></li></ul></div></li><li><p>Information:</p><div class="ulist"><ul><li><p>General information and notes (<a href="https://www.loc.gov/standards/sru/diagnostics/">LOC</a>, <a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#diagnostics">OASIS SRU 2.0</a>)</p></li><li><p>List of Diagnostics (<a href="https://www.loc.gov/standards/sru/diagnostics/diagnosticsList.html">LOC</a>, <a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#diagnosticsList">OASIS SRU 2.0</a>)</p></li></ul></div></li><li><p>Categories: General (1-9), CQL (10-49), Result Sets (50-60), Records (61-74), Sorting (80-96), Explain (100-102), Stylesheets (110-111), Scan (120-121)</p></li><li><p>Not limited to this list only, custom diagnostics possible</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#diagnostics" class="bare">http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#diagnostics</a></p></li><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#diagnosticsList" class="bare">http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part3-sru2.0/searchRetrieve-v1.0-os-part3-sru2.0.html#diagnosticsList</a></p></li><li><p><a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/normative-appendix.adoc#list-of-diagnostics" class="bare">https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/normative-appendix.adoc#list-of-diagnostics</a></p></li></ul></div></aside></div></section><section id="_sru_2_0_diagnostics_table" class="columns"><h2>SRU 2.0 – Diagnostics (Table)</h2><div class="slide-content"><div class="openblock column"><div class="content"><table class="tableblock frame-all grid-all xxx-small" style="width:100%"><colgroup><col style="width:7.6923%"><col style="width:46.1538%"><col style="width:46.1539%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">1</p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">General system error</p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">Debugging information (traceback)</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">2</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">System temporarily unavailable</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">3</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Authentication error</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">4</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Unsupported operation</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">5</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Unsupported version</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Highest version supported</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">6</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Unsupported parameter value</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Name of parameter</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">7</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Mandatory parameter not supplied</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Name of missing parameter</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">8</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Unsupported parameter</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Name of the unsupported parameter</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">9</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Unsupported combination of parameters</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">10</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Query syntax error</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">23</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Too many characters in term</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Length of longest term</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">26</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Non special character escaped in term</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Character incorrectly escaped</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">35</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Term contains only stopwords</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Value</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">37</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Unsupported boolean operator</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Value</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">38</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Too many boolean operators in query</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Maximum number supported</p></td></tr></table></div></div>
<div class="openblock column"><div class="content"><table class="tableblock frame-all grid-all xxx-small" style="width:100%"><colgroup><col style="width:7.6923%"><col style="width:46.1538%"><col style="width:46.1539%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">47</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:#b16c2b88;"><p class="tableblock">Cannot <strong>process</strong> query; reason unknown</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">48</p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">Query feature unsupported</p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">Feature</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">60</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Result set not created: too many matching records</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Maximum number</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">61</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">First record position out of range</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">64</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Record temporarily unavailable</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">65</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Record does not exist</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">66</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Unknown schema for retrieval</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Schema URI or short name</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">67</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Record not available in this schema</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Schema URI or short name</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">68</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Not authorized to send record</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">69</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Not authorized to send record in this schema</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">70</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Record too large to send</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Maximum record size</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">71</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Unsupported recordXMLEscaping value</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">80</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Sort not supported</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">110</p></td><td class="tableblock halign-left valign-top" colspan="2" style="background-color:;"><p class="tableblock">Stylesheets not supported</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">111</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Unsupported stylesheet</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">URL of stylesheet</p></td></tr></table></div></div></div></section><section id="_fcs_interface_specification"><h2>FCS Interface Specification</h2><div class="slide-content"><div class="imageblock position-absolute right-0 width-50"><img src="images/FCS_architecture.png" alt="FCS Architecture"></div>
<div class="ulist pt-5"><ul><li><p>FCS = Description of capabilities,<br>
Extensions according to SRU<br>
and operations</p><div class="paragraph"><p>→ Use of SRU/CQL and<br>
Erweiterungen nach SRU</p></div></li><li><p>Interface specification = formats and transport protocol</p><div class="ulist"><ul><li><p>Endpoint = bridge between client (FCS formats) and local search engine</p></li><li><p>Client = user interface, query input and result presentation</p></li></ul></div></li><li><p>Discovery and Search mechanism</p></li></ul></div></div></section><section id="_fcs_discovery"><h2>FCS – Discovery</h2><div class="slide-content"><div class="ulist"><ul><li><p>SRU Explain</p><div class="ulist"><ul><li><p><em>Help and information for the client on accessing, requesting and processing results from the server</em></p></li></ul></div></li><li><p>Information about endpoint</p><div class="openblock"><div class="content"><div class="ulist"><ul><li><p>Capabilities: Basic Search, Advanced Search?</p></li><li><p>Resources for search</p></li></ul></div></div></div>
<div class="paragraph"><p>→ Endpoint Description (XML) via <em>explain SRU Operation</em></p></div></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>FCS 2.0 §3 <a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/fcs-to-sru-cql-binding.adoc">CLARIN-FCS to SRU/CQL binding</a></p></li></ul></div></aside></div></section><section id="_fcs_endpoint_description"><h2>FCS – Endpoint Description</h2><div class="slide-content"><div class="ulist"><ul><li><p>XML according to the schema <a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/attachments/Endpoint-Description.xsd">Endpoint-Description.xsd</a></p></li><li><p><strong><code>&lt;ed:EndpointDescription&gt;</code></strong></p><div class="ulist"><ul><li><p><code class="blue">@version</code> mit “<code>2</code>”</p></li><li><p><code class="blue">&lt;ed:Capabilities&gt;</code> (1)</p></li><li><p><code class="blue">&lt;ed:SupportedDataViews&gt;</code> (1)</p></li><li><p><code class="blue">&lt;ed:SupportedLayers&gt;</code> (1) (if Advanced Search Capability)</p></li><li><p><code class="blue">&lt;ed:Resources&gt;</code> (1)</p></li></ul></div></li></ul></div></div></section><section id="_fcs_endpoint_description_2"><h2>FCS – Endpoint Description (2)</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong><code>&lt;ed:Capability&gt;</code></strong></p><div class="ulist"><ul><li><p>Content: Capability Identifier, URI</p><div class="ulist"><ul><li><p><code>http://clarin.eu/fcs/capability/basic-search</code></p></li><li><p><code>http://clarin.eu/fcs/capability/advanced-search</code></p></li></ul></div></li></ul></div></li></ul></div></div></section><section id="_fcs_endpoint_description_3"><h2>FCS – Endpoint Description (3)</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong><code>&lt;ed:SupportedDataView&gt;</code></strong></p><div class="ulist"><ul><li><p>Content: MIME type, e.g. <code>application/x-clarin-fcs-hits+xml</code></p></li><li><p><code class="blue">@id</code> → for referencing in <code>&lt;ed:Resource&gt;</code></p></li><li><p><code class="blue">@delivery-policy</code>: <code>send-by-default</code> / <code>need-to-request</code></p></li><li><p>No duplicates (based on MIME type) allowed</p></li></ul></div></li></ul></div></div></section><section id="_fcs_endpoint_description_4"><h2>FCS – Endpoint Description (4)</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong><code>&lt;ed:SupportedLayer&gt;</code></strong></p><div class="ulist"><ul><li><p>(only for Advanced Search)</p></li><li><p>Content: Layer Identifier, e.g. “<code>orth</code>”</p></li><li><p><code class="blue">@id</code> → for referencing in <code>&lt;ed:Resource&gt;</code></p></li><li><p><code class="blue">@result-id</code> → Referencing the layer in the Advanced Data View</p></li><li><p><code class="blue">@qualifier</code> → Identifier in FCS-QL Search Term for the layer</p></li><li><p><code class="blue">@alt-value-info</code>,[.blue]` @alt-value-info-uri`: short description of the layer, e.g. for tagset, + URL with further information</p></li><li><p>No duplicates allowed based on <code>@result-id</code> MIME type</p></li></ul></div></li></ul></div></div></section><section id="_fcs_endpoint_description_5" class="small"><h2>FCS – Endpoint Description (5)</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong><code>&lt;ed:Resource&gt;</code></strong></p><div class="ulist"><ul><li><p><code class="blue">@pid</code>: Persistent Identifier (e.g. <code>MdSelfLink</code> from CMDI Record)</p></li><li><p><code class="blue">&lt;ed:Title&gt;</code> (1+) with <code>@xml:lang</code>, no duplicates, English required</p></li><li><p><code class="blue">&lt;ed:Description&gt;</code> (0+) with <code>@xml:lang</code>, English required, should be at most 1 sentence</p></li><li><p><code class="blue">&lt;ed:Institution&gt;</code> (0+) with <code>@xml:lang</code>, English required</p></li><li><p><code class="blue">&lt;ed:LandingPageURI&gt;</code> (0/1) – link to the website of the resource (or institution) with more information</p></li><li><p><code class="blue">&lt;ed:Languages&gt;</code> (1) with <code>&lt;ed:Language&gt;</code> content according to ISO 639-3 language codes</p></li><li><p><code class="blue">&lt;ed:AvailableDataViews&gt;</code> (1) with <code>@ref</code> = list of IDs of the <code>&lt;ed:SupportedDataView&gt;</code> elements, e.g. “<code>hits adv</code>”</p></li><li><p><code class="blue">&lt;ed:AvailableLayers&gt;</code> (1) (if Advanced Search Capability), with <code>@ref</code> = list of IDs of the <code>&lt;ed:SupportedLayer&gt;</code> elements, e.g. “<code>word lemma pos</code>”</p></li><li><p><code class="blue">&lt;ed:Resources&gt;</code> (0/1) for sub resources</p></li><li><p>For <code>&lt;ed:AvailableDataViews&gt;</code> and <code>&lt;ed:AvailableLayers&gt;</code> sub-resources should support the same lists, a new declaration is still required</p></li></ul></div></li></ul></div></div></section><section id="_fcs_endpoint_description_examples" class="small"><h2>FCS – Endpoint Description (Examples)</h2><div class="slide-content"><div class="listingblock"><div class="title">Minimal Endpoint Description for BASIC Search</div><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-noescape="true" data-lang="xml">&lt;ed:EndpointDescription xmlns:ed="http://clarin.eu/fcs/endpoint-description" version="2"&gt;
  &lt;ed:Capabilities&gt;
    &lt;ed:Capability&gt;http://clarin.eu/fcs/capability/basic-search&lt;/ed:Capability&gt;
  &lt;/ed:Capabilities&gt;
  &lt;ed:SupportedDataViews&gt;
    &lt;ed:SupportedDataView id="hits" delivery-policy="send-by-default"&gt;application/x-clarin-fcs-hits+xml&lt;/ed:SupportedDataView&gt;
  &lt;/ed:SupportedDataViews&gt;
  &lt;ed:Resources&gt;
    &lt;!-- just one top-level resource at the Endpoint --&gt;
    &lt;ed:Resource pid="http://hdl.handle.net/4711/0815"&gt;
      &lt;ed:Title xml:lang="de"&gt;Goethe Korpus&lt;/ed:Title&gt;
      &lt;ed:Title xml:lang="en"&gt;Goethe corpus&lt;/ed:Title&gt;
      &lt;ed:Description xml:lang="de"&gt;Das Goethe-Korpus des IDS Mannheim.&lt;/ed:Description&gt;
      &lt;ed:Description xml:lang="en"&gt;The Goethe corpus of IDS Mannheim.&lt;/ed:Description&gt;
      &lt;ed:LandingPageURI&gt;http://repos.example.org/corpus1.html&lt;/ed:LandingPageURI&gt;
      &lt;ed:Languages&gt;
        &lt;ed:Language&gt;deu&lt;/ed:Language&gt;
      &lt;/ed:Languages&gt;
      &lt;ed:AvailableDataViews ref="hits" /&gt;
    &lt;/ed:Resource&gt;
  &lt;/ed:Resources&gt;
&lt;/ed:EndpointDescription&gt;</code></pre></div></div></div></section><section id="_fcs_endpoint_description_examples_2" class="small"><h2>FCS – Endpoint Description (Examples 2)</h2><div class="slide-content"><div class="listingblock"><div class="title">Endpoint Description with CMDI Data View and Sub-Resources</div><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-noescape="true" data-line-numbers="7,30,31,32,33,34,35,36,37,38,39,40,41,42,43" data-lang="xml">&lt;ed:EndpointDescription xmlns:ed="http://clarin.eu/fcs/endpoint-description" version="2"&gt;
  &lt;ed:Capabilities&gt;
    &lt;ed:Capability&gt;http://clarin.eu/fcs/capability/basic-search&lt;/ed:Capability&gt;
  &lt;/ed:Capabilities&gt;
  &lt;ed:SupportedDataViews&gt;
    &lt;ed:SupportedDataView id="hits" delivery-policy="send-by-default"&gt;application/x-clarin-fcs-hits+xml&lt;/ed:SupportedDataView&gt;
    &lt;ed:SupportedDataView id="cmdi" delivery-policy="need-to-request"&gt;application/x-cmdi+xml&lt;/ed:SupportedDataView&gt;
  &lt;/ed:SupportedDataViews&gt;
  &lt;ed:Resources&gt;
    &lt;!-- top-level resource 1 --&gt;
    &lt;ed:Resource pid="http://hdl.handle.net/4711/0815"&gt;
      &lt;ed:Title xml:lang="de"&gt;Goethe Korpus&lt;/ed:Title&gt;
      &lt;ed:Title xml:lang="en"&gt;Goethe corpus&lt;/ed:Title&gt;
      &lt;ed:Description xml:lang="de"&gt;Das Goethe-Korpus des IDS Mannheim.&lt;/ed:Description&gt;
      &lt;ed:Description xml:lang="en"&gt;The Goethe corpus of IDS Mannheim.&lt;/ed:Description&gt;
      &lt;ed:LandingPageURI&gt;http://repos.example.org/corpus1.html&lt;/ed:LandingPageURI&gt;
      &lt;ed:Languages&gt;
        &lt;ed:Language&gt;deu&lt;/ed:Language&gt;
      &lt;/ed:Languages&gt;
      &lt;ed:AvailableDataViews ref="hits" /&gt;
    &lt;/ed:Resource&gt;
    &lt;!-- top-level resource 2 --&gt;
    &lt;ed:Resource pid="http://hdl.handle.net/4711/0816"&gt;
      &lt;ed:Title xml:lang="de"&gt;Zeitungskorpus des Mannheimer Morgen&lt;/ed:Title&gt;
      &lt;ed:Title xml:lang="en"&gt;Mannheimer Morgen newspaper corpus&lt;/ed:Title&gt;
      &lt;ed:LandingPageURI&gt;http://repos.example.org/corpus2.html&lt;/ed:LandingPageURI&gt;
      &lt;ed:Languages&gt;
        &lt;ed:Language&gt;deu&lt;/ed:Language&gt;
      &lt;/ed:Languages&gt;
      &lt;ed:AvailableDataViews ref="hits cmdi" /&gt;
      &lt;ed:Resources&gt;
        &lt;!-- sub-resource 1 of top-level resource 2 --&gt;
        &lt;ed:Resource pid="http://hdl.handle.net/4711/0816-1"&gt;
          &lt;ed:Title xml:lang="de"&gt;Zeitungskorpus des Mannheimer Morgen (vor 1990)&lt;/ed:Title&gt;
          &lt;ed:Title xml:lang="en"&gt;Mannheimer Morgen newspaper corpus (before 1990)&lt;/ed:Title&gt;
          &lt;ed:LandingPageURI&gt;http://repos.example.org/corpus2.html#sub1&lt;/ed:LandingPageURI&gt;
          &lt;ed:Languages&gt;
            &lt;ed:Language&gt;deu&lt;/ed:Language&gt;
          &lt;/ed:Languages&gt;
          &lt;ed:AvailableDataViews ref="hits cmdi" /&gt;
        &lt;/ed:Resource&gt;
        &lt;!-- sub-resource 2 of top-level resource 2 ... --&gt;
      &lt;/ed:Resources&gt;
    &lt;/ed:Resource&gt;
  &lt;/ed:Resources&gt;
&lt;/ed:EndpointDescription&gt;</code></pre></div></div></div></section><section id="_fcs_endpoint_description_examples_3" class="small"><h2>FCS – Endpoint Description (Examples 3)</h2><div class="slide-content"><div class="listingblock"><div class="title">Endpoint Description with ADVANCED Search Capability</div><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-noescape="true" data-line-numbers="4,8,10,11,12,13,14,15,16,17,18,19,20,21,34,35" data-lang="xml">&lt;ed:EndpointDescription xmlns:ed="http://clarin.eu/fcs/endpoint-description" version="2"&gt;
  &lt;ed:Capabilities&gt;
    &lt;ed:Capability&gt;http://clarin.eu/fcs/capability/basic-search&lt;/ed:Capability&gt;
    &lt;ed:Capability&gt;http://clarin.eu/fcs/capability/advanced-search&lt;/ed:Capability&gt;
  &lt;/ed:Capabilities&gt;
  &lt;ed:SupportedDataViews&gt;
    &lt;ed:SupportedDataView id="hits" delivery-policy="send-by-default"&gt;application/x-clarin-fcs-hits+xml&lt;/ed:SupportedDataView&gt;
    &lt;ed:SupportedDataView id="adv" delivery-policy="send-by-default"&gt;application/x-clarin-fcs-adv+xml&lt;/ed:SupportedDataView&gt;
  &lt;/ed:SupportedDataViews&gt;
  &lt;ed:SupportedLayers&gt;
    &lt;ed:SupportedLayer id="word" result-id="http://spraakbanken.gu.se/ns/fcs/layer/word"&gt;text&lt;/ed:SupportedLayer&gt;
    &lt;ed:SupportedLayer id="orth" result-id="http://endpoint.example.org/Layers/orth" type="empty"&gt;orth&lt;/ed:SupportedLayer&gt;
    &lt;ed:SupportedLayer id="lemma" result-id="http://spraakbanken.gu.se/ns/fcs/layer/lemma"&gt;lemma&lt;/ed:SupportedLayer&gt;
    &lt;ed:SupportedLayer id="pos" result-id="http://spraakbanken.gu.se/ns/fcs/layer/pos"
                       alt-value-info="SUC tagset"
                       alt-value-info-uri="https://spraakbanken.gu.se/parole/Docs/SUC2.0-manual.pdf"
                       qualifier="suc"&gt;pos&lt;/ed:SupportedLayer&gt;
    &lt;ed:SupportedLayer id="pos2" result-id="http://spraakbanken.gu.se/ns/fcs/layer/pos2"
                       alt-value-info="2nd tagset"
                       qualifier="t2"&gt;pos&lt;/ed:SupportedLayer&gt;
  &lt;/ed:SupportedLayers&gt;

  &lt;ed:Resources&gt;
    &lt;!-- just one top-level resource at the Endpoint --&gt;
    &lt;ed:Resource pid="hdl:10794/suc"&gt;
      &lt;ed:Title xml:lang="sv"&gt;SUC-korpusen&lt;/ed:Title&gt;
      &lt;ed:Title xml:lang="en"&gt;The SUC corpus&lt;/ed:Title&gt;
      &lt;ed:Description xml:lang="sv"&gt;Stockholm-Umeå-korpusen hos Språkbanken.&lt;/ed:Description&gt;
      &lt;ed:Description xml:lang="en"&gt;The Stockholm-Umeå corpus at Språkbanken.&lt;/ed:Description&gt;
      &lt;ed:LandingPageURI&gt;https://spraakbanken.gu.se/resurser/suc&lt;/ed:LandingPageURI&gt;
      &lt;ed:Languages&gt;
        &lt;ed:Language&gt;swe&lt;/ed:Language&gt;
      &lt;/ed:Languages&gt;
      &lt;ed:AvailableDataViews ref="hits adv" /&gt;
      &lt;ed:AvailableLayers ref="word lemma pos pos2" /&gt;
    &lt;/ed:Resource&gt;
  &lt;/ed:Resources&gt;
&lt;/ed:EndpointDescription&gt;</code></pre></div></div></div></section><section id="_fcs_search"><h2>FCS – Search</h2><div class="slide-content"><div class="ulist"><ul><li><p>SRU SearchRetreive</p></li><li><p>Actual “Search”</p><div class="ulist"><ul><li><p><strong>Basic Search</strong> with CQL</p></li><li><p><strong>Advanced Search</strong> with FCS-QL</p></li></ul></div></li><li><p>Search results are serialized in <em>Resource (Fragment)</em> and in <em>Data View</em> formats</p></li><li><p>Implementation details → <a href="#_resources_and_data_views">Chapter <em>Resources and Data Views</em></a></p></li></ul></div></div></section><section id="_fcs_sru_extension_parameter"><h2>FCS – SRU Extension Parameter</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong><code>x-fcs-endpoint-description</code></strong> (explain)</p><div class="ulist"><ul><li><p>“<code>true</code>” - <code>&lt;sru:extraResponseData&gt;</code> of the Explain Response contains the Endpoint Description document</p></li></ul></div></li><li><p><strong><code>x-fcs-context</code></strong> (searchRetrieve)</p><div class="ulist"><ul><li><p>Comma-separated list of PIDs</p></li><li><p>Restrict the search to resources identified by these PIDs</p></li></ul></div></li><li><p><strong><code>x-fcs-dataviews</code></strong> (searchRetrieve)</p><div class="ulist"><ul><li><p>Comma-separated list of Data View identifiers</p></li><li><p>Endpoints should also deliver these <em><code>need-to-request</code></em> Data Views if requested</p></li></ul></div></li><li><p><strong><code>x-fcs-rewrites-allowed</code></strong> (searchRetrieve)</p><div class="ulist"><ul><li><p>“<code>true</code>” - Endpoint can simplify query for higher recall</p></li></ul></div></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/normative-appendix.adoc#list-of-extra-request-parameters" class="bare">https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/normative-appendix.adoc#list-of-extra-request-parameters</a></p></li></ul></div></aside></div></section><section id="_fcs_diagnostics"><h2>FCS – Diagnostics</h2><div class="slide-content"><div class="ulist"><ul><li><p>Complements to the SRU Diagnostics → <a href="#_sru_2_0_diagnostics">SRU 2.0 – Diagnostics</a></p></li><li><p>Prefix: <code>http://clarin.eu/fcs/diagnostic/</code></p></li><li><p>Refer to the <a href="#_fcs_sru_extension_parameter">Extra Request Parameters</a></p></li></ul></div></div></section><section id="_fcs_diagnostics_table"><h2>FCS – Diagnostics (Table)</h2><div class="slide-content"><table class="tableblock frame-all grid-all xx-small" style="width:100%"><colgroup><col style="width:37.5%"><col style="width:50%"><col style="width:12.5%"></colgroup><thead><tr><th class="tableblock halign-left valign-top" style="background-color:;">Identifier URI</th><th class="tableblock halign-left valign-top" style="background-color:;">Description</th><th class="tableblock halign-left valign-top" style="background-color:;">Impact</th></tr><tbody><tr><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock"><code>http://clarin.eu/fcs/diagnostic/1</code></p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">Persistent identifier passed by the Client for restricting the search is invalid.</p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">non-fatal</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>http://clarin.eu/fcs/diagnostic/2</code></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Resource set too large. Query context automatically adjusted.</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">non-fatal</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>http://clarin.eu/fcs/diagnostic/3</code></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Resource set too large. Cannot perform Query.</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">fatal</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock"><code>http://clarin.eu/fcs/diagnostic/4</code></p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">Requested Data View not valid for this resource.</p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">non-fatal</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>http://clarin.eu/fcs/diagnostic/10</code></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">General query syntax error.</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">fatal</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock"><code>http://clarin.eu/fcs/diagnostic/11</code></p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">Query too complex. Cannot perform Query.</p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">fatal</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>http://clarin.eu/fcs/diagnostic/12</code></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Query was rewritten.</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">non-fatal</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock"><code>http://clarin.eu/fcs/diagnostic/14</code></p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">General processing hint.</p></td><td class="tableblock halign-left valign-top" style="background-color:#b16c2b88;"><p class="tableblock">non-fatal</p></td></tr></table>
<aside class="notes"><div class="ulist"><ul><li><p><a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/normative-appendix.adoc#list-of-diagnostics" class="bare">https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/normative-appendix.adoc#list-of-diagnostics</a></p></li></ul></div></aside></div></section><section id="_versions_and_backwards_compatibility"><h2>Versions and Backwards Compatibility</h2><div class="slide-content"><div class="ulist"><ul><li><p>“Clients MUST be compatible to CLARIN-FCS 1.0” (<a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/interface-specification.adoc#backwards-compatibility">Quelle</a>)</p><div class="ulist"><ul><li><p>Thus implementation of SRU 1.2 still required (?)</p></li><li><p>Restriction to <em>Basic Search</em> Capability</p></li><li><p>Processing of legacy XML namespaces (SRU Response, Diagnostics)</p></li></ul></div></li><li><p><strong>Heuristic for version detection</strong> (of endpoints)</p><div class="ulist"><ul><li><p>Client: <code>Explain</code> request without <code>version</code> and <code>operation</code> parameters</p></li><li><p>Endpoint: SRU Response <code>&lt;sru:explainResponse&gt;</code>/<code>&lt;sru:version&gt;</code> with default SRU version</p></li></ul></div></li><li><p>Versions</p><div class="ulist"><ul><li><p>FCS 2.0 ↔ SRU 2.0</p></li><li><p>FCS 1.0 ↔ SRU 1.2 (SRU 1.1)</p></li></ul></div></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/interface-specification.adoc#versioning-and-extensions" class="bare">https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/interface-specification.adoc#versioning-and-extensions</a></p></li></ul></div></aside></div></section><section id="_notes_on_fcs_sru_aggregator"><h2>Notes on FCS SRU Aggregator</h2><div class="slide-content"><div class="ulist"><ul><li><p>Currently no (?) support for FCS 2.0 only endpoints</p><div class="openblock"><div class="content"><div class="ulist"><ul><li><p>For compatibility reasons support of <em>Legacy FCS</em> and <em>FCS 1.0</em></p></li><li><p>Assumption that endpoints in <em>FCS 2.0</em> also support earlier FCS Versions… <span class="lightgrey"><em>(no issue with CLARIN SRU/FCS libraries)</em></span></p></li></ul></div></div></div>
<div class="paragraph"><p>→ <em>FCS 2.0 only</em> endpoints <em>may</em> therefore still receive  <em>FCS 1.0 (SRU 1.2)</em> requests!</p></div></li><li><p>Aggregator sends <code>searchRetrieve</code> requests with only one resource PID in the <code>x-fcs-context</code> parameter for each resource requested</p><div class="ulist"><ul><li><p>i.e. search across <code>N</code> resources of an endpoint → <code>N</code> separate search queries</p></li></ul></div></li></ul></div></div></section><section id="_note_on_scan_operation" class="hidden"><h2>Note on Scan Operation</h2><div class="slide-content"><div class="ulist"><ul><li><p>Usage <em>only</em> in Legacy FCS,</p><div class="paragraph"><p>originally for listing the available resources</p></div></li><li><p>Reserved for possible future use</p></li><li><p>Please ignore!</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/fcs-to-sru-cql-binding.adoc#operation-scan" class="bare">https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/fcs-to-sru-cql-binding.adoc#operation-scan</a></p></li><li><p><a href="http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part6-scan/searchRetrieve-v1.0-os-part6-scan.html" class="bare">http://docs.oasis-open.org/search-ws/searchRetrieve/v1.0/os/part6-scan/searchRetrieve-v1.0-os-part6-scan.html</a></p></li></ul></div></aside>
<div style="page-break-after: always;"></div></div></section></section>
<section><section id="_reference_implementations" data-background-image="images/fcs-render-uk.png" data-background-opacity="0.5"><h2>Reference Implementations</h2><div class="slide-content"><aside class="notes"><div class="ulist"><ul><li><p>Java and Python, focus on FCS endpoints</p></li><li><p>Java class hierarchies, organization &amp; structure, processes &amp; lifecycles, configuration</p></li></ul></div></aside></div></section><section id="_clarin_reference_libraries_java" class="small"><h2>CLARIN Reference Libraries (Java)</h2><div class="slide-content"><div class="ulist"><ul><li><p>Development started ~2012</p></li><li><p>Modularized: Client/Server, SRU/FCS, Parser</p></li><li><p>in Java 1.8+ (<a href="https://endoflife.date/oracle-jdk"><em>EOL: Ende 2030</em></a>)</p></li><li><p>Extensive documentation, some tests (<em>proven by being in use for a long time</em>)</p></li><li><p>Artifacts in <a href="https://nexus.clarin.eu">CLARIN Nexus</a>, Code on <a href="https://github.com/clarin-eric/?q=fcs">Github</a></p></li><li><p>Server/endpoint: external dependencies to</p><div class="ulist"><ul><li><p>Logging: <code>slf4j</code></p></li><li><p>HTTP: <code>javax.servlet:servlet-api</code></p></li><li><p>Parser: <code>antlr4</code> (FCS-QL) / CQL</p></li></ul></div></li><li><p>Build: maven</p></li><li><p>Deployment: jetty, tomcat, …</p></li></ul></div></div></section><section id="_clarin_reference_libraries_python" class="small"><h2>CLARIN Reference Libraries (Python)</h2><div class="slide-content"><div class="ulist"><ul><li><p>~ 2022: Translation of Java reference libraries to Python</p></li><li><p>Strong orientation towards the Java reference libraries</p><div class="paragraph"><p>→ (fast) (almost) identical interfaces, class/function names</p></div></li><li><p>but: slight optimizations for Python, no 1:1 copy</p></li><li><p>Focus on (new) FCS endpoints → no clients!</p></li><li><p>Typed, documented; published on PyPI</p></li><li><p>Synchronous, minimal WSGI - allows embedding in existing apps</p></li><li><p>Python 3.8+</p></li><li><p>Dependencies to</p><div class="ulist"><ul><li><p>XML parsing: <code>lxml</code></p></li><li><p>HTTP/WSGI: <code>werkzeug</code></p></li><li><p>Query Parser: <code>PLY</code> (CQL), <code>ANTLR4</code> (FCS-QL)</p></li></ul></div></li></ul></div></div></section><section id="_clarin_reference_libraries" class="text-left small"><h2>CLARIN Reference Libraries</h2><div class="slide-content"><div class="ulist"><ul><li><p>FCS SRU Server: <a href="https://github.com/clarin-eric/fcs-sru-server/">Java</a> (<a href="https://clarin-eric.github.io/fcs-sru-server/apidocs/index.html">docs</a>), <a href="https://github.com/Querela/fcs-sru-server-python/">Python</a> (<a href="https://fcs-sru-server-python.readthedocs.io/en/latest/">docs</a>)</p></li><li><p>FCS Simple Endpoint: <a href="https://github.com/clarin-eric/fcs-simple-endpoint">Java</a> (<a href="https://clarin-eric.github.io/fcs-simple-endpoint/apidocs/index.html">docs</a>), <a href="https://github.com/Querela/fcs-simple-endpoint-python">Python</a> (<a href="https://fcs-simple-endpoint-python.readthedocs.io/en/latest/">docs</a>)</p></li></ul></div>
<div class="ulist mt-2"><ul><li><p>FCS SRU Client: <a href="https://github.com/clarin-eric/fcs-sru-client/">Java</a> (<a href="https://clarin-eric.github.io/fcs-sru-client/apidocs/index.html">docs</a>)</p></li><li><p>FCS Simple Client: <a href="https://github.com/clarin-eric/fcs-simple-client">Java</a> (<a href="https://clarin-eric.github.io/fcs-simple-client/apidocs/index.html">docs</a>)</p></li></ul></div>
<div class="ulist mt-2"><ul><li><p>CQL Parser: <a href="https://github.com/indexdata/cql-java">Java</a> (<a href="http://zing.z3950.org/cql/java/docs/index.html">docs</a>?), <a href="https://github.com/Querela/cql-python">Python</a>, <a href="https://github.com/Querela/cql-js">JavaScript</a></p></li><li><p>FCS-QL Parser: <a href="https://github.com/clarin-eric/fcs-ql">Java</a>, <a href="https://github.com/Querela/fcs-ql-python">Python</a> (<a href="https://fcs-ql-python.readthedocs.io/en/latest/">docs</a>)</p></li></ul></div>
<div class="ulist mt-2"><ul><li><p>Maven Endpoint Archetype: <a href="https://github.com/clarin-eric/fcs-endpoint-archetype">Java</a></p></li><li><p>FCS SRU Aggregator: <a href="https://github.com/clarin-eric/fcs-sru-aggregator">Java</a></p></li><li><p>FCS Endpoint Validator: <a href="https://github.com/clarin-eric/fcs-endpoint-tester">Java</a> (old), <a href="https://github.com/saw-leipzig/fcs-endpoint-validator">Java</a> ← test compliance with <em>SRU/FCS protocol</em></p></li><li><p>Korp: <a href="https://github.com/clarin-eric/fcs-korp-endpoint/">Java</a>, <a href="https://github.com/Querela/fcs-korp-endpoint-python/">Python</a></p></li></ul></div>
<div class="paragraph"><p><em><a href="https://github.com/indexdata/">Indexdata</a>: CQL-Parser, <a href="https://github.com/Querela/">Querela</a>: Python implementations</em></p></div>
<aside class="notes"><div class="ulist"><ul><li><p>Note: concrete examples and implementations will follow in a later section, high-level overview here</p></li></ul></div></aside></div></section><section id="_fcs_endpoint_design_and_structure" class="small"><h2>FCS Endpoint – Design and structure</h2><div class="slide-content"><div class="ulist"><ul><li><p>Query Parser (CQL, FCS-QL)</p></li></ul></div>
<div class="ulist mt-2"><ul><li><p><strong>FCS SRU Server</strong></p><div class="ulist"><ul><li><p>SRU configurations, versions, parameters, diagnostics, namespaces</p></li><li><p>XML SRU Writer</p></li><li><p>Request Parameter parser, SRUServer (request handler)</p></li><li><p>Abstract SRU interfaces (results, <code>SRUSearchEngine</code>)</p></li><li><p>Auth (<em>Interface, WIP</em>)</p></li></ul></div></li></ul></div></div></section><section id="_fcs_endpoint_structure_cont" class="small"><h2>FCS Endpoint – Structure (Cont.)</h2><div class="slide-content"><div class="ulist mt-2"><ul><li><p><strong>FCS Simple Endpoint</strong></p><div class="ulist"><ul><li><p>FCS configurations (Endpoint Description), parameters, diagnostics, namespaces</p></li><li><p>XML Endpoint Description parser, Record and Data View writer</p></li><li><p>SimpleEndpointSearchEngineBase (<code>SRUSearchEngine</code> + FCS extensions)</p></li></ul></div></li></ul></div>
<div class="ulist mt-2"><ul><li><p><strong>FCS Endpoint for XYZ</strong></p><div class="ulist"><ul><li><p>Implementation of abstract classes and bindings to search engine, query translation</p></li><li><p>Configuration: Endpoint Description, SRU Server Configuration</p></li><li><p>Deployment on Java Servlet Server or as WSGI app</p></li></ul></div></li></ul></div></div></section><section id="_fcs_endpoint_initialization" class="text-left small"><h2>FCS Endpoint – Initialization</h2><div class="slide-content"><div class="paragraph"><p><code>SRUServerServlet</code> / <code>SRUServerApp</code> (web server)</p></div>
<div class="ulist"><ul><li><p>Set default WebApp parameters</p></li><li><p>Parse the SRU Server Config</p></li><li><p>Create <code>QueryParserRegistry</code> (CQL)</p></li><li><p>Initialize <strong><code>SRUSearchEngine</code></strong></p></li><li><p>Create <code>SRUServer</code> (with <code>SearchEngine</code> + configurations)</p></li></ul></div>
<div class="paragraph"><p><code>SRUSearchEngine</code><br>
(user implementation, → <code>SimpleEndpointSearchEngineBase</code>)</p></div>
<div class="ulist"><ul><li><p>Further initialization of the <code>QueryParserRegistry</code> (FCS-QL)</p></li><li><p><strong><code>do_init</code></strong> (user init)</p></li><li><p>Create Endpoint Description</p></li></ul></div></div></section><section id="_fcs_endpoint_communication_flow" class="text-left small"><h2>FCS Endpoint – Communication Flow</h2><div class="slide-content"><div class="paragraph"><p>[GET] request  (incoming)</p></div>
<div class="openblock ms-5 text-left block-border-left-dashed"><div class="content"><div class="paragraph"><p>↳ <code>SRUServerServlet</code> / <code>SRUServerApp</code> (web server)</p></div>
<div class="exampleblock ms-5 text-left block-border-left-dashed"><div class="content"><div class="paragraph"><p>↳ <code>SRUServer</code></p></div>
<div class="ulist ms-3"><ul><li><p>URL parameter evaluation</p></li><li><p>Multiplexing by operation: search/scan/explain</p></li></ul></div>
<div class="exampleblock ms-5 text-left block-border-left-dashed"><div class="content"><div class="paragraph"><p>↳ <code>SimpleEndpointSearchEngineBase</code> (user implementation)</p></div>
<div class="ulist ms-3"><ul><li><p>Parse search query (CQL/FCS-QL) and send to search engine</p></li><li><p>Wrap result in <code>SRUSearchResultSet</code></p></li><li><p>Possible diagnostics etc.</p></li></ul></div>
<div class="paragraph"><p>↲</p></div></div></div>
<div class="ulist ms-3"><ul><li><p>optional error handling</p></li><li><p>XML output generation (SRU parameter)</p></li></ul></div></div></div></div></div></div></section><section id="_fcs_endpoint_class_hierarchy" class="text-left"><h2>FCS Endpoint – Class Hierarchy</h2><div class="slide-content"><div class="paragraph"><p><code>SRUServerServlet</code> - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/utils/SRUServerServlet.java">Java</a> (Servlet) / <code>SRUServerApp</code> - <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/server/wsgi.py#L36">Python</a> (WSGI)</p></div>
<div class="openblock ms-5 darkgrey font-italic block-border-left-dashed"><div class="content"><div class="paragraph"><p>Servlet implementation for servlet container, <code>doGet</code> handler, setup of <code>SRUServer</code> wrapper/application executed by the endpoint operator</p></div></div></div>
<div class="paragraph"><p>SRUServer - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/SRUServer.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/server/server.py#L293">Python</a></p></div>
<div class="openblock ms-5 darkgrey font-italic block-border-left-dashed"><div class="content"><div class="paragraph"><p>SRU protocol implementation, <code>handleRequest</code>, error handling, XML output generation</p></div></div></div>
<div class="paragraph"><p>SRURequestImpl - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/SRURequestImpl.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/server/request.py#L567">Python</a></p></div>
<div class="openblock ms-5 darkgrey font-italic block-border-left-dashed"><div class="content"><div class="paragraph"><p>Specific SRU GET parameter evaluation (parsing, validation; SRU versions) + possible FCS parameters (“<code>x-</code>&#8230;&#8203;”), SRU version detection</p></div></div></div>
<div class="openblock ms-5 block-border-left-dashed"><div class="content"><div class="paragraph"><p>↳ SRURequest (Interface) - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/SRURequest.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/server/request.py#L47">Python</a></p></div>
<div class="exampleblock ms-5 darkgrey font-italic block-border-left-dashed"><div class="content"><div class="paragraph"><p>Documentation of all SRU parameters</p></div></div></div></div></div></div></section><section id="_fcs_endpoint_class_hierarchy_2" class="text-left"><h2>FCS Endpoint – Class Hierarchy (2)</h2><div class="slide-content"><div class="paragraph"><p><strong><code>XYZEndpointSearchEngine</code></strong> - korp: <a href="https://github.com/clarin-eric/fcs-korp-endpoint/blob/master/src/main/java/se/gu/spraakbanken/fcs/endpoint/korp/KorpEndpointSearchEngine.java">Java</a>, <a href="https://github.com/Querela/fcs-korp-endpoint-python/blob/5ee448d2369e450571a6d82d3e379154752a3397/src/korp_endpoint/endpoint.py#L182">Python</a></p></div>
<div class="openblock ms-5 darkgrey font-italic block-border-left-dashed"><div class="content"><div class="paragraph"><p>Actual implementation of <code>createEndpointDescription</code>, <code>do</code>* methods</p></div></div></div>
<div class="openblock ms-5 block-border-left-dashed"><div class="content"><div class="paragraph"><p>↳ <code>SimpleEndpointSearchEngineBase</code> (abstract) - <a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/main/src/main/java/eu/clarin/sru/server/fcs/SimpleEndpointSearchEngineBase.java">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/server/search.py#L507">Python</a></p></div>
<div class="exampleblock ms-5 darkgrey font-italic block-border-left-dashed"><div class="content"><div class="paragraph"><p>Lifecyle (<code>init</code> → <code>destroy</code>), integration of endpoint description, interfaces for users</p></div></div></div>
<div class="exampleblock ms-5 block-border-left-dashed"><div class="content"><div class="paragraph"><p>↳ <code>SRUSearchEngineBase</code> (abstract) - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/utils/SRUSearchEngineBase.java">Java</a></p></div>
<div class="exampleblock ms-5 block-border-left-dashed"><div class="content"><div class="paragraph"><p>↳ <code>SRUSearchEngine</code> (interface) - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/SRUSearchEngine.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/server/server.py#L160">Python</a></p></div>
<div class="exampleblock ms-5 darkgrey font-italic block-border-left-dashed"><div class="content"><div class="paragraph"><p>Interface: <code>search</code>, <code>explain</code>, <code>scan</code></p></div></div></div></div></div></div></div></div></div></div></section><section id="_fcs_endpoint_class_hierarchy_3" class="text-left"><h2>FCS Endpoint – Class Hierarchy (3)</h2><div class="slide-content"><div class="paragraph"><p><strong><code>XYZSRUSearchResultSet</code></strong> - korp: <a href="https://github.com/clarin-eric/fcs-korp-endpoint/blob/master/src/main/java/se/gu/spraakbanken/fcs/endpoint/korp/KorpSRUSearchResultSet.java">Java</a>, <a href="https://github.com/Querela/fcs-korp-endpoint-python/blob/5ee448d2369e450571a6d82d3e379154752a3397/src/korp_endpoint/endpoint.py#L57">Python</a></p></div>
<div class="openblock ms-5 darkgrey font-italic block-border-left-dashed"><div class="content"><div class="paragraph"><p>Actual implementation, <code>nextRecord</code> + <code>writeRecord</code> iterator and serialization of results</p></div></div></div>
<div class="openblock ms-5 block-border-left-dashed"><div class="content"><div class="paragraph"><p>↳ <code>SRUSearchResultSet</code> (abstract) - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/SRUSearchResultSet.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/server/result.py#L208">Python</a></p></div>
<div class="exampleblock ms-5 darkgrey font-italic block-border-left-dashed"><div class="content"><div class="paragraph"><p>Fields for <code>searchRetrieve</code> operation results (total, records, …)</p></div></div></div>
<div class="exampleblock ms-5 block-border-left-dashed"><div class="content"><div class="paragraph"><p>↳ <code>SRUAbstractResult</code> (interface) - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/SRUAbstractResult.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/server/result.py#L15">Python</a></p></div>
<div class="exampleblock ms-5 darkgrey font-italic block-border-left-dashed"><div class="content"><div class="paragraph"><p>Diagnostics + <code>ExtraResponseData</code></p></div></div></div></div></div></div></div>
<div class="paragraph"><p><em><code>XYZSRUScanResultSet</code>, <code>XYZSRUExplainResult</code> do not need to be implemented separately, default behavior is adequate</em></p></div></div></section><section id="_fcs_endpoint_class_hierarchy_4" class="text-left"><h2>FCS Endpoint – Class Hierarchy (4)</h2><div class="slide-content"><div class="paragraph"><p><code>SRUConstants</code> - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/SRUConstants.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/constants.py">Python</a></p></div>
<div class="ulist"><ul><li><p>Diagnostic codes</p></li><li><p>Namespaces</p></li><li><p>Python: SRU parameter + values</p></li></ul></div>
<div class="paragraph mt-5"><p><code>SRUDiagnostic</code> - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/SRUDiagnostic.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/diagnostic.py">Python</a></p></div>
<div class="ulist"><ul><li><p>Error handling, message (text description) of the diagnostic</p></li></ul></div></div></section><section id="_endpoint_configurations" class="text-left small"><h2>Endpoint Configurations</h2><div class="slide-content"><div class="listingblock position-absolute right--30 width-75 opacity-50"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-noescape="true" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;endpoint-config xmlns="http://www.clarin.eu/sru-server/1.0/"&gt;
    &lt;databaseInfo&gt;
        &lt;title xml:lang="se"&gt;Språkbankens korpusar&lt;/title&gt;
        &lt;title xml:lang="en" primary="true"&gt;The Språkbanken corpora&lt;/title&gt;
        &lt;description xml:lang="se"&gt;Sök i Språkbankens korpusar.&lt;/description&gt;
        &lt;description xml:lang="en" primary="true"&gt;Search in the Språkbanken corpora.&lt;/description&gt;
        &lt;author xml:lang="en"&gt;Språkbanken (The Swedish Language Bank)&lt;/author&gt;
        &lt;author xml:lang="se" primary="true"&gt;Språkbanken&lt;/author&gt;
    &lt;/databaseInfo&gt;

    &lt;indexInfo&gt;
        &lt;set name="fcs" identifier="http://clarin.eu/fcs/resource"&gt;
            &lt;title xml:lang="se"&gt;Clarins innehållssökning&lt;/title&gt;
            &lt;title xml:lang="en" primary="true"&gt;CLARIN Content Search&lt;/title&gt;
        &lt;/set&gt;
        &lt;index search="true" scan="false" sort="false"&gt;
            &lt;title xml:lang="en" primary="true"&gt;Words&lt;/title&gt;
            &lt;map primary="true"&gt;
                &lt;name set="fcs"&gt;words&lt;/name&gt;
            &lt;/map&gt;
        &lt;/index&gt;
    &lt;/indexInfo&gt;

    &lt;schemaInfo&gt;
        &lt;schema identifier="http://clarin.eu/fcs/resource" name="fcs"
                sort="false" retrieve="true"&gt;
            &lt;title xml:lang="en" primary="true"&gt;CLARIN Content Search&lt;/title&gt;
        &lt;/schema&gt;
    &lt;/schemaInfo&gt;
&lt;/endpoint-config&gt;</code></pre></div></div>
<div class="paragraph"><p><strong>WebApp Parameter</strong> (<code>web.xml</code> o.Ä.) - <a href="https://github.com/clarin-eric/fcs-korp-endpoint/blob/master/src/main/webapp/WEB-INF/web.xml">Korp example</a></p></div>
<div class="ulist"><ul><li><p>SRU Version</p></li><li><p>SRU/FCS configurations</p></li></ul></div>
<div class="paragraph"><p><strong>SRU (SRU Server Config)</strong> - <a href="https://github.com/clarin-eric/fcs-korp-endpoint/blob/master/src/main/webapp/WEB-INF/sru-server-config.xml">Korp example</a> →</p></div>
<div class="ulist"><ul><li><p><code>databaseInfo</code> about endpoint, <em>but no evaluation in client?</em></p></li><li><p>default: <code>indexInfo</code> + <code>schemaInfo</code></p></li><li><p><strong>Mandatory: <code>database</code> field in <code>serverInfo</code>!</strong></p></li></ul></div>
<div class="paragraph"><p>FCS (Endpoint Description) - <a href="https://github.com/clarin-eric/fcs-korp-endpoint/blob/master/src/main/webapp/WEB-INF/endpoint-description.xml">Korp example</a></p></div>
<div class="ulist"><ul><li><p>FCS Version (1/2)</p></li><li><p>Capabilities, Layer, DataViews</p></li><li><p>Resources</p></li></ul></div>
<div style="page-break-after: always;"></div></div></section></section>
<section><section id="_resources_and_data_views" data-background-image="images/fcs-render-uk.png" data-background-opacity="0.5"><h2>Resources and Data Views</h2><div class="slide-content"><aside class="notes"><div class="ulist"><ul><li><p>Endpoint Capabilities, BASIC/ADVANCED Search, FCS-QL</p></li><li><p>Resource, Resource Fragment, Data View (Hits, Advanced)</p></li><li><p>Result serialization, query languages</p></li></ul></div></aside></div></section><section id="_endpoint_description_capabilities" class="text-left"><h2>Endpoint Description – Capabilities</h2><div class="slide-content"><div class="paragraph"><p><strong>http://clarin.eu/fcs/capability/basic-search</strong></p></div>
<div class="ulist"><ul><li><p>Mandatory</p></li><li><p>Query: Full-text search (Basic) with minimal CQL (AND/OR)</p></li><li><p>DataView: HITS</p></li></ul></div>
<div class="paragraph mt-5"><p><strong>http://clarin.eu/fcs/capability/advanced-search</strong></p></div>
<div class="ulist"><ul><li><p>Optional</p></li><li><p>Query: FCS-QL (Structured search over annotation layers)</p></li><li><p>DataView: HITS and Advanced</p></li></ul></div></div></section><section id="_endpoint_description_capabilities_2"><h2>Endpoint Description – Capabilities (2)</h2><div class="slide-content"><div class="ulist"><ul><li><p>Other capabilities possible</p><div class="paragraph"><p>→ currently limited to Basic and Advanced Search!</p></div></li><li><p>Do <em>not</em> only determine search modes!</p></li><li><p>Work in progress:</p><div class="ulist"><ul><li><p>Authentication/authorization</p></li><li><p>Lexical search: <code>…/lex-search</code> → LexCQL, LexHITS</p></li><li><p>Syntactic search?</p></li></ul></div></li><li><p>Note: according to <a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/attachments/Endpoint-Description.xsd">XSD</a>, capability URIs have the following schema
<code>http://clarin.eu/fcs/capability/\w([\.\-]{0,1}\w)*</code></p></li></ul></div></div></section><section id="_basic_search" class="text-left"><h2>BASIC Search</h2><div class="slide-content"><div class="listingblock position-absolute right--30 width-50 opacity-50"><div class="content"><pre class="highlightjs highlight"><code class="language-x86asm hljs" data-noescape="true" data-lang="x86asm">cat
"cat"
cat AND dog
"grumpy cat"
"grumpy cat" AND dog
"grumpy cat" OR "lazy dog"
cat AND (mouse OR "lazy dog")</code></pre></div></div>
<div class="ulist"><ul><li><p>Mandatory!</p></li><li><p>Simple <strong>full-text search</strong></p></li><li><p><strong>Contextual Query Language (CQL)</strong> as query language</p></li><li><p>Endpoints</p><div class="ulist"><ul><li><p>must support “term-only” queries</p></li><li><p>can support Boolean operators (<code>AND</code>/<code>OR</code>) and sub-queries</p></li><li><p>must abort in case of errors with appropriate diagnostics</p></li><li><p>can decide themselves what to search for</p><div class="paragraph"><p>(text, normalization etc.)</p></div></li></ul></div></li><li><p>Results serialized in <strong>Generic Hits (HITS) Data View</strong></p></li></ul></div>
<div class="paragraph"><p><strong><code>http://clarin.eu/fcs/capability/basic-search</code></strong></p></div></div></section><section id="_advanced_search" class="text-left"><h2>ADVANCED Search</h2><div class="slide-content"><div class="listingblock position-absolute right--30 width-50 opacity-50"><div class="content"><pre class="highlightjs highlight"><code class="language-x86asm hljs" data-noescape="true" data-lang="x86asm">"walking"
[token = "walking"]
"Dog" /c
[word = "Dog" /c]
[pos = "NOUN"]
[pos != "NOUN"]
[lemma = "walk"]
"blaue|grüne" [pos = "NOUN"]
"dogs" []{3,} "cats" within s
[z:pos = "ADJ"]
[z:pos = "ADJ" &amp; q:pos = "ADJ"]</code></pre></div></div>
<div class="ulist"><ul><li><p>Optional</p></li><li><p>Structured search in annotated data,</p><div class="paragraph"><p>represented in annotation layers</p></div>
<div class="paragraph"><p>→ Query language <strong>FCS-QL</strong></p></div>
<div class="ulist"><ul><li><p>Queries can combine different annotation layers</p></li><li><p>Endpoints should support as many annotation layers as possible</p></li></ul></div></li><li><p>Results serialized in <strong>Advanced (ADV) Data View</strong> and <strong>Generic Hits (HITS) Data View</strong></p></li></ul></div>
<div class="paragraph"><p><strong><code>http://clarin.eu/fcs/capability/advanced-search</code></strong></p></div></div></section><section id="_fcs_ql"><h2>FCS-QL</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>Annotation Layers</strong>, containing annotations of a certain type (e.g. text, POS tags, …)</p></li><li><p>Query supports combination of these layers</p></li><li><p>Each layer is <strong>segmented</strong> → search for individual lemma</p><div class="ulist"><ul><li><p>No requirement as to how segmentation should be done</p></li><li><p><em>Assumption that segmentation is consistent across layers (for display in</em> Advanced Data View<em>)</em></p></li><li><p>Queries can combine segments for multi-token patterns</p></li></ul></div></li></ul></div></div></section><section id="_fcs_ql_notes"><h2>FCS-QL – Notes</h2><div class="slide-content"><div class="ulist"><ul><li><p>Endpoints must be able to parse FCS-QL completely!</p></li><li><p>Requests with unsupported operators or layers?</p><div class="ulist"><ul><li><p>Generate errors with diagnostics, or</p></li><li><p>Rewrite queries if permitted by “<code>x-fcs-rewrites-allowed</code>” (on request)</p></li></ul></div></li><li><p>Searches are <em>Case Sensitive</em> (configurable in the query)</p></li><li><p>Searches (by endpoints) should take place on layers where it makes sense,</p><div class="paragraph"><p>e.g. if there are several text or POS layers</p></div></li></ul></div></div></section><section id="_fcs_ql_layer_types"><h2>FCS-QL – Layer Types</h2><div class="slide-content"><table class="tableblock frame-all grid-all x-small" style="width:100%"><colgroup><col style="width:10%"><col style="width:50%"><col style="width:10%"><col style="width:30%"></colgroup><thead><tr><th class="tableblock halign-left valign-top" style="background-color:;">Layer Type Identifier</th><th class="tableblock halign-left valign-top" style="background-color:;">Annotation Layer Description</th><th class="tableblock halign-left valign-top" style="background-color:;">Syntax</th><th class="tableblock halign-left valign-top" style="background-color:;">Examples (without quotes)</th></tr><tbody><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>text</code></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Textual representation of resource, also the layer that is used in Basic Search</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">String</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">"Dog", "cat" "walking", "better"</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>lemma</code></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Lemmatisation</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">String</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">"good", "walk", "dog"</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>pos</code></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Part-of-Speech annotations</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><a href="#ref:UD-POS">Universal POS</a> tags</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">"NOUN", "VERB", "ADJ"</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>orth</code></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Orthographic transcription of (mostly) spoken resources</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">String</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">"dug", "cat", "wolking"</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>norm</code></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Orthographic normalization of (mostly) spoken resources</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">String</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">"dog", "cat", "walking", "best"</p></td></tr><tr><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>phonetic</code></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">Phonetic transcription</p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><a href="#ref:SAMPA">SAMPA</a></p></td><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">"'du:", "'vi:-d6 'ha:-b@n"</p></td></tr></table>
<div class="openblock refs xx-small"><div class="content"><div class="ulist"><ul><li><p><a></a>Universal Dependencies, <a href="https://universaldependencies.github.io/u/pos/index.html">Universal POS tags v2.0</a></p></li><li><p><a></a>Dafydd Gibbon, Inge Mertins, Roger Moore (Eds.): Handbook of Multimodal and Spoken Language Systems. Resources, Terminology and Product Evaluation, Kluwer Academic Publishers, Boston MA, 2000, ISBN 0-7923-7904-7</p></li></ul></div></div></div></div></section><section id="_fcs_ql_layer_type_identifier"><h2>FCS-QL – Layer Type Identifier</h2><div class="slide-content"><div class="ulist"><ul><li><p>Identifies layers for <em>FCS-QL</em> and <em>Advanced Data View</em></p></li><li><p>Other identifiers are <em>not</em> allowed, except for testing purposes</p></li><li><p>Custom identifiers must be prefixed with “<code>x-</code>”</p></li></ul></div></div></section><section id="_result_serialization"><h2>Result Serialization</h2><div class="slide-content"><div class="ulist"><ul><li><p>Results must be serialized in CLARIN FCS format</p><div class="ulist"><ul><li><p>Resource (Fragment), Data View</p></li><li><p>XML → <a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/attachments/Resource.xsd">XSD</a></p></li></ul></div></li><li><p>Important: <strong>1 Hit = 1 Result Record</strong></p><div class="ulist"><ul><li><p>Do not combine multiple hits in one record</p><div class="paragraph"><p>→ generate separate SRU records for each hit that reference the same resource</p></div></li><li><p>Multiple hit markers are allowed, e.g. for boolean expressions to highlight individual terms</p></li><li><p>Each “Hit” should be defined in a <em>sentence context</em></p></li></ul></div></li></ul></div></div></section><section id="_result_serialization_cont" class="text-left x-small"><h2>Result Serialization (Cont.)</h2><div class="slide-content"><div class="paragraph"><p><strong>Resource</strong></p></div>
<div class="ulist"><ul><li><p>“<strong>searchable</strong> and <strong>addressable</strong> entity” in the endpoint, e.g. text corpus</p></li><li><p>“self contained”, i.e. entire document, not a single sentence from a document</p></li><li><p>Addressable as a whole via <em>Persistent Identifier</em> or <em>URI</em></p></li></ul></div>
<div class="paragraph"><p><strong>Resource Fragment</strong></p></div>
<div class="ulist"><ul><li><p>Part of a <em>Resource</em>, e.g. single sentence, or time interval in audio transcription (for multi-modal corpora)</p></li><li><p>Should be addressable within a <em>Resource</em> (offset / ID)</p></li><li><p>Optional, but recommended</p></li></ul></div>
<div class="paragraph"><p><strong>Data View</strong></p></div>
<div class="ulist"><ul><li><p>Serialization of a “Hits” in <em>Resource (Fragment)</em></p></li><li><p>Enables different representations, expandable</p></li></ul></div></div></section><section id="_result_serialization_linking"><h2>Result Serialization – Linking</h2><div class="slide-content"><div class="ulist"><ul><li><p>Endpoints should provide link to <em>Resource (Fragment)</em></p><div class="ulist"><ul><li><p>Persistent Identifier (PID) / URI</p></li><li><p>If direct linking is not possible, then e.g. website with description of the resource, corpus or collection</p></li><li><p>Link should be as specific as possible</p></li><li><p>PIDs preferred to URIs, both together recommended</p></li></ul></div></li></ul></div></div></section><section id="_result_serialization_examples"><h2>Result Serialization – Examples</h2><div class="slide-content"><div class="listingblock"><div class="title">HITS Data View of a resource with PID</div><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-noescape="true" data-lang="xml">&lt;fcs:Resource xmlns:fcs="http://clarin.eu/fcs/resource" pid="http://hdl.handle.net/4711/00-15"&gt;
  &lt;fcs:DataView type="application/x-clarin-fcs-hits+xml"&gt;
    &lt;!-- data view payload omitted --&gt;
  &lt;/fcs:DataView&gt;
&lt;/fcs:Resource&gt;</code></pre></div></div>
<div class="listingblock"><div class="title">HITS Data View for a resource with <em>Resource Fragment</em> for more granular structuring</div><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-noescape="true" data-line-numbers="2,6" data-lang="xml">&lt;fcs:Resource xmlns:fcs="http://clarin.eu/fcs/resource" pid="http://hdl.handle.net/4711/08-15"&gt;
  &lt;fcs:ResourceFragment&gt;
    &lt;fcs:DataView type="application/x-clarin-fcs-hits+xml"&gt;
      &lt;!-- data view payload omitted --&gt;
    &lt;/fcs:DataView&gt;
  &lt;/fcs:ResourceFragment&gt;
&lt;/fcs:Resource&gt;</code></pre></div></div></div></section><section id="_result_serialization_examples_2"><h2>Result Serialization – Examples (2)</h2><div class="slide-content"><div class="listingblock"><div class="title">HITS Data View with CMDI Data View for resource metadata</div><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-noescape="true" data-line-numbers="4,5,6,7,8,10,11,12,13,14,15" data-lang="xml">&lt;fcs:Resource xmlns:fcs="http://clarin.eu/fcs/resource"
              pid="http://hdl.handle.net/4711/08-15"
              ref="http://repos.example.org/file/text_08_15.html"&gt;
  &lt;fcs:DataView type="application/x-cmdi+xml" <i class="conum" data-value="1"></i><b>(1)</b>
                pid="http://hdl.handle.net/4711/08-15-1"
                ref="http://repos.example.org/file/08_15_1.cmdi"&gt;
      &lt;!-- data view payload omitted --&gt;
  &lt;/fcs:DataView&gt;

  &lt;fcs:ResourceFragment pid="http://hdl.handle.net/4711/08-15-2" <i class="conum" data-value="2"></i><b>(2)</b>
                        ref="http://repos.example.org/file/text_08_15.html#sentence2"&gt;
    &lt;fcs:DataView type="application/x-clarin-fcs-hits+xml"&gt;
      &lt;!-- data view payload omitted --&gt;
    &lt;/fcs:DataView&gt;
  &lt;/fcs:ResourceFragment&gt;
&lt;/fcs:Resource&gt;</code></pre></div></div>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Specification of CMDI metadata for the resource</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>Hit is part of a larger resource “semantically more meaningful”</td></tr></table></div></div></section><section id="_data_views"><h2>Data Views</h2><div class="slide-content"><div class="ulist"><ul><li><p>Specification (with XSD schema, examples)</p><div class="ulist"><ul><li><p>Data Views 1.0 (<a href="https://office.clarin.eu/v/CE-2014-0317-CLARIN_FCS_Specification_DataViews_1_0-v20170613.pdf">pdf</a>, <a href="https://github.com/clarin-eric/fcs-misc/tree/main/fcs-dataviews-1.0">repo</a>)</p></li><li><p>FCS Core 2.0 (<a href="https://office.clarin.eu/v/CE-2017-1046-FCS-Specification-v20230426.pdf">pdf</a>, <a href="https://github.com/clarin-eric/fcs-misc/tree/main/fcs-core-2.0">repo</a>) (primary)</p></li></ul></div></li><li><p>Specified in FCS Core 2.0</p><div class="ulist"><ul><li><p>Advanced (ADV) Data View</p></li><li><p>Generic Hits (HITS) Data View</p></li></ul></div></li><li><p>Additional Data Views such as <em>Component Metadata (CMDI)</em>, <em>Images (IMG)</em>, <em>Geolocation (GEO)</em> are included, but not used in the standard FCS client “Aggregator”</p></li></ul></div></div></section><section id="_data_views_2"><h2>Data Views (2)</h2><div class="slide-content"><div class="ulist"><ul><li><p>Mandatory “<code>send-by-default</code>”</p><div class="paragraph"><p>or optional “<code>need-to-request</code>”</p></div></li><li><p>Generic <em>Hits</em> Data View is mandatory, must always be sent</p></li><li><p>Only send data views that</p><div class="ulist"><ul><li><p>explicitely requested with (SRU) FCS parameter “<code>x-fcs-dataviews</code>”, or</p></li><li><p>have delivery policy “<code>send-by-default</code>”</p></li></ul></div></li><li><p>Invalid Data Views → non-fatal diagnostic for each requested Data View</p><div class="paragraph"><p><code>http://clarin.eu/fcs/diagnostic/4</code></p></div>
<div class="paragraph"><p>("Requested Data View not valid for this resource")</p></div></li></ul></div></div></section><section id="_hits_data_view" class="columns"><h2>Hits Data View</h2><div class="slide-content"><div class="openblock column"><div class="content"><table class="tableblock frame-all grid-all x-small" style="width:100%"><colgroup><col style="width:33.3333%"><col style="width:66.6667%"></colgroup><tbody><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Description</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">The representation of the hit</p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">MIME type</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>application/x-clarin-fcs-hits+xml</code></p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Payload Disposition</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><em>inline</em></p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Payload Delivery</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><em>send-by-default</em> (<code>REQUIRED</code>)</p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Recommended Short Identifier</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>hits</code> (<code>RECOMMENDED</code>)</p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">XML Schema</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><a href="https://office.clarin.eu/v/attachments/DataView-Hits.xsd">DataView-Hits.xsd</a></p></td></tr></table></div></div>
<div class="openblock column small ms-5"><div class="content"><div class="ulist"><ul><li><p>Required implementation</p></li><li><p>Simplest serialization, (lossy) approximation of results</p></li><li><p>Each hit should only occur in a single sentence context (or similar)</p></li><li><p>Multiple hit annotations possible, e.g. for conjunctions in the query</p></li></ul></div></div></div></div></section><section id="_hits_data_view_examples"><h2>Hits Data View – Examples</h2><div class="slide-content"><div class="listingblock"><div class="title">HITS Data View with a hit marker</div><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-noescape="true" data-line-numbers="2,6" data-lang="xml">&lt;!-- potential @pid and @ref attributes omitted --&gt;
&lt;fcs:DataView type="application/x-clarin-fcs-hits+xml"&gt;
  &lt;hits:Result xmlns:hits="http://clarin.eu/fcs/dataview/hits"&gt;
    The quick brown &lt;hits:Hit&gt;fox&lt;/hits:Hit&gt; jumps over the lazy dog.
  &lt;/hits:Result&gt;
&lt;/fcs:DataView&gt;</code></pre></div></div>
<div class="listingblock"><div class="title">HITS Data View with multiple hit markers for boolean queries</div><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-noescape="true" data-line-numbers="3" data-lang="xml">&lt;!-- potential @pid and @ref attributes omitted --&gt;
&lt;fcs:DataView type="application/x-clarin-fcs-hits+xml"&gt;
  &lt;hits:Result xmlns:hits="http://clarin.eu/fcs/dataview/hits"&gt;
    The quick brown &lt;hits:Hit&gt;fox&lt;/hits:Hit&gt; jumps over the lazy &lt;hits:Hit&gt;dog&lt;/hits:Hit&gt;.
  &lt;/hits:Result&gt;
&lt;/fcs:DataView&gt;</code></pre></div></div></div></section><section id="_kwic_data_view" class="columns"><h2>KWIC Data View</h2><div class="slide-content"><div class="openblock column"><div class="content"><table class="tableblock frame-all grid-all x-small" style="width:100%"><colgroup><col style="width:33.3333%"><col style="width:66.6667%"></colgroup><tbody><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Description</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">The representation of the hit</p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">MIME type</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>application/x-clarin-fcs-kwic+xml</code></p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Payload Disposition</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><em>inline</em></p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Payload Delivery</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><em>send-by-default</em> (<code>REQUIRED</code>)</p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Recommended Short Identifier</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>kwic</code> (<code>RECOMMENDED</code>)</p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">XML Schema</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">-</p></td></tr></table></div></div>
<div class="openblock column small ms-5"><div class="content"><div class="ulist"><ul><li><p><strong>Deprecated!</strong></p></li><li><p>Only for compatibility with  <em>Legacy FCS</em> clients</p></li><li><p>Example in <a href="https://github.com/clarin-eric/fcs-sru-cqi-bridge/blob/9bcbe0f3297bde3f578b7eb6403d248571ac6bc2/src/main/java/eu/clarin/sru/cqibridge/CqiSRUSearchResultSet.java#L136-L144">CQP/SRU bridge</a></p></li><li><p>Mapping of</p><div class="ulist"><ul><li><p>left and right context,</p></li><li><p>hits</p></li></ul></div></li></ul></div>
<div class="ulist"><ul><li><p>Serializer <a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/main/src/main/java/eu/clarin/sru/server/fcs/XMLStreamWriterHelper.java#L235">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/xml/writer.py#L146">Python</a></p></li><li><p>Aggregator transforms it to <em>Hits</em> Data View!</p></li></ul></div></div></div></div></section><section id="_advanced_data_view" class="columns"><h2>Advanced Data View</h2><div class="slide-content"><div class="openblock column"><div class="content"><table class="tableblock frame-all grid-all x-small" style="width:100%"><colgroup><col style="width:33.3333%"><col style="width:66.6667%"></colgroup><tbody><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Description</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock">The representation of the hit for Advanced Search</p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">MIME type</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>application/x-clarin-fcs-adv+xml</code></p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Payload Disposition</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><em>inline</em></p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Payload Delivery</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><em>send-by-default</em> (<code>REQUIRED</code>)</p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">Recommended Short Identifier</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><code>adv</code> (<code>RECOMMENDED</code>)</p></td></tr><tr><th class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock header">XML Schema</p></th><td class="tableblock halign-left valign-top" style="background-color:;"><p class="tableblock"><a href="https://office.clarin.eu/v/attachments/DataView-Advanced.xsd">DataView-Advanced.xsd</a></p></td></tr></table></div></div>
<div class="openblock column small ms-5"><div class="content"><div class="ulist"><ul><li><p>Serialization for <em>Advanced Search</em> for multimedia data (text, transcribed audio)</p></li><li><p>Presentation of structured information via multiple annotation layers</p></li><li><p>Annotations are streams (ranges) over the signal in a stand-off like format with start and end offsets (inclusive)</p></li><li><p>Segmentation via <code>&lt;Segment&gt;</code>, annotations in <code>&lt;Span&gt;</code> in <code>&lt;Layer&gt;</code></p><div class="ulist"><ul><li><p>Segments must be possible to align over all annotation layers</p></li></ul></div></li></ul></div></div></div></div></section><section id="_advanced_data_view_example"><h2>Advanced Data View – Example</h2><div class="slide-content"><div class="imageblock"><img src="images/adv-db-stream-example.png" alt="Advanced Data View - Stream Data"></div></div></section><section id="_advanced_data_view_example_2"><h2>Advanced Data View – Example (2)</h2><div class="slide-content"><div class="imageblock"><img src="images/adv-dv-example-relation.png" alt="Advanced Data View - Relation"></div></div></section><section id="_advanced_data_view_presentation"><h2>Advanced Data View – Presentation</h2><div class="slide-content"><div class="imageblock"><img src="images/adv-dv-visualization.png" alt="Advanced Data View - Visualization in Aggregator"></div>
<div class="openblock refs xx-small"><div class="content"><div class="paragraph"><p><a href="https://contentsearch.clarin.eu/?&amp;queryType=fcs&amp;query=%5B%20word%20%3D%20%22her.*%22%20%5D%20%5B%20lemma%20%3D%20%22Artznei%22%20%5D%20%5B%20pos%20%3D%20%22VERB%22%20%5D" class="bare">https://contentsearch.clarin.eu/?&amp;queryType=fcs&amp;query=%5B%20word%20%3D%20%22her.*%22%20%5D%20%5B%20lemma%20%3D%20%22Artznei%22%20%5D%20%5B%20pos%20%3D%20%22VERB%22%20%5D</a></p></div></div></div></div></section><section id="_examples" class="text-left small"><h2>Examples</h2><div class="slide-content"><div class="paragraph"><p>→ see <a href="#_searchretrieve_2_0_query_examples">more examples</a> (<code>searchRetrieve</code> query)<br>
endpoint: <a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru" class="bare">https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru</a></p></div>
<div class="ulist"><ul><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?operation=searchRetrieve&amp;queryType=fcs&amp;query=%5bword%3d%22anv%C3%A4ndning%22%5d">…?operation=searchRetrieve&<strong>queryType=fcs</strong>&query=<strong>%5bword%3d%22anv%C3%A4ndning%22%5d</strong></a></p><div class="paragraph"><p>→ FCS 2.0, FCS-QL: <code class="green">[ word = "användning" ]</code>, HITS + ADV</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?operation=searchRetrieve&amp;queryType=cql&amp;query=%22anv%C3%A4ndning%22">…?operation=searchRetrieve&<strong>queryType=cql</strong>&query=<strong>%22anv%C3%A4ndning%22</strong></a></p><div class="paragraph"><p>→ FCS 2.0, CQL: <code class="green">"användning"</code>, HITS</p></div></li><li><p><a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?operation=searchRetrieve&amp;version=1.2&amp;query=cat">…?operation=searchRetrieve&version=1.2&query=cat</a> ↔ <a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru?query=cat">…?query=cat</a> → HITS</p><div class="ulist"><ul><li><p>FCS 1.0, <code class="grey">sru="http://www.loc.gov/zing/srw/"</code></p></li><li><p>FCS 2.0, <code class="grey">sruResponse="http://docs.oasis-open.org/ns/search-ws/sruResponse"</code></p></li></ul></div></li><li><p>more parameters: <code>x-indent-response=1</code> / <code>x-fcs-dataviews=cmdi</code> / <code>x-fcs-context=11022/0000-0000-20DF-1</code></p></li></ul></div>
<div style="page-break-after: always;"></div></div></section></section>
<section><section id="_query_translation" data-background-image="images/fcs-render-uk.png" data-background-opacity="0.5"><h2>Query Translation</h2><div class="slide-content"><aside class="notes"><div class="ulist"><ul><li><p>Query Languages, Visualization</p></li><li><p>FCS-QL Details</p></li><li><p>Query Mapping</p></li></ul></div></aside></div></section><section id="_query_languages" class="small"><h2>Query Languages</h2><div class="slide-content"><div class="imageblock position-absolute right--20 zindex--1"><img src="images/cql-js-screenshot.png" alt="CQL-JS Demo"></div>
<div class="ulist"><ul><li><p>More resources in <a href="https://github.com/clarin-eric/awesome-fcs#query-parsers">Awesome FCS List &gt; Query Parsers</a></p></li><li><p><strong>CQL</strong> (Contextual Query Language)</p><div class="ulist"><ul><li><p>BNF grammar: www.loc.gov/standards/sru/cql/spec.html#bnf</p></li><li><p>Hand-written <a href="https://github.com/clarin-eric/awesome-fcs#cql-contextual-query-language">parser implementation</a> in Java, Python, JS, …</p></li><li><p>Documentation: <a href="http://zing.z3950.org/cql/java/docs/index.html">Java</a></p></li><li><p>Visualization in <a href="https://github.com/Querela/cql-js">demo of JS parser</a></p><div class="ulist"><ul><li><p>Validation for <a href="https://gitlab.gwdg.de/textplus/ag-fcs-lex-fcs-cql-js">Text+ LexCQL</a></p></li></ul></div></li></ul></div></li><li><p><strong>FCS-QL</strong> (Federated Content Search Query Language)</p><div class="ulist"><ul><li><p>EBNF grammar: <a href="https://github.com/clarin-eric/fcs-misc/blob/main/fcs-core-2.0/fcsql-grammar.ebnf">github.com/clarin-eric/fcs-misc</a> (FCS Core 2.0)</p></li><li><p><a href="https://github.com/clarin-eric/awesome-fcs#fcs-ql-federated-content-search-query-language">Parser implementation</a> in <a href="https://github.com/clarin-eric/fcs-ql">Java</a>, <a href="https://github.com/Querela/fcs-ql-python">Python</a>,</p><div class="paragraph"><p>using ANTRL4, parsed into own wrappers (<a href="https://github.com/clarin-eric/fcs-simple-endpoint/tree/FCSSimpleEndpoint-1.6.0/src/main/java/eu/clarin/sru/server/fcs/parser">Java</a>, <a href="https://github.com/Querela/fcs-ql-python/blob/1.0.1/src/fcsql/parser.py">Python</a>)</p></div></li><li><p>Documentation: <a href="https://clarin-eric.github.io/fcs-simple-endpoint/apidocs/eu/clarin/sru/server/fcs/parser/package-summary.html">Java</a>, <a href="https://fcs-ql-python.readthedocs.io/en/latest/reference/fcsql.parser.html">Python</a></p></li><li><p>Grammar visualization with ANTLR4 tools</p></li></ul></div></li></ul></div></div></section><section id="_fcs_ql_visualization" class="text-left"><h2>FCS-QL – Visualization</h2><div class="slide-content"><div class="imageblock position-absolute right--20 width-50 zindex--1"><img src="images/fcsql-parse-tree-java.png" alt="FCS-QL parse tree"></div>
<div class="ulist"><ul><li><p>Installation</p><div class="listingblock code-width-full"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">pip install antlr4-tools
git clone https://github.com/clarin-eric/fcs-ql.git
cd fcs-ql/src/main/antlr4/eu/clarin/sru/fcs/qlparser</code></pre></div></div></li></ul></div>
<div class="ulist mt-5"><ul><li><p>Visualization according to <a href="https://github.com/antlr/antlr4/blob/master/doc/getting-started.md">ANTLR4 &gt; Getting Started</a></p><div class="listingblock code-width-full"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">antlr4-parse src/fcsql/FCSParser.g4 src/fcsql/FCSLexer.g4 query -gui
[ word = "her.*" ] [ lemma = "Artznei" ] [ pos = "VERB" ]
^D</code></pre></div></div></li></ul></div></div></section><section id="_fcs_ql_query_nodes" class="text-left small"><h2>FCS-QL Query Nodes</h2><div class="slide-content"><div class="paragraph"><p>QueryNode (with child node “children”)</p></div>
<div class="ulist"><ul><li><p>Expression (layer identifier, layer identifier qualifier, operator, regular expression + flags)</p><div class="ulist"><ul><li><p><span class="darkgrey">Wildcard</span></p></li><li><p>Group → 1 QueryNode; “<code>(</code>” … “<code>)</code>”</p></li><li><p><span class="darkgrey">NOT → 1 QueryNode</span></p></li><li><p>AND, OR → list of QueryNodes</p></li></ul></div></li><li><p><span class="darkgrey">QueryDisjunction → list of QueryNodes</span></p></li><li><p>QuerySequence → list of QueryNodes → <span class="green">“list of QuerySegmenten”</span></p></li><li><p>QuerySegment (min, max) → Expression → <span class="green">“a single token”</span></p></li><li><p><span class="darkgrey">QueryGroup (min, max) → QueryNode</span></p></li><li><p><span class="darkgrey">Within-Query (SimpleWithin, QueryWithWithin) (Scope: sentence, utterance, paragraph, turn, text, session)</span> <span class="green"><em>(unused)</em></span></p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>grayed out: currently not supported by the FCS Aggregator for searching (in visual query builder)</p></li></ul></div></aside></div></section><section id="_fcs_ql_query_nodes_aggregator" class="text-left small"><h2>FCS-QL Query Nodes – Aggregator</h2><div class="slide-content"><div class="imageblock position-absolute width-50 right--20 opacity-50 zindex--1"><img src="images/fcsql-querybuilder-complex.png" alt="FCS-QL Query Builder"></div>
<div class="paragraph"><p>Parsed Query:</p></div>
<div class="ulist"><ul><li><p><strong>Query Sequence</strong> → <span class="green">with list of <em>Query Segment</em></span></p><div class="exampleblock darkgrey"><div class="content"><div class="paragraph"><p>[ word = ".*her" ] [ lemma = "Artznei" ] [ pos = "VERB" ]</p></div></div></div></li><li><p><strong>Query Segment</strong> → <span class="green">a token (can be repeatable)</span></p><div class="exampleblock darkgrey"><div class="content"><div class="paragraph"><p>[ word = "her.*" &amp; ( word = "test" | word = "Apfel" ) ]
[ pos = "ADV" ]{1,3}</p></div></div></div>
<div class="openblock"><div class="content"><div class="ulist"><ul><li><p><strong>Expression AND</strong></p><div class="exampleblock darkgrey"><div class="content"><div class="paragraph"><p>[ word = "her.*" &amp; word = "test" ]</p></div></div></div>
<div class="ulist"><ul><li><p>Expression Group</p></li><li><p>Expression</p></li></ul></div></li><li><p><strong>Expression Group</strong> → <strong>Expression OR</strong> → <span class="green">list of <em>Expression</em></span></p><div class="exampleblock darkgrey"><div class="content"><div class="paragraph"><p>[ ( word = "her.*" | word = "Test" ) ]</p></div></div></div></li><li><p><strong>Expression</strong> → <span class="green"><strong>Layer Identifier</strong>, <strong>Operator</strong>, <strong>Regex</strong> (value)</span></p><div class="exampleblock darkgrey"><div class="content"><div class="paragraph"><p>[ word = "her.*" ]</p></div></div></div></li></ul></div></div></div></li></ul></div></div></section><section id="_fcs_ql_remarks"><h2>FCS-QL – Remarks</h2><div class="slide-content"><div class="ulist"><ul><li><p>Currently (<em>Aggregator v3.9.1</em>) only <em>limited</em> support of all FCS-QL features</p><div class="paragraph"><p>→ partly due to Visual Query Builder</p></div></li><li><p>Free text input / improved query builder planned for the future</p></li><li><p>Use appropriate diagnostics if query features are not supported</p><div class="ulist"><ul><li><p>SRU: <code>\info:srw/diagnostic/1/48</code> - <span class="green">Query feature unsupported.</span></p></li><li><p><span class="line-through">FCS: <code>http://clarin.eu/fcs/diagnostic/10</code> - <span class="green">General query syntax error.</span></span> - should be intercepted by FCS-QL parser library</p></li><li><p>FCS: <code>http://clarin.eu/fcs/diagnostic/11</code> - <span class="green">Query too complex. Cannot perform Query.</span></p></li></ul></div></li></ul></div></div></section><section id="_query_mapping" class="small"><h2>Query-Mapping</h2><div class="slide-content"><div class="ulist"><ul><li><p>Idea:</p><div class="ulist"><ul><li><p>Let libraries parse raw queries (CQL, FCS-QL)</p></li><li><p>Recursively walk through the parsed query tree, “depth first”</p></li><li><p>Successively generate transformed query (for target system),</p><div class="paragraph"><p>e.g. <code>StringBuilder</code> in Java</p></div></li></ul></div></li><li><p>Examples:</p><div class="ulist"><ul><li><p><a href="https://www.kielipankki.fi/support/korp-advanced/">Korp</a>: CQL → CQP (<a href="https://github.com/clarin-eric/fcs-korp-endpoint/blob/ffccf7f65cc55744e1b1a8cebacce5485c530bda/src/main/java/se/gu/spraakbanken/fcs/endpoint/korp/cqp/FCSToCQPConverter.java#L50-L112">Java</a>, <a href="https://github.com/Querela/fcs-korp-endpoint-python/blob/5ee448d2369e450571a6d82d3e379154752a3397/src/korp_endpoint/query_converter.py#L26-L67">Python</a>), FCS-QL → CQP (<a href="https://github.com/clarin-eric/fcs-korp-endpoint/blob/ffccf7f65cc55744e1b1a8cebacce5485c530bda/src/main/java/se/gu/spraakbanken/fcs/endpoint/korp/cqp/FCSToCQPConverter.java#L114-L332">Java</a>, <a href="https://github.com/Querela/fcs-korp-endpoint-python/blob/5ee448d2369e450571a6d82d3e379154752a3397/src/korp_endpoint/query_converter.py#L73-L210">Python</a>)</p></li><li><p><a href="https://www.sketchengine.eu/documentation/corpus-querying/">NoSketchEngine</a>: CQL → CQL (<a href="https://github.com/Leipzig-Corpora-Collection/fcs-noske-endpoint/blob/main/src/main/java/de/saw_leipzig/textplus/webservices/fcs/fcs_noske_endpoint/query/CQLtoNoSkECQLConverter.java">Java</a>), FCS-QL → CQL (<a href="https://github.com/Leipzig-Corpora-Collection/fcs-noske-endpoint/blob/main/src/main/java/de/saw_leipzig/textplus/webservices/fcs/fcs_noske_endpoint/query/FCSQLtoNoSkECQLConverter.java">Java</a>)</p></li><li><p><a href="https://solr.apache.org/guide/solr/latest/query-guide/standard-query-parser.html">Solr</a>: CQL → Solr (<a href="https://gist.github.com/Querela/825a084f94b30de88827050eddc8e361#file-cqltosolrconverter-java">Java</a>), LexCQL → Solr (<a href="https://gist.github.com/Querela/825a084f94b30de88827050eddc8e361#file-lexcqltosolrconverter-java">Java</a>)</p><div class="ulist"><ul><li><p>SolrQuery with  <a href="https://solr.apache.org/guide/solr/latest/query-guide/highlighting.html">highlighting</a>, Custom <a href="https://gist.github.com/Querela/825a084f94b30de88827050eddc8e361#file-searcher-java-L38-L44">hit prefixes/postfixes</a>, use Solr result as pre-formatted Data View content (<a href="https://gist.github.com/Querela/825a084f94b30de88827050eddc8e361#file-sawsrusearchresultset-java-L137-L262">Code</a>)</p></li></ul></div></li><li><p>CQI Bridge: CQL → CQP (<a href="https://github.com/clarin-eric/fcs-sru-cqi-bridge/blob/9bcbe0f3297bde3f578b7eb6403d248571ac6bc2/src/main/java/eu/clarin/sru/cqibridge/CqiSRUSearchEngine.java#L228-L265">Java</a>)</p></li></ul></div></li></ul></div></div></section><section id="_query_mapping_2" class="small"><h2>Query-Mapping (2)</h2><div class="slide-content"><div class="ulist"><ul><li><p>ElasticSearch</p><div class="ulist"><ul><li><p>Only BASIC Search with <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/full-text-queries.html">full-text queries</a>, e.g. with <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-simple-query-string-query.html">Simple Query String</a></p></li></ul></div></li><li><p>Solr</p><div class="ulist"><ul><li><p>Only BASIC Search</p></li><li><p>ADVANCED Search with e.g. <a href="https://meertensinstituut.github.io/mtas/index.html">MTAS</a> (“Multi Tier Annotation Search”)</p></li></ul></div></li><li><p>In general: use actual <strong>Corpus Search Engine</strong> for ADVANCED Search</p><div class="paragraph"><p>→ otherwise <em>at most</em> a single annotation layer (“text”) can be searched</p></div></li></ul></div>
<div style="page-break-after: always;"></div></div></section></section>
<section><section id="_fcs_endpoint_development" data-background-image="images/fcs-render-uk.png" data-background-opacity="0.5"><h2>FCS Endpoint Development</h2><div class="slide-content"><aside class="notes"><div class="ulist"><ul><li><p>VSCode settings, kickstart a project</p></li><li><p>Minimal FCS endpoint, search engine connection, result serialization</p></li><li><p>Deployment, Embedding, Extensibility</p></li></ul></div></aside></div></section><section id="_visual_studio_code_suggestion" class="small"><h2>Visual Studio Code <em>(suggestion)</em></h2><div class="slide-content"><div class="imageblock position-absolute right--10 width-20 zindex--1"><img src="images/vscode-logo.png" alt="CQL-JS Demo"></div>
<div class="ulist"><ul><li><p>Download &amp; Installation: <a href="https://code.visualstudio.com/">code.visualstudio.com</a></p></li><li><p>Extensions:</p><div class="ulist"><ul><li><p><strong>Java</strong></p><div class="ulist"><ul><li><p><a href="https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-pack">vscjava.vscode-java-pack</a></p></li><li><p><a href="https://marketplace.visualstudio.com/items?itemName=redhat.vscode-xml">redhat.vscode-xml</a> (optional)</p></li></ul></div></li><li><p><strong>Python</strong></p><div class="ulist"><ul><li><p><a href="https://marketplace.visualstudio.com/items?itemName=ms-python.python">ms-python.python</a></p></li><li><p><a href="https://marketplace.visualstudio.com/items?itemName=ms-python.vscode-pylance">ms-python.vscode-pylance</a>, <a href="https://marketplace.visualstudio.com/items?itemName=ms-python.black-formatter">ms-python.black-formatter</a> (optional)</p></li></ul></div></li><li><p><strong>Quality of Life</strong></p><div class="ulist"><ul><li><p><a href="https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens">eamodio.gitlens</a></p></li><li><p><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack">ms-vscode-remote.vscode-remote-extensionpack</a>, <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.remote-explorer">ms-vscode.remote-explorer</a> (for WSL or remote via SSH)</p></li></ul></div></li></ul></div></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>QoL = Quality of Life</p></li></ul></div></aside></div></section><section id="_visual_studio_code_debugging_java"><h2>Visual Studio Code – Debugging (Java)</h2><div class="slide-content"><div class="ulist"><ul><li><p>For <code>*.war</code>/Jetty web application testing</p></li><li><p>No hot code swapping / do not make any changes between compilation and debugging!</p></li><li><p>VSCode Debug Setting:</p><div class="ulist"><ul><li><p><em>Run and Debug &gt; Add Configuration … &gt; “Java: Attach by Process ID”</em></p></li></ul></div></li><li><p>Run application with Maven:</p><div class="listingblock code-width-full"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">MAVEN_OPTS="-Xdebug -Xnoagent -Djava.compiler=NONE -agentlib:jdwp=transport=dt_socket,server=y,address=5005" \
    mvn [jetty:run-war|...]</code></pre></div></div></li></ul></div></div></section><section id="_visual_studio_code_debugging_python" class="columns"><h2>Visual Studio Code – Debugging (Python)</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><code>launch.json</code></p><div class="ulist"><ul><li><p><strong>pytest</strong>: no predefined configuration in “Run and Debug” menu</p></li><li><p>file/module: as required</p></li></ul></div></li><li><p><code>settings.json</code></p><div class="ulist"><ul><li><p><strong>pytest</strong>: coverage must be deactivated here!</p></li></ul></div></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-json hljs" data-noescape="true" data-lang="json">{
    "name": "Python: pytest",
    "type": "python",
    "request": "launch",
    "console": "integratedTerminal",
    "purpose": [
        "debug-test"
    ],
    "justMyCode": false
}</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-json hljs" data-noescape="true" data-lang="json">"python.testing.pytestArgs": [
    ".",
    // disable coverage for debugging
    "--no-cov",
    // disable ansi color output (-vv)
    "-q",
],</code></pre></div></div></div></div></div></section><section id="_kickstart_fcs_endpoint_project"><h2>Kickstart FCS Endpoint Project</h2><div class="slide-content"><div class="ulist"><ul><li><p>See <a href="#_guide_to_endpoint_development">[_guide_to_endpoint_development]</a></p><div class="paragraph"><p>→ Using reference endpoint implementations</p></div></li></ul></div>
<div class="ulist mt-4"><ul><li><p>Using the corp endpoint</p><div class="ulist"><ul><li><p>Java: <a href="https://github.com/clarin-eric/fcs-korp-endpoint">github.com/clarin-eric/fcs-korp-endpoint</a></p></li><li><p>Python: <a href="https://github.com/Querela/fcs-korp-endpoint-python/">github.com/Querela/fcs-korp-endpoint-python</a></p></li><li><p>Java: <a href="https://github.com/clarin-eric/fcs-sru-cqi-bridge">github.com/clarin-eric/fcs-sru-cqi-bridge</a> (CQP/SRU bridge)</p></li></ul></div></li><li><p>Java: project generation with <strong>Maven</strong></p><div class="ulist"><ul><li><p>Project template: <a href="https://github.com/clarin-eric/fcs-endpoint-archetype">github.com/clarin-eric/fcs-endpoint-archetype</a></p></li></ul></div></li></ul></div></div></section><section id="_clarin_srufcs_endpoint_archetype" class="text-left"><h2>CLARIN SRU/FCS Endpoint Archetype</h2><div class="slide-content"><div class="ulist"><ul><li><p>Installation of the archetype in the local Maven repository, or</p></li><li><p>Configuration of the CLARIN Nexus as a remote repository</p></li><li><p>Project generation with Maven:</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">mvn archetype:generate \
    -Pclarin \
    -DarchetypeGroupId=eu.clarin.sru.fcs \
    -DarchetypeArtifactId=fcs-endpoint-archetype \
    -DarchetypeVersion=1.6.0 \
    -DgroupId=[ id.group.fcs ] \
    -DartifactId=[ my-cool-endpoint ] \
    -Dversion=[ 1.0-SNAPSHOT ] \
    -DinstitutionName=[ "My Institution" ]</code></pre></div></div>
<div class="openblock x-small darkgrey ms-6"><div class="content"><div class="ulist"><ul><li><p><em>all <code>[</code>&#8230;&#8203; <code>]</code> placeholders must be replaced with the appropriate values (enclose values with spaces in quotation marks)</em></p></li><li><p><em>if using the CLARIN remote repository, the custom profile is selected with <code>-Pclarin</code>, see <a href="https://github.com/clarin-eric/fcs-endpoint-archetype/blob/main/README.md#b-using-the-remote-clarin-maven-repositorynexus">example maven configuration</a></em></p></li><li><p><em>if archetype is installed using <code>git</code>, then use <code>archetypeVersion=1.6.0-SNAPSHOT</code> (see details in <a href="https://github.com/clarin-eric/fcs-endpoint-archetype/blob/main/pom.xml#L8"><code>pom.xml</code></a>)</em></p></li></ul></div></div></div></div></section><section id="_minimal_fcs_endpoint" class="small"><h2>Minimal FCS Endpoint</h2><div class="slide-content"><div class="ulist"><ul><li><p>Required class implementations</p><div class="ulist"><ul><li><p><code>SimpleEndpointSearchEngineBase</code></p></li><li><p><code>SRUSearchResultSet</code></p></li><li><p><strong>Wrapper or adapter for search engine (!)</strong></p></li></ul></div></li><li><p>Required configurations</p><div class="ulist"><ul><li><p><code>sru-server-config.xml</code></p></li><li><p><code>endpoint-description.xml</code></p></li><li><p>Web app configurations</p><div class="paragraph"><p>(Java: <code>web.xml</code>, Python: key-value parameter dict)</p></div>
<div class="ulist"><ul><li><p>Reference to implementation of the <code>SimpleEndpointSearchEngineBase</code></p></li><li><p>Required SRU parameters (<code>host</code>, <code>port</code>, <code>server</code>, …)</p></li></ul></div></li></ul></div></li></ul></div></div></section><section id="_minimal_fcs_endpoint_initialization" class="text-left x-small"><h2>Minimal FCS Endpoint – Initialization</h2><div class="slide-content"><div class="paragraph"><p>→ <strong><code>SimpleEndpointSearchEngineBase</code></strong> (<a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/main/src/main/java/eu/clarin/sru/server/fcs/SimpleEndpointSearchEngineBase.java">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/server/search.py#L507">Python</a>)</p></div>
<div class="paragraph mt-4"><p><code>void doInit (ServletContext context, SRUServerConfig config, SRUQueryParserRegistry.Builder queryParsersBuilder, Map&lt;String, String&gt; params)</code> - <a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/main/src/main/java/eu/clarin/sru/server/fcs/SimpleEndpointSearchEngineBase.java#L288">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/server/search.py#L722">Python</a></p></div>
<div class="ulist"><ul><li><p>Required implementation!</p></li><li><p>(optional) initialization of APIs, default values (PIDs), …</p></li></ul></div>
<div class="paragraph mt-4"><p><code>EndpointDescription createEndpointDescription (ServletContext context, SRUServerConfig config, Map&lt;String, String&gt; params)</code> - <a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/main/src/main/java/eu/clarin/sru/server/fcs/SimpleEndpointSearchEngineBase.java#L265">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/server/search.py#L713">Python</a></p></div>
<div class="ulist"><ul><li><p>Required implementation!</p></li><li><p>Loading of <code>EndpointDescription</code> (<a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/main/src/main/java/eu/clarin/sru/server/fcs/utils/SimpleEndpointDescription.java">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/server/search.py#L430">Python</a>)</p><div class="ulist"><ul><li><p>embedded XML file (load with <code>SimpleEndpointDescriptionParser</code>, <a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/main/src/main/java/eu/clarin/sru/server/fcs/utils/SimpleEndpointDescriptionParser.java">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/xml/reader.py#L38">Python</a>) or</p></li><li><p>construction dynamically, e.g. via API - example <a href="https://github.com/Leipzig-Corpora-Collection/fcs-noske-endpoint/blob/36fc8ae12131164a9cf00f4ed3648e9b47a1bd7d/src/main/java/de/saw_leipzig/textplus/webservices/fcs/fcs_noske_endpoint/NoSkESRUFCSEndpointSearchEngine.java#L355-L366">NoSketchEngine</a></p></li></ul></div></li></ul></div></div></section><section id="_minimal_fcs_endpoint_scanexplain" class="text-left"><h2>Minimal FCS Endpoint – Scan/Explain</h2><div class="slide-content"><div class="ulist"><ul><li><p>(theoretically) nothing to implement</p><div class="paragraph"><p>→ Default handlers for “explain” and “scan” respond to requests automatically</p></div></li><li><p>Endpoint Description is always returned as an “explain” operation (in case of doubt)</p></li></ul></div>
<div class="paragraph"><p>→ <code>SimpleEndpointSearchEngineBase</code> (<a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/main/src/main/java/eu/clarin/sru/server/fcs/SimpleEndpointSearchEngineBase.java">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/server/search.py#L507">Python</a>)</p></div></div></section><section id="_minimal_fcs_endpoint_search_request" class="text-left x-small"><h2>Minimal FCS Endpoint – Search Request</h2><div class="slide-content"><div class="paragraph"><p><code>SRUSearchResultSet search (SRUServerConfig config, SRURequest request, SRUDiagnosticList diagnostics)</code></p></div>
<div class="ulist"><ul><li><p>Parse query (search request)</p><div class="ulist"><ul><li><p>Check “<code>queryType</code>” parameter, whether CQL, FCS-QL, …</p></li><li><p>Error: <code>SRU_CANNOT_PROCESS_QUERY_REASON_UNKNOWN</code></p></li></ul></div></li><li><p>Analyze <code>ExtraRequestData</code></p><div class="ulist"><ul><li><p>“<code>x-fcs-context</code>” - requested resource (scope of search)</p><div class="ulist"><ul><li><p>Diagnostic: <code>FCS_DIAGNOSTIC_PERSISTENT_IDENTIFIER_INVALID</code> - invalid PIDs</p></li><li><p>Error: <code>SRU_UNSUPPORTED_PARAMETER_VALUE</code> - e.g. too many PIDs, no PIDs</p></li></ul></div></li><li><p>“<code>x-fcs-dataviews</code>” - requested Data Views</p><div class="ulist"><ul><li><p>Diagnostic: <code>FCS_DIAGNOSTIC_PERSISTENT_IDENTIFIER_INVALID</code></p></li></ul></div></li></ul></div></li><li><p>Pagination → <code>startRecord</code> (1) / <code>maximumRecords</code> (-1)</p></li></ul></div>
<div class="ulist mt-3"><ul><li><p>Process search with (local) search engine</p></li><li><p>Wrap results in <code>SRUSearchResultSet</code></p></li></ul></div>
<div class="ulist mt-3"><ul><li><p><span class="green"><em>“If in Doubt” → `SRU_GENERAL_SYSTEM_ERROR`</em></span></p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p><a href="https://github.com/Leipzig-Corpora-Collection/fcs-noske-endpoint/blob/main/src/main/java/de/saw_leipzig/textplus/webservices/fcs/fcs_noske_endpoint/NoSkESRUFCSEndpointSearchEngine.java" class="bare">https://github.com/Leipzig-Corpora-Collection/fcs-noske-endpoint/blob/main/src/main/java/de/saw_leipzig/textplus/webservices/fcs/fcs_noske_endpoint/NoSkESRUFCSEndpointSearchEngine.java</a></p></li><li><p><a href="https://github.com/clarin-eric/fcs-korp-endpoint/blob/master/src/main/java/se/gu/spraakbanken/fcs/endpoint/korp/KorpEndpointSearchEngine.java" class="bare">https://github.com/clarin-eric/fcs-korp-endpoint/blob/master/src/main/java/se/gu/spraakbanken/fcs/endpoint/korp/KorpEndpointSearchEngine.java</a></p></li><li><p><a href="https://github.com/Querela/fcs-korp-endpoint-python/blob/main/src/korp_endpoint/endpoint.py" class="bare">https://github.com/Querela/fcs-korp-endpoint-python/blob/main/src/korp_endpoint/endpoint.py</a></p></li></ul></div></aside></div></section><section id="_search_engine_integration" class="small"><h2>Search Engine Integration</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>Input</strong>: Parameters of search query</p><div class="openblock"><div class="content"><div class="ulist"><ul><li><p>Query (translated for (local) search engine)</p></li><li><p>Resource (PID)</p></li><li><p>Pagination: offset + count, → <code>startRecord</code> (1) / <code>maximumRecords</code> (-1)</p></li></ul></div>
<div class="ulist mt-4"><ul><li><p><em>(Request object and Server configurations)</em></p></li><li><p><em>(all global/static objects, such as API adapters etc.)</em></p></li></ul></div></div></div></li></ul></div>
<div class="ulist mt-4"><ul><li><p><strong>Output</strong>: Details for response, results</p><div class="ulist"><ul><li><p>Total number (optional, FCS 2.0 allows indication of accuracy)</p></li><li><p>List of results</p><div class="ulist"><ul><li><p>with “hit highlighting” (Hits) (Basic + Advanced Search)</p></li><li><p>tokenized (using character offsets) for FCS-QL (Advanced Search) with optional Advanced Search annotation layers</p></li></ul></div></li><li><p>Diagnostics</p></li></ul></div></li></ul></div></div></section><section id="_search_engine_integration_2" class="small columns"><h2>Search Engine Integration (2)</h2><div class="slide-content"><div class="openblock column is-one-third"><div class="content"><div class="ulist"><ul><li><p>Wrapper for results</p><div class="ulist"><ul><li><p>Total number of results</p></li><li><p>List of results (text with hit offsets; tokens + annotations)</p></li><li><p>Resource PID, URL to result details</p></li></ul></div></li><li><p><code>SRUSearchResultSet</code> implementation</p><div class="ulist"><ul><li><p>Iterator interface → <code>nextRecord()</code>, <code>writeRecord()</code>; <code>curRecordCursor</code></p></li></ul></div></li><li><p>Ex: <a href="https://github.com/Leipzig-Corpora-Collection/fcs-noske-endpoint/blob/main/src/main/java/de/saw_leipzig/textplus/webservices/fcs/fcs_noske_endpoint/searcher/MyResults.java">MyResults</a>, <a href="https://github.com/Leipzig-Corpora-Collection/fcs-noske-endpoint/blob/main/src/main/java/de/saw_leipzig/textplus/webservices/fcs/fcs_noske_endpoint/NoSkESRUFCSSearchResultSet.java">NoSkESRUFCSSearchResultSet</a></p></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-noescape="true" data-lang="java">protected NoSkESRUFCSSearchResultSet(..., MyResults results) {
    super(diagnostics);
    this.serverConfig = serverConfig;
    this.request = request;

    this.results = results;
    currentRecordCursor = -1;
    // ...

public int getTotalRecordCount() { return (int) results.getTotal(); }
public int getRecordCount() { return results.getResults().size(); }

public boolean nextRecord() throws SRUException {
    if (currentRecordCursor &lt; (getRecordCount() - 1)) {
        currentRecordCursor++;
        return true; }
    return false; }

public void writeRecord(XMLStreamWriter writer) {
    MyResults.ResultEntry result = results.getResults().get(currentRecordCursor);

    XMLStreamWriterHelper.writeStartResource(writer, results.getPid(), null);
    XMLStreamWriterHelper.writeStartResourceFragment(writer, null, result.landingpage);
    // ...
    XMLStreamWriterHelper.writeEndResourceFragment(writer);
    XMLStreamWriterHelper.writeEndResource(writer);
}</code></pre></div></div></div></div></div></section><section id="_result_serialization_2"><h2>Result Serialization</h2><div class="slide-content"><div class="ulist"><ul><li><p><code>SRUXMLStreamWriter</code> - <a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/SRUXMLStreamWriter.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/xml/writer.py#L24">Python</a></p><div class="ulist"><ul><li><p>(internal), specifically for SRU “<code>recordXmlEscaping</code>”</p></li></ul></div></li><li><p><strong><code>XMLStreamWriterHelper</code></strong> - <a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/main/src/main/java/eu/clarin/sru/server/fcs/XMLStreamWriterHelper.java">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/xml/writer.py#L21">Python</a> (<code class="darkgrey">FCSRecordXMLStreamWriter</code>)</p><div class="ulist"><ul><li><p>Boilerplate + help for writing <em>Record</em>, <em>RecordFragment</em>, <em>Hits/Kwic Data View</em></p></li></ul></div></li><li><p><strong><code>AdvancedDataViewWriter</code></strong> - <a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/main/src/main/java/eu/clarin/sru/server/fcs/AdvancedDataViewWriter.java">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/xml/writer.py#L508">Python</a></p><div class="ulist"><ul><li><p>Help with writing <em>Advanced Data Views</em></p></li><li><p><code>addSpans</code> (content, layer, offset, hit?)</p><div class="paragraph"><p><code>writeHitsDataView</code>, <code>writeAdvancedDataView</code></p></div></li></ul></div></li></ul></div></div></section><section id="_minimal_configuration_endpoint_description" class="columns"><h2>Minimal Configuration – Endpoint Description</h2><div class="slide-content"><div class="openblock column is-one-third"><div class="content"><div class="ulist"><ul><li><p>FCS Version: 2</p></li><li><p>Capabilities: BASIC Search</p></li><li><p>Data Views: HITS</p></li><li><p>Resources: (min: 1)</p><div class="ulist"><ul><li><p>Title</p></li><li><p>Description</p></li><li><p>LandingPage URL</p></li><li><p>Languages → one language (ISO 639-3)</p></li></ul></div></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock small width-75"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-noescape="true" data-line-numbers="5,7,10,13,14,15,16,17,18,20,22" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;EndpointDescription xmlns="http://clarin.eu/fcs/endpoint-description"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://clarin.eu/fcs/endpoint-description ../../schema/Core_2/Endpoint-Description.xsd"
             version="2"&gt;
  &lt;Capabilities&gt;
    &lt;Capability&gt;http://clarin.eu/fcs/capability/basic-search&lt;/Capability&gt;
  &lt;/Capabilities&gt;
  &lt;SupportedDataViews&gt;
    &lt;SupportedDataView id="hits" delivery-policy="send-by-default" &gt;application/x-clarin-fcs-hits+xml&lt;/SupportedDataView&gt;
  &lt;/SupportedDataViews&gt;
  &lt;Resources&gt;
    &lt;Resource pid="hdl:10794/sbkorpusar"&gt;
      &lt;Title xml:lang="sv"&gt;Språkbankens korpusar&lt;/Title&gt;
      &lt;Title xml:lang="en"&gt;The Språkbanken corpora&lt;/Title&gt;
      &lt;Description xml:lang="sv"&gt;Korpusarna hos Språkbanken.&lt;/Description&gt;
      &lt;Description xml:lang="en"&gt;The corpora at Språkbanken.&lt;/Description&gt;
      &lt;LandingPageURI &gt;https://spraakbanken.gu.se/resurser/corpus&lt;/LandingPageURI&gt;
      &lt;Languages&gt;
        &lt;Language&gt;swe&lt;/Language&gt;
      &lt;/Languages&gt;
      &lt;AvailableDataViews ref="hits"/&gt;
    &lt;/Resource&gt;
  &lt;/Resources&gt;
&lt;/EndpointDescription&gt;</code></pre></div></div></div></div></div></section><section id="_minimal_configuration_sru"><h2>Minimal Configuration – SRU</h2><div class="slide-content"><div class="ulist"><ul><li><p>SRU Server Configurations → <a href="#_endpoint_configurations">Endpoint Configurations</a> (<code>sru-server-config.xml</code>)</p><div class="ulist"><ul><li><p><code>databaseInfo</code> with general information about endpoint</p></li><li><p>default: <code>indexInfo</code> + <code>schemaInfo</code></p></li><li><p>required: <span class="green"><code>serverInfo</code> > <code>database</code></span> (<code>host</code> and <code>port</code> by default)</p></li></ul></div></li><li><p>Web server configuration</p><div class="ulist"><ul><li><p>Optional adjustment of SRU / FCS parameters</p></li><li><p>Java: <code>web.xml</code></p></li><li><p>Python: key-value dictionary</p></li></ul></div></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>default: <code>indexInfo</code> + <code>schemaInfo</code> → copy/paste from template/existing endpoints, configuration remains largely the same here</p></li></ul></div></aside></div></section><section id="_fcs_endpoint_deployment_java"><h2>FCS Endpoint Deployment (Java)</h2><div class="slide-content"><div class="ulist"><ul><li><p>Using Maven (!) / <code>pom.xml</code></p><div class="ulist"><ul><li><p><code>&lt;packaging&gt;war&lt;/packaging&gt;</code></p></li><li><p>Build Plugin:</p><div class="ulist"><ul><li><p><em><code>org.apache.maven.plugins:maven-war-plugin[:2.6]</code></em> (?)</p></li><li><p><code>org.apache.maven.plugins:maven-compiler-plugin</code></p></li></ul></div></li></ul></div></li><li><p>Create WAR artifact</p><div class="ulist"><ul><li><p><code>mvn clean compile war:war</code></p></li><li><p><code>mvn clean package</code> (also run tests etc.)</p></li></ul></div></li><li><p>Deploy with Java Servlet Engine / HTTP server like <a href="https://tomcat.apache.org/">Apache Tomcat</a> /  <a href="https://eclipse.dev/jetty/">Eclipse Jetty</a> / …</p></li></ul></div>
<aside class="notes"><div class="ulist"><ul><li><p>TODO: Check if <code>maven-war-plugin</code> is no longer necessary?</p></li></ul></div></aside></div></section><section id="_fcs_endpoint_deployment_python"><h2>FCS Endpoint Deployment (Python)</h2><div class="slide-content"><div class="ulist"><ul><li><p>“<code>make_app()</code>” method</p><div class="paragraph"><p>→ provides configured WSGI <code>SRUServerApp</code> (<a href="https://github.com/Querela/fcs-sru-server-python/blob/main/src/clarin/sru/server/wsgi.py">Python</a>)</p></div></li><li><p>Deployment suggestion: <a href="https://gunicorn.org/">gunicorn</a> (Python WSGI HTTP server)</p></li><li><p>Example: <a href="https://github.com/Querela/fcs-korp-endpoint-python/">fcs-korp-endpoint-python</a></p><div class="ulist"><ul><li><p>as <a href="https://github.com/Querela/fcs-korp-endpoint-python/blob/main/src/korp_endpoint/<em>main</em>.py">module</a> with <a href="https://werkzeug.palletsprojects.com/en/3.0.x/serving/">werkzeug test server</a></p><div class="paragraph darkgrey"><p><code>python3 -m korp_endpoint</code></p></div></li><li><p>gunicorn in Docker Container (<a href="https://github.com/Querela/fcs-korp-endpoint-python/blob/5ee448d2369e450571a6d82d3e379154752a3397/Dockerfile#L44-L49">Dockerfile</a>)</p><div class="paragraph darkgrey"><p><code>gunicorn 'korp_endpoint.app:make_gunicorn_app()'</code></p></div></li></ul></div></li></ul></div></div></section><section id="_embedded_fcs_endpoint_python" class="columns"><h2>Embedded FCS Endpoint (Python)</h2><div class="slide-content"><div class="openblock column is-half"><div class="content"><div class="ulist"><ul><li><p>Tested only with Python as WSGI app in Flask</p><div class="paragraph"><p>→ in kosh: <a href="https://github.com/Querela/kosh/tree/feature/fcs">PR</a>, <a href="https://github.com/cceh/kosh/commit/1785582775dde1839e4b2f106625e0bd79d86141">commit</a></p></div></li><li><p>Idea:</p><div class="ulist"><ul><li><p>Create <code>SRUServer</code> with <code>SRUSearchEngine</code> (global)</p></li><li><p>Forward requests (filtered by path) to <code>SRUServer</code></p></li></ul></div></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock code-width-full"><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-line-numbers="2,3,5,6,7,8,9,10,11,12,13,14,19,20,21" data-lang="python">def init(self, flask: Flask) -&gt; None:
    self.server = self.build_fcs_server()
    flask.add_url_rule("some-path/fcs", "some-path/fcs", self.handle)

def build_fcs_server(self) -&gt; SRUServer:
    params = self.build_fcs_server_params()
    config = self.build_fcs_server_config(params)
    qpr_builder = SRUQueryParserRegistry.Builder(True)
    search_engine = KoshFCSEndpointSearchEngine(
        endpoint_description=self.build_fcs_endpointdescription(),
        # ... other parameters
    )
    search_engine.init(config, qpr_builder, params)
    return SRUServer(config, qpr_builder.build(), search_engine)

def handle(self) -&gt; Response:
    LOGGER.debug("request: %s", request)  # Flask/Werkzeug Request
    LOGGER.debug("request?args: %s", request.args)
    response = Response()                 # Flask/Werkzeug Response
    self.server.handle_request(request, response)
    return response</code></pre></div></div></div></div></div></section><section id="_fcs_endpoint_extensibility" class="small"><h2>FCS Endpoint – Extensibility</h2><div class="slide-content"><div class="ulist"><ul><li><p>Supports own query languages, Data Views etc.</p></li><li><p>Example: <strong>LexFCS</strong> (FCS extension for lexical resources)</p><div class="paragraph"><p>→ i.e. new query language and Data View</p></div></li></ul></div>
<div class="ulist mt-4"><ul><li><p><strong>LexCQL</strong> - query language (CQL dialect)</p><div class="ulist"><ul><li><p><code>SRUQueryParser</code> (<a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/SRUQueryParser.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/queryparser.py#L58">Python</a>), based on <code>CQLQueryParser</code> (<a href="https://github.com/clarin-eric/fcs-sru-server/blob/main/src/main/java/eu/clarin/sru/server/CQLQueryParser.java">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/queryparser.py#L281">Python</a>)</p><div class="paragraph"><p>→ <code>LexCQLQueryParser</code> with <code>LexCQLQuery</code></p></div></li><li><p><code>SimpleEndpointSearchEngineBase.doInit()</code> (<a href="https://github.com/clarin-eric/fcs-simple-endpoint/blob/FCSSimpleEndpoint-1.6.0/src/main/java/eu/clarin/sru/server/fcs/SimpleEndpointSearchEngineBase.java#L181">Java</a>, <a href="https://github.com/Querela/fcs-simple-endpoint-python/blob/1.0.4/src/clarin/sru/fcs/server/search.py#L722">Python</a>)</p><div class="paragraph"><p>→ <code>queryParsersBuilder.register(new LexCQLQueryParser());</code></p></div></li></ul></div></li><li><p><strong>LexHITS</strong> - HITS Data View extension</p><div class="ulist"><ul><li><p>in <code>SRUSearchResultSet.writeRecord</code> (<a href="https://github.com/clarin-eric/fcs-sru-server/blob/SRUServer-1.9.0/src/main/java/eu/clarin/sru/server/SRUSearchResultSet.java#L182">Java</a>, <a href="https://github.com/Querela/fcs-sru-server-python/blob/1.1.3/src/clarin/sru/server/result.py#L346">Python</a>) appropriate XML result serialization</p></li></ul></div></li></ul></div>
<div style="page-break-after: always;"></div></div></section></section>
<section><section id="_deployment" data-background-image="images/fcs-render-uk.png" data-background-opacity="0.5"><h2>Deployment</h2><div class="slide-content"><aside class="notes"><div class="ulist"><ul><li><p>Deployment instructions for FCS Endpoint Tester/Validator, FCS SRU Aggregator and FCS Korp Endpoint</p></li></ul></div></aside></div></section><section id="_fcs_endpoint_protocol_conformance_tester"><h2>FCS Endpoint Protocol Conformance Tester</h2><div class="slide-content"><div class="ulist"><ul><li><p><em>NOTE: This is about the now legacy FCS endpoint tester, see <a href="#_fcs_endpoint_validator">Section: FCS Endpoint Validator</a> for the updated and rewritten validator!</em></p></li><li><p>WebApp for testing the <strong>compliance with the FCS specification</strong> of endpoints</p></li></ul></div>
<div class="ulist mt-3"><ul><li><p>Code: <a href="https://github.com/clarin-eric/fcs-endpoint-tester">github.com/clarin-eric/fcs-endpoint-tester</a></p></li><li><p>Deployment: <a href="http://clarin.ids-mannheim.de/srutest">clarin.ids-mannheim.de/srutest</a></p></li><li><p>Java 8; Vaadin 7.7.15 (UI)</p></li></ul></div>
<div class="ulist mt-3"><ul><li><p>Installation uses SNAPSHOT versions of the SRU/FCS libraries, and normally reserved functions to validate the SRU/FCS protocols</p></li></ul></div></div></section><section id="_fcs_endpoint_conformance_tester_deployment" class="small text-left"><h2>FCS Endpoint Conformance Tester – Deployment</h2><div class="slide-content"><div class="paragraph"><p>SRU/FCS SNAPSHOT libraries must be installed directly from Git</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ git clone https://github.com/clarin-eric/fcs-sru-client.git &amp;&amp; cd fcs-sru-client
$ mvn install
$ git clone https://github.com/clarin-eric/fcs-simple-client.git &amp;&amp; cd fcs-simple-client
$ mvn install</code></pre></div></div>
<div class="paragraph"><p>Build with Maven</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ git clone https://github.com/clarin-eric/fcs-endpoint-tester.git &amp;&amp; cd fcs-endpoint-tester
$ mvn clean package</code></pre></div></div>
<div class="paragraph"><p>Deployment with Jetty on <a href="http://localhost:8080/" class="bare">http://localhost:8080/</a></p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ JETTY_VERSION="9.4.51.v20230217"
$ wget https://repo1.maven.org/maven2/org/eclipse/jetty/jetty-distribution/${JETTY_VERSION}/jetty-distribution-${JETTY_VERSION}.zip &amp;&amp; unzip jetty-distribution-${JETTY_VERSION}.zip &amp;&amp; rm jetty-distribution-${JETTY_VERSION}.zip
$ cd jetty-distribution-${JETTY_VERSION}/
$ java -jar start.jar --add-to-start=http,deploy
$ cd webapps/ &amp;&amp; cp ../../target/FCSEndpointTester-X.Y.Z-SNAPSHOT.war ROOT.war &amp;&amp; cd ..
$ java -jar start.jar</code></pre></div></div></div></section><section id="_fcs_endpoint_conformance_tester_deployment_docker" class="text-left"><h2>FCS Endpoint Conformance Tester – Deployment (Docker)</h2><div class="slide-content"><div class="paragraph"><p>Create Docker Image</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ git clone https://github.com/clarin-eric/fcs-endpoint-tester.git &amp;&amp; cd fcs-endpoint-tester
$ docker build -t fcs-endpoint-tester .</code></pre></div></div>
<div class="paragraph"><p>Run Container</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ docker run --rm -it -p 8080:8080 fcs-endpoint-tester</code></pre></div></div></div></section><section id="_fcs_endpoint_validator"><h2>FCS Endpoint Validator</h2><div class="slide-content"><div class="ulist"><ul><li><p>This is a updated and completely rewritten SRU/FCS Endpoint Validator based on <a href="#_fcs_endpoint_protocol_conformance_tester">[_fcs_endpoint_protocol_conformance_tester]</a>. It allows to inspect HTTP requests/responses and store validation results in addition to more test cases.</p></li><li><p>WebApp for testing the <strong>compliance with the SRU/FCS specification</strong> of FCS endpoints</p></li></ul></div>
<div class="ulist mt-3"><ul><li><p>Code: <a href="https://github.com/saw-leipzig/fcs-endpoint-validator">github.com/saw-leipzig/fcs-endpoint-validator</a></p></li><li><p>Deployment: <a href="https://fcs-validator.data.saw-leipzig.de">fcs-validator.data.saw-leipzig.de</a></p></li><li><p>Multi-module maven project</p><div class="ulist"><ul><li><p>(standalone) JUnit5 test runner with test cases, Java 11</p></li><li><p>Vaadin 24 UI with SpringBoot, Java 17</p></li></ul></div></li></ul></div></div></section><section id="_fcs_endpoint_validator_deployment" class="text-left"><h2>FCS Endpoint Validator – Deployment</h2><div class="slide-content"><div class="paragraph"><p>Build with Maven</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ git clone https://github.com/saw-leipzig/fcs-endpoint-validator.git &amp;&amp; cd fcs-endpoint-validator
$ mvn clean package install</code></pre></div></div>
<div class="paragraph"><p>Deployment with SpringBoot on <a href="http://localhost:8080/" class="bare">http://localhost:8080/</a> (might automatically open a new browser tab)</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ cd fcs-endpoint-validator-ui/
$ mvn spring-boot:run</code></pre></div></div></div></section><section id="_fcs_endpoint_validator_deployment_docker" class="text-left"><h2>FCS Endpoint Validator – Deployment (Docker)</h2><div class="slide-content"><div class="paragraph"><p>Download sources:</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ git clone https://github.com/saw-leipzig/fcs-endpoint-validator.git &amp;&amp; cd fcs-endpoint-validator</code></pre></div></div>
<div class="paragraph"><p>Create <code>docker-compose.yml</code> deployment description:</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-yaml hljs" data-noescape="true" data-lang="yaml">version: '3'

services:
  fcs-endpoint-validator:
    build:
      context: .
      dockerfile: fcs-endpoint-validator-ui/Dockerfile
    container_name: fcs-endpoint-validator
    ports:
      # default, public 8080 to docker container 8080
      - 8080:8080
    restart: unless-stopped</code></pre></div></div>
<div class="paragraph"><p>Run Docker-Compose deployment:</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ docker compose build
$ docker compose down -v
$ docker compose up -d</code></pre></div></div></div></section><section id="_fcs_sru_aggregator"><h2>FCS SRU Aggregator</h2><div class="slide-content"><div class="ulist"><ul><li><p>Primary FCS client application</p></li><li><p>Central search interface for users,</p><div class="paragraph"><p>“aggregates” FCS search queries to/from distributed endpoints</p></div></li></ul></div>
<div class="ulist mt-3"><ul><li><p>Code: <a href="https://github.com/clarin-eric/fcs-sru-aggregator">github.com/clarin-eric/fcs-sru-aggregator</a></p></li><li><p>Deployments:</p><div class="ulist"><ul><li><p><strong>CLARIN</strong>: <a href="https://contentsearch.clarin.eu/">contentsearch.clarin.eu</a> + (<a href="https://alpha-contentsearch.clarin.eu/">Alpha</a> / <a href="https://beta-contentsearch.clarin.eu/">Beta</a> instances)</p></li><li><p><strong>Text+</strong>: <a href="https://fcs.text-plus.org/">fcs.text-plus.org</a> (<a href="https://alpha-fcs.text-plus.org/">Alpha</a> instance)</p></li></ul></div></li><li><p>Registry of endpoints in <a href="https://centres.clarin.eu/fcs">Centre Registry</a> + side loading</p></li><li><p>Deployment instructions found in the repo in <a href="https://github.com/clarin-eric/fcs-sru-aggregator/blob/master/DEPLOYMENT.md"><code>DEPLOYMENT.md</code></a></p></li></ul></div></div></section><section id="_fcs_sru_aggregator_deployment" class="text-left"><h2>FCS SRU Aggregator – Deployment</h2><div class="slide-content"><div class="paragraph"><p>Build application (native)</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ git clone https://github.com/clarin-eric/fcs-sru-aggregator.git &amp;&amp; cd fcs-sru-aggregator
$ ./build.sh --jar</code></pre></div></div>
<div class="paragraph"><p>Configuration (endpoint sideloading + logging) in <code>aggregator_devel.yml</code> (<code>aggregator.yml</code> for production deployment)</p></div>
<div class="openblock small ms-3 text-left"><div class="content"><div class="ulist"><ul><li><p><code>aggregatorParams</code> → <code>additionalFCSEndpoints</code></p></li><li><p><code>logging</code> → <code>loggers</code></p></li></ul></div></div></div>
<div class="paragraph"><p>Running on <a href="http://localhost:4019/" class="bare">http://localhost:4019/</a></p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ ./build.sh --run</code></pre></div></div></div></section><section id="_fcs_sru_aggregator_deployment_docker" class="text-left"><h2>FCS SRU Aggregator – Deployment (Docker)</h2><div class="slide-content"><div class="paragraph"><p>Create Docker Image</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ git clone https://github.com/clarin-eric/fcs-sru-aggregator.git &amp;&amp; cd fcs-sru-aggregator
$ docker build --tag=fcs-aggregator .</code></pre></div></div>
<div class="paragraph"><p>Run Docker Container</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ touch fcsAggregatorResources.json fcsAggregatorResources.backup.json
$ docker run -d --restart unless-stopped \
    -p 4019:4019 -p 5005:5005 \
    -v $(pwd)/aggregator.yml:/work/aggregator.yml:ro \
    -v $(pwd)/fcsAggregatorResources.json:/var/lib/aggregator/fcsAggregatorResources.json \
    -v $(pwd)/fcsAggregatorResources.backup.json:/var/lib/aggregator/fcsAggregatorResources.backup.json \
    fcs-aggregator</code></pre></div></div></div></section><section id="_fcs_korp_endpoint"><h2>FCS Korp Endpoint</h2><div class="slide-content"><div class="ulist"><ul><li><p>Reference endpoint for Korp corpus search engine</p></li><li><p>Example → Korp-API publicly accessible, no further configuration required for testing</p></li></ul></div>
<div class="ulist mt-3"><ul><li><p>Code:</p><div class="ulist"><ul><li><p>Java: github.com/clarin-eric/fcs-korp-endpoint</p></li><li><p>Python: github.com/Querela/fcs-korp-endpoint-python</p></li></ul></div></li><li><p>Deployment(s):</p></li><li><p><a href="https://centres.clarin.eu/centre/37">Språkbanken (Göteborg)</a>: <a href="https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru" class="bare">https://spraakbanken.gu.se/ws/fcs/2.0/endpoint/korp/sru</a></p></li><li><p><a href="https://centres.clarin.eu/centre/14">CLARIN-DK-UCPH (Copenhagen S)</a>: <a href="https://alf.hum.ku.dk/korp/fcs/2.0/endpoint/sru" class="bare">https://alf.hum.ku.dk/korp/fcs/2.0/endpoint/sru</a></p></li><li><p>&#8230;&#8203;</p></li></ul></div></div></section><section id="_fcs_korp_endpoint_deployment_java" class="text-left"><h2>FCS Korp Endpoint – Deployment (Java)</h2><div class="slide-content"><div class="paragraph"><p>Build Application</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ git clone https://github.com/clarin-eric/fcs-korp-endpoint.git &amp;&amp; cd fcs-korp-endpoint
$ mvn clean compile war:war</code></pre></div></div>
<div class="paragraph"><p>Deployment then with Jetty/Tomcat etc. analogous to the FCS Endpoint Tester</p></div></div></section><section id="_fcs_korp_endpoint_deployment_python" class="text-left"><h2>FCS Korp Endpoint – Deployment (Python)</h2><div class="slide-content"><div class="paragraph"><p>Prepare Deployment</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ git clone https://github.com/Querela/fcs-korp-endpoint-python.git &amp;&amp; cd fcs-korp-endpoint-python
$ python3 -m venv venv &amp;&amp; source venv/bin/activate
$ python3 -m pip install -e .</code></pre></div></div>
<div class="paragraph"><p>Test Deployment (<a href="http://localhost:8080" class="bare">http://localhost:8080</a>)</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ python3 -m korp_endpoint</code></pre></div></div>
<div class="paragraph"><p>Productive deployment with Docker (<a href="http://localhost:5000" class="bare">http://localhost:5000</a>)</p></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">$ docker build --progress=plain -t korpy .
$ docker run --rm -it -p 5000:5000 korpy</code></pre></div></div></div></section><section id="_deployment_notes"><h2>Deployment Notes</h2><div class="slide-content"><div class="ulist"><ul><li><p>When using Docker and <code>localhost</code>, network configurations may need to be adjusted so that the Docker container has access to the host</p><div class="ulist"><ul><li><p>→ <code>host.docker.internal</code></p></li></ul></div></li></ul></div>
<div style="page-break-after: always;"></div></div></section></section>
<section><section id="_resources" data-background-image="images/fcs-render-uk.png" data-background-opacity="0.5"><h2>Resources</h2></section><section id="_links"><h2>Links</h2><div class="slide-content"><div class="ulist"><ul><li><p>Comprehensive collections of FCS related links:<br>
<a href="https://github.com/clarin-eric/awesome-fcs">github.com/clarin-eric/awesome-fcs</a>,<br>
<a href="https://gitlab.gwdg.de/textplus/ag-fcs-documents/-/blob/main/awesome-fcs.md">gitlab.gwdg.de/textplus/ag-fcs-documents/-/blob/main/awesome-fcs.md</a></p></li><li><p>CLARIN overview page:<br>
<a href="https://www.clarin.eu/content/federated-content-search-clarin-fcs-technical-details">www.clarin.eu/content/federated-content-search-clarin-fcs-technical-details</a></p></li><li><p>CLARIN Code Github/Gitlab:<br>
<a href="https://github.com/clarin-eric/?q=fcs">github.com/clarin-eric/?q=fcs</a>,<br>
<a href="https://gitlab.com/CLARIN-ERIC/?filter=fcs">gitlab.com/CLARIN-ERIC/?filter=fcs</a>,<br>
<a href="https://github.com/clarin-eric/fcs-misc/">github.com/clarin-eric/fcs-misc/</a> (specs, docs, etc.) → <a href="https://clarin-eric.github.io/fcs-misc/">overview page</a></p></li></ul></div></div></section><section id="_publications"><h2>Publications</h2><div class="slide-content"><div class="ulist"><ul><li><p>As part of Text+ → see <a href="https://www.zotero.org/groups/4533881/textplus/tags/FCS/library">Zotero.org</a> tagged “FCS”</p></li><li><p>Listing in <a href="https://gitlab.gwdg.de/textplus/ag-fcs-documents/-/blob/main/awesome-fcs.md?ref_type=heads#publications">Text+ Awesome FCS</a> list</p></li><li><p>In the context of CLARIN? → see <a href="https://www.zotero.org/groups/5668488/federated_content_search/">Zotero.org “Federated Content Search” group</a></p><div class="ulist"><ul><li><p>CLARIN Federated Content Search (CLARIN-FCS) – Core Specification, 2014, Oliver Schonefeld et al.</p></li><li><p>Federated Search: Towards a Common Search Infrastructure, 2012, Herman Stehouwer et al.</p></li><li><p>Several workshops</p></li></ul></div></li></ul></div>
<script>
// remove hidden sections/slides;
// add role "[.hidden]" to a slide to remove it from the presentation
var sections = document.getElementsByTagName('section');
for (var i = sections.length-1; i > -1; --i) {
    console.log(sections[i].classList);
    if (sections[i].classList.contains("hidden")) {
        sections[i].remove();
    }
}
</script></div></section></section></div></div><script src="reveal.js/dist/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
});

// More info about config & dependencies:
// - https://github.com/hakimel/reveal.js#configuration
// - https://github.com/hakimel/reveal.js#dependencies
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: 'h.v',
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Add the current slide number to the URL hash so that reloading the
  // page/copying the URL will return you to the same slide
  hash: false,
  // Push each slide change to the browser history. Implies `hash: true`
  history: false,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Disables the default reveal.js slide layout so that you can use custom CSS layout
  disableLayout: false,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // See https://github.com/hakimel/reveal.js/#navigation-mode
  navigationMode: 'default',
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Global override for preloading lazy-loaded iframes
  // - null: Iframes with data-src AND data-preload will be loaded when within
  //   the viewDistance, iframes with only data-src will be loaded when visible
  // - true: All iframes with data-src will be loaded when within the viewDistance
  // - false: All iframes with data-src will be loaded only when visible
  preloadIframes: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Specify the total time in seconds that is available to
  // present.  If this is set to a nonzero value, the pacing
  // timer will work out the time available for each slide,
  // instead of using the defaultTiming value
  totalTime: 0,
  // Specify the minimum amount of time you want to allot to
  // each slide, if using the totalTime calculation method.  If
  // the automated time allocation causes slide pacing to fall
  // below this threshold, then you will see an alert in the
  // speaker notes window
  minimumTimePerSlide: 0,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hide cursor if inactive
  hideInactiveCursor: true,
  // Time before the cursor is hidden (in ms)
  hideCursorTime: 5000,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'slide',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Number of slides away from the current that are visible on mobile
  // devices. It is advisable to set this to a lower number than
  // viewDistance in order to save resources.
  mobileViewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1408,
  height: 892,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // PDF Export Options
  // Put each fragment on a separate page
  pdfSeparateFragments: true,
  // For slides that do not fit on a page, max number of pages
  pdfMaxPagesPerSlide: 1,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/plugin/zoom/zoom.js', async: true, callback: function () { Reveal.registerPlugin(RevealZoom) } },
      { src: 'reveal.js/plugin/notes/notes.js', async: true, callback: function () { Reveal.registerPlugin(RevealNotes) } }
  ],
});</script><script>var dom = {};
dom.slides = document.querySelector('.reveal .slides');

function getRemainingHeight(element, slideElement, height) {
  height = height || 0;
  if (element) {
    var newHeight, oldHeight = element.style.height;
    // Change the .stretch element height to 0 in order find the height of all
    // the other elements
    element.style.height = '0px';
    // In Overview mode, the parent (.slide) height is set of 700px.
    // Restore it temporarily to its natural height.
    slideElement.style.height = 'auto';
    newHeight = height - slideElement.offsetHeight;
    // Restore the old height, just in case
    element.style.height = oldHeight + 'px';
    // Clear the parent (.slide) height. .removeProperty works in IE9+
    slideElement.style.removeProperty('height');
    return newHeight;
  }
  return height;
}

function layoutSlideContents(width, height) {
  // Handle sizing of elements with the 'stretch' class
  toArray(dom.slides.querySelectorAll('section .stretch')).forEach(function (element) {
    // Determine how much vertical space we can use
    var limit = 5; // hard limit
    var parent = element.parentNode;
    while (parent.nodeName !== 'SECTION' && limit > 0) {
      parent = parent.parentNode;
      limit--;
    }
    if (limit === 0) {
      // unable to find parent, aborting!
      return;
    }
    var remainingHeight = getRemainingHeight(element, parent, height);
    // Consider the aspect ratio of media elements
    if (/(img|video)/gi.test(element.nodeName)) {
      var nw = element.naturalWidth || element.videoWidth, nh = element.naturalHeight || element.videoHeight;
      var es = Math.min(width / nw, remainingHeight / nh);
      element.style.width = (nw * es) + 'px';
      element.style.height = (nh * es) + 'px';
    } else {
      element.style.width = width + 'px';
      element.style.height = remainingHeight + 'px';
    }
  });
}

function toArray(o) {
  return Array.prototype.slice.call(o);
}

Reveal.addEventListener('slidechanged', function () {
  layoutSlideContents(1408, 892)
});
Reveal.addEventListener('ready', function () {
  layoutSlideContents(1408, 892)
});
Reveal.addEventListener('resize', function () {
  layoutSlideContents(1408, 892)
});</script><link rel="stylesheet" href="reveal.js/plugin/highlight/magula.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.3/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.3/languages/xml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.3/languages/python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.3/languages/java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.3/languages/json.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.3/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.3/languages/isbl.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.3/languages/csharp.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.3/languages/wren.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.3/languages/x86asm.min.js"></script>

<script>

/* highlightjs-line-numbers.js 2.6.0 | (C) 2018 Yauheni Pakala | MIT License | github.com/wcoder/highlightjs-line-numbers.js */
/* Edited by Hakim for reveal.js; removed async timeout */
!function(n,e){"use strict";function t(){var n=e.createElement("style");n.type="text/css",n.innerHTML=g(".{0}{border-collapse:collapse}.{0} td{padding:0}.{1}:before{content:attr({2})}",[v,L,b]),e.getElementsByTagName("head")[0].appendChild(n)}function r(t){"interactive"===e.readyState||"complete"===e.readyState?i(t):n.addEventListener("DOMContentLoaded",function(){i(t)})}function i(t){try{var r=e.querySelectorAll("code.hljs,code.nohighlight");for(var i in r)r.hasOwnProperty(i)&&l(r[i],t)}catch(o){n.console.error("LineNumbers error: ",o)}}function l(n,e){"object"==typeof n&&f(function(){n.innerHTML=s(n,e)})}function o(n,e){if("string"==typeof n){var t=document.createElement("code");return t.innerHTML=n,s(t,e)}}function s(n,e){e=e||{singleLine:!1};var t=e.singleLine?0:1;return c(n),a(n.innerHTML,t)}function a(n,e){var t=u(n);if(""===t[t.length-1].trim()&&t.pop(),t.length>e){for(var r="",i=0,l=t.length;i<l;i++)r+=g('<tr><td class="{0}"><div class="{1} {2}" {3}="{5}"></div></td><td class="{4}"><div class="{1}">{6}</div></td></tr>',[j,m,L,b,p,i+1,t[i].length>0?t[i]:" "]);return g('<table class="{0}">{1}</table>',[v,r])}return n}function c(n){var e=n.childNodes;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];h(r.textContent)>0&&(r.childNodes.length>0?c(r):d(r.parentNode))}}function d(n){var e=n.className;if(/hljs-/.test(e)){for(var t=u(n.innerHTML),r=0,i="";r<t.length;r++){var l=t[r].length>0?t[r]:" ";i+=g('<span class="{0}">{1}</span>\n',[e,l])}n.innerHTML=i.trim()}}function u(n){return 0===n.length?[]:n.split(y)}function h(n){return(n.trim().match(y)||[]).length}function f(e){e()}function g(n,e){return n.replace(/{(\d+)}/g,function(n,t){return e[t]?e[t]:n})}var v="hljs-ln",m="hljs-ln-line",p="hljs-ln-code",j="hljs-ln-numbers",L="hljs-ln-n",b="data-line-number",y=/\r\n|\r|\n/g;n.hljs?(n.hljs.initLineNumbersOnLoad=r,n.hljs.lineNumbersBlock=l,n.hljs.lineNumbersValue=o,t()):n.console.error("highlight.js not detected!")}(window,document);

/**
 * This reveal.js plugin is wrapper around the highlight.js
 * syntax highlighting library.
 */
(function( root, factory ) {
  if (typeof define === 'function' && define.amd) {
    root.RevealHighlight = factory();
  } else if( typeof exports === 'object' ) {
    module.exports = factory();
  } else {
    // Browser globals (root is window)
    root.RevealHighlight = factory();
  }
}( this, function() {

  // Function to perform a better "data-trim" on code snippets
  // Will slice an indentation amount on each line of the snippet (amount based on the line having the lowest indentation length)
  function betterTrim(snippetEl) {
    // Helper functions
    function trimLeft(val) {
      // Adapted from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim#Polyfill
      return val.replace(/^[\s\uFEFF\xA0]+/g, '');
    }
    function trimLineBreaks(input) {
      var lines = input.split('\n');

      // Trim line-breaks from the beginning
      for (var i = 0; i < lines.length; i++) {
        if (lines[i].trim() === '') {
          lines.splice(i--, 1);
        } else break;
      }

      // Trim line-breaks from the end
      for (var i = lines.length-1; i >= 0; i--) {
        if (lines[i].trim() === '') {
          lines.splice(i, 1);
        } else break;
      }

      return lines.join('\n');
    }

    // Main function for betterTrim()
    return (function(snippetEl) {
      var content = trimLineBreaks(snippetEl.innerHTML);
      var lines = content.split('\n');
      // Calculate the minimum amount to remove on each line start of the snippet (can be 0)
      var pad = lines.reduce(function(acc, line) {
        if (line.length > 0 && trimLeft(line).length > 0 && acc > line.length - trimLeft(line).length) {
          return line.length - trimLeft(line).length;
        }
        return acc;
      }, Number.POSITIVE_INFINITY);
      // Slice each line with this amount
      return lines.map(function(line, index) {
        return line.slice(pad);
      })
        .join('\n');
    })(snippetEl);
  }

  var RevealHighlight = {

    HIGHLIGHT_STEP_DELIMITER: '|',
    HIGHLIGHT_LINE_DELIMITER: ',',
    HIGHLIGHT_LINE_RANGE_DELIMITER: '-',

    init: function( reveal ) {

      // Read the plugin config options and provide fallbacks
      var config = Reveal.getConfig().highlight || {};
      config.highlightOnLoad = typeof config.highlightOnLoad === 'boolean' ? config.highlightOnLoad : true;
      config.escapeHTML = typeof config.escapeHTML === 'boolean' ? config.escapeHTML : true;

      [].slice.call( reveal.getRevealElement().querySelectorAll( 'pre code' ) ).forEach( function( block ) {

        block.parentNode.className = 'code-wrapper';

        // Code can optionally be wrapped in script template to avoid
        // HTML being parsed by the browser (i.e. when you need to
        // include <, > or & in your code).
        let substitute = block.querySelector( 'script[type="text/template"]' );
        if( substitute ) {
          // textContent handles the HTML entity escapes for us
          block.textContent = substitute.innerHTML;
        }

        // Trim whitespace if the "data-trim" attribute is present
        if( block.hasAttribute( 'data-trim' ) && typeof block.innerHTML.trim === 'function' ) {
          block.innerHTML = betterTrim( block );
        }

        // Escape HTML tags unless the "data-noescape" attrbute is present
        if( config.escapeHTML && !block.hasAttribute( 'data-noescape' )) {
          block.innerHTML = block.innerHTML.replace( /</g,"&lt;").replace(/>/g, '&gt;' );
        }

        // Re-highlight when focus is lost (for contenteditable code)
        block.addEventListener( 'focusout', function( event ) {
          hljs.highlightElement( event.currentTarget );
        }, false );

        if( config.highlightOnLoad ) {
          RevealHighlight.highlightBlock( block );
        }
      } );

      // If we're printing to PDF, scroll the code highlights of
      // all blocks in the deck into view at once
      reveal.on( 'pdf-ready', function() {
        [].slice.call( reveal.getRevealElement().querySelectorAll( 'pre code[data-line-numbers].current-fragment' ) ).forEach( function( block ) {
          RevealHighlight.scrollHighlightedLineIntoView( block, {}, true );
        } );
      } );
    },

    /**
     * Highlights a code block. If the <code> node has the
     * 'data-line-numbers' attribute we also generate slide
     * numbers.
     *
     * If the block contains multiple line highlight steps,
     * we clone the block and create a fragment for each step.
     */
    highlightBlock: function( block ) {

      hljs.highlightElement( block );

      // Don't generate line numbers for empty code blocks
      if( block.innerHTML.trim().length === 0 ) return;

      if( block.hasAttribute( 'data-line-numbers' ) ) {
        hljs.lineNumbersBlock( block, { singleLine: true } );

        var scrollState = { currentBlock: block };

        // If there is at least one highlight step, generate
        // fragments
        var highlightSteps = RevealHighlight.deserializeHighlightSteps( block.getAttribute( 'data-line-numbers' ) );
        if( highlightSteps.length > 1 ) {

          // When rendered with asciidoc, data-fragment index if it exists lies on the listing block element, so we have to lookup
          // If the original code block has a fragment-index,
          // each clone should follow in an incremental sequence
          var preCodeWrapper = block.parentElement;
          var divContent = preCodeWrapper.parentElement;
          var listingBlock = divContent.parentElement;
          var fragmentIndex = parseInt( listingBlock.getAttribute( 'data-fragment-index' ), 10 );

          if( typeof fragmentIndex !== 'number' || isNaN( fragmentIndex ) ) {
            fragmentIndex = null;
          } else {
            fragmentIndex += 1;
          }

          // Generate fragments for all steps except the original block
          highlightSteps.slice(1).forEach( function( highlight ) {

            var fragmentBlock = block.cloneNode( true );
            fragmentBlock.setAttribute( 'data-line-numbers', RevealHighlight.serializeHighlightSteps( [ highlight ] ) );
            fragmentBlock.classList.add( 'fragment' );
            block.parentNode.appendChild( fragmentBlock );
            RevealHighlight.highlightLines( fragmentBlock );

            if( typeof fragmentIndex === 'number' ) {
              fragmentBlock.setAttribute( 'data-fragment-index', fragmentIndex );
              fragmentIndex += 1;
            }
            else {
              fragmentBlock.removeAttribute( 'data-fragment-index' );
            }

            // Scroll highlights into view as we step through them
            fragmentBlock.addEventListener( 'visible', RevealHighlight.scrollHighlightedLineIntoView.bind( Plugin, fragmentBlock, scrollState ) );
            fragmentBlock.addEventListener( 'hidden', RevealHighlight.scrollHighlightedLineIntoView.bind( Plugin, fragmentBlock.previousSibling, scrollState ) );

          } );

          block.removeAttribute( 'data-fragment-index' )
          block.setAttribute( 'data-line-numbers', RevealHighlight.serializeHighlightSteps( [ highlightSteps[0] ] ) );

        }

        // Scroll the first highlight into view when the slide
        // becomes visible. Note supported in IE11 since it lacks
        // support for Element.closest.
        var slide = typeof block.closest === 'function' ? block.closest( 'section:not(.stack)' ) : null;
        if( slide ) {
          var scrollFirstHighlightIntoView = function() {
            RevealHighlight.scrollHighlightedLineIntoView( block, scrollState, true );
            slide.removeEventListener( 'visible', scrollFirstHighlightIntoView );
          }
          slide.addEventListener( 'visible', scrollFirstHighlightIntoView );
        }

        RevealHighlight.highlightLines( block );

      }

    },

    /**
     * Animates scrolling to the first highlighted line
     * in the given code block.
     */
    scrollHighlightedLineIntoView: function( block, scrollState, skipAnimation ) {

      cancelAnimationFrame( scrollState.animationFrameID );

      // Match the scroll position of the currently visible
      // code block
      if( scrollState.currentBlock ) {
        block.scrollTop = scrollState.currentBlock.scrollTop;
      }

      // Remember the current code block so that we can match
      // its scroll position when showing/hiding fragments
      scrollState.currentBlock = block;

      var highlightBounds = RevealHighlight.getHighlightedLineBounds( block )
      var viewportHeight = block.offsetHeight;

      // Subtract padding from the viewport height
      var blockStyles = getComputedStyle( block );
      viewportHeight -= parseInt( blockStyles.paddingTop ) + parseInt( blockStyles.paddingBottom );

      // Scroll position which centers all highlights
      var startTop = block.scrollTop;
      var targetTop = highlightBounds.top + ( Math.min( highlightBounds.bottom - highlightBounds.top, viewportHeight ) - viewportHeight ) / 2;

      // Account for offsets in position applied to the
      // <table> that holds our lines of code
      var lineTable = block.querySelector( '.hljs-ln' );
      if( lineTable ) targetTop += lineTable.offsetTop - parseInt( blockStyles.paddingTop );

      // Make sure the scroll target is within bounds
      targetTop = Math.max( Math.min( targetTop, block.scrollHeight - viewportHeight ), 0 );

      if( skipAnimation === true || startTop === targetTop ) {
        block.scrollTop = targetTop;
      }
      else {

        // Don't attempt to scroll if there is no overflow
        if( block.scrollHeight <= viewportHeight ) return;

        var time = 0;
        var animate = function() {
          time = Math.min( time + 0.02, 1 );

          // Update our eased scroll position
          block.scrollTop = startTop + ( targetTop - startTop ) * RevealHighlight.easeInOutQuart( time );

          // Keep animating unless we've reached the end
          if( time < 1 ) {
            scrollState.animationFrameID = requestAnimationFrame( animate );
          }
        };

        animate();

      }

    },

    /**
     * The easing function used when scrolling.
     */
    easeInOutQuart: function( t ) {

      // easeInOutQuart
      return t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t;

    },

    getHighlightedLineBounds: function( block ) {

      var highlightedLines = block.querySelectorAll( '.highlight-line' );
      if( highlightedLines.length === 0 ) {
        return { top: 0, bottom: 0 };
      }
      else {
        var firstHighlight = highlightedLines[0];
        var lastHighlight = highlightedLines[ highlightedLines.length -1 ];

        return {
          top: firstHighlight.offsetTop,
          bottom: lastHighlight.offsetTop + lastHighlight.offsetHeight
        }
      }

    },

    /**
     * Visually emphasize specific lines within a code block.
     * This only works on blocks with line numbering turned on.
     *
     * @param {HTMLElement} block a <code> block
     * @param {String} [linesToHighlight] The lines that should be
     * highlighted in this format:
     * "1" 		= highlights line 1
     * "2,5"	= highlights lines 2 & 5
     * "2,5-7"	= highlights lines 2, 5, 6 & 7
     */
    highlightLines: function( block, linesToHighlight ) {

      var highlightSteps = RevealHighlight.deserializeHighlightSteps( linesToHighlight || block.getAttribute( 'data-line-numbers' ) );

      if( highlightSteps.length ) {

        highlightSteps[0].forEach( function( highlight ) {

          var elementsToHighlight = [];

          // Highlight a range
          if( typeof highlight.end === 'number' ) {
            elementsToHighlight = [].slice.call( block.querySelectorAll( 'table tr:nth-child(n+'+highlight.start+'):nth-child(-n+'+highlight.end+')' ) );
          }
          // Highlight a single line
          else if( typeof highlight.start === 'number' ) {
            elementsToHighlight = [].slice.call( block.querySelectorAll( 'table tr:nth-child('+highlight.start+')' ) );
          }

          if( elementsToHighlight.length ) {
            elementsToHighlight.forEach( function( lineElement ) {
              lineElement.classList.add( 'highlight-line' );
            } );

            block.classList.add( 'has-highlights' );
          }

        } );

      }

    },

    /**
     * Parses and formats a user-defined string of line
     * numbers to highlight.
     *
     * @example
     * RevealHighlight.deserializeHighlightSteps( '1,2|3,5-10' )
     * // [
     * //   [ { start: 1 }, { start: 2 } ],
     * //   [ { start: 3 }, { start: 5, end: 10 } ]
     * // ]
     */
    deserializeHighlightSteps: function( highlightSteps ) {

      // Remove whitespace
      highlightSteps = highlightSteps.replace( /\s/g, '' );

      // Divide up our line number groups
      highlightSteps = highlightSteps.split( RevealHighlight.HIGHLIGHT_STEP_DELIMITER );

      return highlightSteps.map( function( highlights ) {

        return highlights.split( RevealHighlight.HIGHLIGHT_LINE_DELIMITER ).map( function( highlight ) {

          // Parse valid line numbers
          if( /^[\d-]+$/.test( highlight ) ) {

            highlight = highlight.split( RevealHighlight.HIGHLIGHT_LINE_RANGE_DELIMITER );

            var lineStart = parseInt( highlight[0], 10 ),
              lineEnd = parseInt( highlight[1], 10 );

            if( isNaN( lineEnd ) ) {
              return {
                start: lineStart
              };
            }
            else {
              return {
                start: lineStart,
                end: lineEnd
              };
            }

          }
          // If no line numbers are provided, no code will be highlighted
          else {

            return {};

          }

        } );

      } );

    },

    /**
     * Serializes parsed line number data into a string so
     * that we can store it in the DOM.
     */
    serializeHighlightSteps: function( highlightSteps ) {

      return highlightSteps.map( function( highlights ) {

        return highlights.map( function( highlight ) {

          // Line range
          if( typeof highlight.end === 'number' ) {
            return highlight.start + RevealHighlight.HIGHLIGHT_LINE_RANGE_DELIMITER + highlight.end;
          }
          // Single line
          else if( typeof highlight.start === 'number' ) {
            return highlight.start;
          }
          // All lines
          else {
            return '';
          }

        } ).join( RevealHighlight.HIGHLIGHT_LINE_DELIMITER );

      } ).join( RevealHighlight.HIGHLIGHT_STEP_DELIMITER );

    }

  }

  Reveal.registerPlugin( 'highlight', RevealHighlight );

  return RevealHighlight;

}));
        
hljs.configure({
  ignoreUnescapedHTML: true,
});
hljs.highlightAll();
</script></body></html>